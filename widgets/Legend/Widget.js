// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k,w,g,h,z){X=function(l){function A(m,M){m=l.call(this,m,M)||this;m._handles=new I;m.activeLayerInfos=null;m.basemapLegendVisible=!1;m.groundLegendVisible=!1;m.headingLevel=3;m.hideLayersNotInCurrentView=!1;m.keepCacheOnDestroy=!1;m.respectLayerVisibility=!0;m.iconClass="esri-icon-layer-list";m.label=void 0;m.layerInfos=null;m.messages=null;m.style=new k;m.view=null;m.viewModel=new u;return m}F._inheritsLoose(A,l);var d=A.prototype;d.initialize=function(){this.own(T.on(this,
"view","resize",()=>this.scheduleRender()),T.on(this,"activeLayerInfos","change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),T.watch(this,"headingLevel",m=>{const {style:M}=this;M&&(M.headingLevel=m)}),T.init(this,"style",(m,M)=>{M&&m!==M&&M.destroy();m&&(m.activeLayerInfos=this.activeLayerInfos,"card"===m.type&&(m.view=this.view),m.headingLevel=this.headingLevel)}))};d.destroy=function(){this._handles.destroy();this._handles=null};d.castStyle=function(m){if(m instanceof x||m instanceof
k)return m;if("string"===typeof m)return"card"===m?new x:new k;if(m&&"string"===typeof m.type){const M={...m};delete M.type;return new ("card"===m.type?x:k)(M)}return new k};d.render=function(){return z.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof k?"esri-widget--panel":null)},this.style.render())};d._refreshActiveLayerInfos=function(m){this._handles.removeAll();m.forEach(M=>this._renderOnActiveLayerInfoChange(M));this.scheduleRender()};d._renderOnActiveLayerInfoChange=
function(m){var M=T.init(m,"version",()=>this.scheduleRender());this._handles.add(M,`version_${m.layer.uid}`);M=T.on(m,"children","change",()=>{m.children.forEach(U=>this._renderOnActiveLayerInfoChange(U))});this._handles.add(M,`children_${m.layer.uid}`);m.children.forEach(U=>this._renderOnActiveLayerInfoChange(U))};return A}(q);H.__decorate([O.aliasOf("viewModel.activeLayerInfos")],X.prototype,"activeLayerInfos",void 0);H.__decorate([O.aliasOf("viewModel.basemapLegendVisible")],X.prototype,"basemapLegendVisible",
void 0);H.__decorate([O.aliasOf("viewModel.groundLegendVisible")],X.prototype,"groundLegendVisible",void 0);H.__decorate([Z.property()],X.prototype,"headingLevel",void 0);H.__decorate([O.aliasOf("viewModel.hideLayersNotInCurrentView")],X.prototype,"hideLayersNotInCurrentView",void 0);H.__decorate([O.aliasOf("viewModel.keepCacheOnDestroy")],X.prototype,"keepCacheOnDestroy",void 0);H.__decorate([O.aliasOf("viewModel.respectLayerVisibility")],X.prototype,"respectLayerVisibility",void 0);H.__decorate([Z.property()],
X.prototype,"iconClass",void 0);H.__decorate([Z.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],X.prototype,"label",void 0);H.__decorate([O.aliasOf("viewModel.layerInfos")],X.prototype,"layerInfos",void 0);H.__decorate([Z.property(),g.messageBundle("esri/widgets/Legend/t9n/Legend")],X.prototype,"messages",void 0);H.__decorate([Z.property()],X.prototype,"style",void 0);H.__decorate([J.cast("style")],X.prototype,"castStyle",null);H.__decorate([O.aliasOf("viewModel.view")],X.prototype,
"view",void 0);H.__decorate([Z.property()],X.prototype,"viewModel",void 0);return X=H.__decorate([e.subclass("esri.widgets.Legend")],X)})},"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k){const w=O.ofType(x),g="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
h=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];I=function(z){function l(d){d=z.call(this,d)||this;d._handles=new X;d._layerViewByLayerId={};d._layerInfosByLayerViewId={};d._activeLayerInfosByLayerViewId={};d._activeLayerInfosWithNoParent=new O;d.activeLayerInfos=new w;d.basemapLegendVisible=!1;d.groundLegendVisible=!1;d.hideLayersNotInCurrentView=!1;d.keepCacheOnDestroy=!1;d.respectLayerVisibility=!0;d.layerInfos=[];d.view=
null;return d}F._inheritsLoose(l,z);var A=l.prototype;A.initialize=function(){this._handles.add(N.init(this,"view",this._viewHandles),"view");this._handles.add(k.onLocaleChange(()=>this._refresh()))};A.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};A._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(N.init(this,"state",this._stateHandles),"state")};A._stateHandles=function(){this._resetAll();"ready"===this.state&&
this._watchPropertiesAndAllLayerViews()};A._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};A._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};A._destroyViewActiveLayerInfo=function(d){this._handles.remove(d);const m=this._activeLayerInfosByLayerViewId[d];delete this._activeLayerInfosByLayerViewId[d];m&&m.parent&&
m.parent.children.remove(m)};A._watchPropertiesAndAllLayerViews=function(){const {allLayerViews:d}=this.view;d.length&&this._refresh();this._handles.add(d.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(N.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};A._allLayerViewsChangeHandle=function(d){d.removed.forEach(m=>this._destroyViewActiveLayerInfo(m.uid));this._refresh()};A._propertiesChangeHandle=
function(){this._destroyViewActiveLayerInfos();this._refresh()};A._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};A._sortActiveLayerInfos=function(d){if(!(2>d.length)){var m=[];d.forEach(U=>{if(!U.parent){var B=U.layer.parent;(B=(B=B&&"uid"in B&&this._layerViewByLayerId[B.uid])&&
this._activeLayerInfosByLayerViewId[B.uid])&&-1!==d.indexOf(B)&&(m.push(U),U.parent=B,B.children.add(U),this._sortActiveLayerInfos(B.children))}});d.removeMany(m);var M={};this.view.allLayerViews.forEach((U,B)=>M[U.layer.uid]=B);d.sort((U,B)=>(M[B.layer.uid]||0)-(M[U.layer.uid]||0))}};A._generateLayerViews=function(){const d=[];h.filter(this._filterLayerViews,this).map(this.get,this).filter(m=>null!=m).forEach(this._collectLayerViews("layerViews",d));return d};A._filterLayerViews=function(d){const m=
!this.groundLegendVisible&&"view.groundView.layerViews"===d;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===d||"view.basemapView.referenceLayerViews"===d))&&!m};A._collectLayerViews=function(d,m){const M=U=>{U&&U.forEach(B=>{m.push(B);M(B[d])});return m};return M};A._filterLayerViewsByLayerInfos=function(d){const m=this.layerInfos;return m&&m.length?m.some(M=>this._hasLayerInfo(M,d)):!0};A._hasLayerInfo=function(d,m){const M=this._isLayerUIDMatching(d.layer,m.layer.uid);M&&
(this._layerInfosByLayerViewId[m.uid]=d);return M};A._isLayerUIDMatching=function(d,m){return d&&(d.uid===m||this._hasLayerUID(d.layers,m))};A._hasLayerUID=function(d,m){return d&&d.some(M=>this._isLayerUIDMatching(M,m))};A._isLayerViewSupported=function(d){return g.includes(d.layer.declaredClass)?(this._layerViewByLayerId[d.layer.uid]=d,!0):!1};A._generateActiveLayerInfo=function(d){this._isLayerActive(d)?this._buildActiveLayerInfo(d):(this._handles.remove(d.uid),this._handles.add(N.watch(d,"legendEnabled, layer.legendEnabled",
()=>this._layerActiveHandle(d)),d.uid))};A._layerActiveHandle=function(d){this._isLayerActive(d)&&(this._handles.remove(d.uid),this._buildActiveLayerInfo(d))};A._isLayerActive=function(d){return this.respectLayerVisibility?d.legendEnabled&&d.get("layer.legendEnabled"):!0};A._buildActiveLayerInfo=function(d){var m,M=d.layer;const U=d.uid;var B=this._layerInfosByLayerViewId[U];let R=this._activeLayerInfosByLayerViewId[U];R||(R=new x({layer:M,layerView:d,title:B&&void 0!==B.title&&B.layer.uid===M.uid?
B.title:M.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:B&&B.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[U]=R);B=M.parent&&"uid"in M.parent&&this._layerViewByLayerId[null==(m=M.parent)?void 0:m.uid];R.parent=this._activeLayerInfosByLayerViewId[null==B?void 0:B.uid];if(!this._handles.has(U)){m=N.watch(M,"title",P=>this._titleHandle(P,R));B=N.watch(M,
"renderer?, opacity, pointSymbol?, lineSymbol?, polygonSymbol?",()=>this._constructLegendElements(R));const fa=N.whenTrue(this.view,"stationary",()=>this._scaleHandle(R)),ba=N.watch(d,"_effectiveRenderer",()=>this._constructLegendElements(R)),y=N.watch(M,"effect",()=>this._constructLegendElements(R));m=[m,B,fa,ba,y];this.respectLayerVisibility&&(d=N.watch(d,"legendEnabled",P=>this._legendEnabledHandle(P,R)),M=N.watch(M,"legendEnabled",P=>this._legendEnabledHandle(P,R)),m.push(d,M));this._handles.add(m,
U)}R.isScaleDriven||this._constructLegendElements(R);this._addActiveLayerInfo(R)};A._titleHandle=function(d,m){m.title=d;this._constructLegendElements(m)};A._legendEnabledHandle=function(d,m){d?this._addActiveLayerInfo(m):this._removeActiveLayerInfo(m)};A._scaleHandle=function(d){(d.isScaleDriven||d.hideLayersNotInCurrentView)&&this._constructLegendElements(d)};A._addActiveLayerInfo=function(d){const {layerView:m,layer:M}=d;if(this._isLayerActive(m)&&-1===this.activeLayerInfos.indexOf(d)){var U=d.parent;
if(U)-1===U.children.indexOf(d)&&U.children.push(d),this._sortActiveLayerInfos(U.children);else{var B;U=null==(B=this.layerInfos)?void 0:B.some(R=>R.layer.uid===M.uid);M.parent&&"uid"in M.parent&&!U?this._activeLayerInfosWithNoParent.add(d):(this.activeLayerInfos.add(d),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const R=[];this._activeLayerInfosWithNoParent.forEach(fa=>{var ba=fa.layer.parent;ba=ba&&"uid"in ba&&this._layerViewByLayerId[null==ba?
void 0:ba.uid];if(ba=this._activeLayerInfosByLayerViewId[null==ba?void 0:ba.uid])R.push(fa),fa.parent=ba});R.length&&(this._activeLayerInfosWithNoParent.removeMany(R),R.forEach(fa=>this._addActiveLayerInfo(fa)))}}};A._removeActiveLayerInfo=function(d){const m=d.parent;m?m.children.remove(d):this.activeLayerInfos.remove(d)};A._constructLegendElements=function(d){const m=d.layer;"featureCollections"in m&&m.featureCollections?d.buildLegendElementsForFeatureCollections(m.featureCollections):"renderer"in
m&&m.renderer?d.buildLegendElementsForRenderer(m.renderer):"url"in m&&m.url?d.buildLegendElementsForTools():d.children.forEach(M=>this._constructLegendElements(M))};F._createClass(l,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return l}(T);H.__decorate([J.property({type:w})],I.prototype,"activeLayerInfos",void 0);H.__decorate([J.property()],I.prototype,"basemapLegendVisible",void 0);H.__decorate([J.property()],I.prototype,"groundLegendVisible",void 0);H.__decorate([J.property()],
I.prototype,"hideLayersNotInCurrentView",void 0);H.__decorate([J.property()],I.prototype,"keepCacheOnDestroy",void 0);H.__decorate([J.property()],I.prototype,"respectLayerVisibility",void 0);H.__decorate([J.property()],I.prototype,"layerInfos",void 0);H.__decorate([J.property({readOnly:!0})],I.prototype,"state",null);H.__decorate([J.property()],I.prototype,"view",void 0);return I=H.__decorate([u.subclass("esri.widgets.Legend.LegendViewModel")],I)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k,w,g,h,z,l,A,d,m,M,U,B,R,fa,ba,y,P,r,n,L,Q,V,c,p,v,G,da,Y,t,D,S){function ea(sa){return"esri.renderers.SimpleRenderer"===sa.declaredClass}function ja(sa){return"esri.renderers.ClassBreaksRenderer"===sa.declaredClass}function ra(sa){return"esri.renderers.UniqueValueRenderer"===sa.declaredClass}function qa(sa){return"esri.renderers.HeatmapRenderer"===sa.declaredClass}function la(sa){return"esri.renderers.PointCloudClassBreaksRenderer"===sa.declaredClass}function na(sa){return"esri.renderers.PointCloudStretchRenderer"===
sa.declaredClass}function aa(sa){return"esri.renderers.PointCloudUniqueValueRenderer"===sa.declaredClass}function ta(sa){return"esri.renderers.DotDensityRenderer"===sa.declaredClass}function oa(sa){return"esri.layers.BuildingSceneLayer"===sa.declaredClass}function wa(sa){sa="authoringInfo"in sa&&(null==sa?void 0:sa.authoringInfo);return"univariate-color-size"===(null==sa?void 0:sa.type)}function xa(sa){sa="authoringInfo"in sa&&(null==sa?void 0:sa.authoringInfo);return"univariate-color-size"===(null==
sa?void 0:sa.type)&&"above-and-below"===(null==sa?void 0:sa.univariateTheme)}const za=u.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),ya=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Ea=new q.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Fa={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],
f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Ia=new D({size:6,outline:{color:[128,128,128,.5],width:.5}}),Na=new S({style:"solid"}),Oa=new D({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ha={};N=function(sa){function Ja(b){b=sa.call(this,b)||this;b._handles=new e;b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;b._webStyleSymbolCache=new Map;b._dotDensityUrlCache=new Map;b._scaleDrivenSizeVariable=null;b._hasClusterSizeVariable=
!1;b.children=new Z;b.layerView=null;b.layer=null;b.legendElements=[];b.parent=null;b.hideLayersNotInCurrentView=!1;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.sublayerIds=[];b.title=null;b.view=null;return b}H._inheritsLoose(Ja,sa);var ia=Ja.prototype;ia.initialize=function(){const b=()=>this.notifyChange("ready");this._handles.add([h.on(this,"children","change",a=>{const {added:f,removed:C}=a,E=this._handles;f.forEach(K=>{const W=`activeLayerInfo-ready-watcher-${K.layer.uid}`;E.add(h.init(K,
"ready",b),W)});C.forEach(K=>E.remove(K.layer.uid));b()})]);this.keepCacheOnDestroy||(Ha={})};ia.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Ha=null)};ia.buildLegendElementsForFeatureCollections=function(){var b=H._asyncToGenerator(function*(a){if(this.hideLayersNotInCurrentView&&!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{a=
Array.from(a,f=>{if("esri.layers.FeatureLayer"===f.declaredClass)return this._getRendererLegendElements(f.renderer,{title:f.title});if(f.featureSet&&f.featureSet.features.length){var C=f.layerDefinition,E=C&&C.drawingInfo;E=E&&ba.fromJSON(E.renderer);C=Ea.read(C.geometryType);return E?this._getRendererLegendElements(E,{title:f.name,geometryType:C}):(za.warn("drawingInfo not available!"),null)}return null});try{const f=[];yield k.eachAlways(a).then(C=>{C.forEach(({value:E})=>E&&f.push(...E))});this.legendElements=
f;this.notifyChange("ready")}catch(f){za.warn("error while building legend for layer!",f)}}});return function(a){return b.apply(this,arguments)}}();ia.buildLegendElementsForRenderer=function(){var b=H._asyncToGenerator(function*(a){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(f){za.warn("error while building legend for layer!",f)}});return function(a){return b.apply(this,
arguments)}}();ia.buildLegendElementsForTools=function(){var b=H._asyncToGenerator(function*(){var a=this;const f=this.layer;if("esri.layers.VoxelLayer"===f.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===f.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===f.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if(oa(f))yield this._constructLegendElementsForBuildingSceneLayer();else if("esri.layers.MapImageLayer"===
f.declaredClass||"esri.layers.TileLayer"===f.declaredClass||oa(f))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var C="default";if("esri.layers.ImageryLayer"===f.declaredClass){var E,K;C=(null==f?void 0:null==(E=f.renderingRule)?void 0:E.functionName)||"default";E=null!=(K=f.bandIds)&&K.length?f.bandIds.join(""):"###";C=C+"_"+E}yield this._getLegendLayers(`${f.uid}-${C}`).then(function(){var W=H._asyncToGenerator(function*(ca){a.legendElements=
[];a.notifyChange("ready");ca=ca.map(function(){var ma=H._asyncToGenerator(function*(ua){if("esri.layers.ImageryLayer"===f.declaredClass||"esri.layers.ImageryTileLayer"===f.declaredClass){const Ca=f.watch(["renderingRule","bandIds"],()=>k.debounce(H._asyncToGenerator(function*(){Ha["default"]=null;f.renderer?yield a.buildLegendElementsForRenderer(f.renderer):yield a.buildLegendElementsForTools()}))());a._handles.add(Ca,"imageryLayers-watcher")}(ua=a._generateSymbolTableElementForLegendLayer(ua))&&
ua.infos.length&&("esri.layers.ImageryLayer"===f.declaredClass&&(ua.title=f.title),a.legendElements.push(ua));a.notifyChange("ready")});return function(ua){return ma.apply(this,arguments)}}());yield k.eachAlways(ca)});return function(ca){return W.apply(this,arguments)}}()).catch(W=>{za.warn("Request to server for legend has failed!",W)})}});return function(){return b.apply(this,arguments)}}();ia._isLayerInCurrentView=function(){var b=H._asyncToGenerator(function*(){const a=this.layer,f=this.layerView,
C=f&&"createQuery"in f&&"queryFeatureCount"in f;if(!(C||f&&"createQuery"in a&&"queryFeatureCount"in a))return!0;yield h.whenFalseOnce(f,"updating");const E=C?"createQuery"in f&&f.createQuery():"createQuery"in a&&a.createQuery();E.geometry=this.view.extent;return 0!==(C?"queryFeatureCount"in f&&(yield f.queryFeatureCount(E)):"queryFeatureCount"in a&&(yield a.queryFeatureCount(E)))});return function(){return b.apply(this,arguments)}}();ia._getParentLayerOpacity=function(b){let a=1;const f=b.parent;
f&&"uid"in f&&(a=this._getParentLayerOpacity(f));return b.opacity*a};ia._isGroupActive=function(){const b=this.children;return b.length?b.some(a=>a.ready):!1};ia._isScaleDrivenSizeVariable=function(b){if(b&&"size"!==b.type)return!1;const a=b.minSize,f=b.maxSize;return"object"===typeof a&&a?this._isScaleDrivenSizeVariable(a):"object"===typeof f&&f?this._isScaleDrivenSizeVariable(f):!!b.expression||ya.test(b.valueExpression)};ia._isLayerScaleDriven=function(b){if("minScale"in b&&0<b.minScale||"maxScale"in
b&&0<b.maxScale)return!0;if("sublayers"in b&&b.sublayers)return b.sublayers.some(f=>this._isLayerScaleDriven(f));const a=b.parent;if(!1===b.loaded&&a&&"esri.layers.MapImageLayer"===a.declaredClass&&"source"in b&&b.source&&"map-layer"===b.source.type)for(const f of a.sourceJSON.layers)if(f.id===b.source.mapLayerId&&(0<f.minScale||0<f.maxScale))return!0;return!1};ia._constructLegendElementsForVoxellayer=function(){var b=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("voxel-style-watcher");
var a=this.layer;this._handles.add(h.watch(a,"style",()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const f=x.unwrap(a.getVariableStyle(null)),C=[];if(f){var E;if(null!=(E=f.uniqueValues)&&E.length){const W=[];f.uniqueValues.forEach(ca=>{ca.enabled&&W.push({label:ca.label||`${ca.value}`,value:ca.value,symbol:new S({color:ca.color,outline:null})})});W.length&&C.push({type:"symbol-table",title:f.label,infos:W})}else if(f.transferFunction){const {colorStops:W,stretchRange:ca}=
f.transferFunction;E=W.toArray().reverse();const ma=ca.map((Ca,ha)=>`${0===ha?Y.SPECIAL_CHARS_LESS_THAN:Y.SPECIAL_CHARS_GREATER_THAN} ${t.formatNumberLabel(Ca)}`).reverse(),ua=E.map(Ca=>({color:Ca.color,value:null,label:null}));ua[0].label=ma[0];ua[ua.length-1].label=ma[1];C.push({type:"color-ramp",title:f.label,infos:ua,preview:Q.renderColorRampPreviewHTML(E.map(Ca=>Ca.color))})}}const K=a.opacity;a=C.reduce((W,ca)=>W.concat(this._getAllInfos(ca)),[]).filter(W=>!(null==W||!W.symbol)).map(W=>this._getSymbolPreview(W,
K));yield k.eachAlways(a);this.legendElements=C;this.notifyChange("ready")});return function(){return b.apply(this,arguments)}}();ia._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const b=this.layer.activeLayer;this._handles.add(h.watch(this.layer,"activeLayer",()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){let a=null;b.styles.some(f=>b.styleId===f.id?(a=f.legendUrl,!0):!1);
a&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:a,opacity:this.opacity}]}])}this.notifyChange("ready")};ia._constructLegendElementsForWMSSublayers=function(){var b=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");const a=this.layer;let f=null;if(a.customParameters||a.customLayerParameters)f={...a.customParameters,...a.customLayerParameters};this._handles.add(h.watch(this.layer,"sublayers",()=>this._constructLegendElementsForWMSSublayers()),
"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(a.sublayers,f);this.notifyChange("ready")});return function(){return b.apply(this,arguments)}}();ia._generateLegendElementsForWMSSublayers=function(){var b=H._asyncToGenerator(function*(a,f){const C=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");a=a.toArray();for(const E of a)a=E.watch(["title","visible","legendEnabled"],()=>this._constructLegendElementsForWMSSublayers()),
this._handles.add(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||E.visible&&E.legendEnabled)&&(a=yield this._generateSymbolTableElementForWMSSublayer(E,f))&&a.infos.length&&C.unshift(a);return C});return function(a,f){return b.apply(this,arguments)}}();ia._generateSymbolTableElementForWMSSublayer=function(){var b=H._asyncToGenerator(function*(a,f){return!a.legendUrl&&a.sublayers?(f=(yield this._generateLegendElementsForWMSSublayers(a.sublayers,f)).filter(C=>C),{type:"symbol-table",title:a.title,
infos:f}):this._generateSymbolTableElementForLegendUrl(a,f)});return function(a,f){return b.apply(this,arguments)}}();ia._generateSymbolTableElementForLegendUrl=function(){var b=H._asyncToGenerator(function*(a,f){var C;let E=a.legendUrl;if(E){var K={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};f&&(E=g.addQueryParameters(E,f));f=null;a=null==(C=a.layer)?void 0:C.opacity;try{if(f=(yield X(E,{responseType:"image"})).data)f.style.opacity=a}catch{}K.infos.push({src:E,preview:f,opacity:a});
return K}});return function(a,f){return b.apply(this,arguments)}}();ia._getLegendLayers=function(b,a){const f=Ha&&Ha[b];return f?Promise.resolve(f):this._legendRequest(a).then(C=>{C=C.layers;return Ha[b]=C})};ia._legendRequest=function(b){var a=this.layer;b={f:"json",dynamicLayers:b};if("esri.layers.ImageryLayer"===a.declaredClass){var f=a.exportImageServiceParameters.renderingRule;f&&(b.renderingRule=JSON.stringify(f.rasterFunctionDefinition||f.toJSON()));a.bandIds&&(b.bandIds=a.bandIds.join());
if(a.raster||a.viewId||a.customParameters){const {raster:C,viewId:E,customParameters:K}=a;b={raster:C,viewId:E,...b,...K}}}f=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?(a=f.indexOf("?"),f=-1<a?f.substring(0,a)+"/legend"+f.substring(a):f+"/legend"):(a=f.toLowerCase().indexOf("/rest/"),a=f.substring(0,a)+f.substring(a+5,f.length),f="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(a)+"\x26returnbytes\x3dtrue");return X(f,{query:b}).then(C=>C.data)};ia._constructLegendElementsForBuildingSceneLayer=
function(){var b=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(h.watch(a,"sublayers",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(f){za.warn("Request to server for legend has failed!",f)}});return function(){return b.apply(this,arguments)}}();
ia._generateLegendElementsForBuildingSublayers=function(){var b=H._asyncToGenerator(function*(a,f){let C=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const K of a)if(a=K.watch(["renderer","opacity","title","visible"],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||K.visible){a=K&&null!=K.opacity?K.opacity:null;var E=null!=a?a*f:f;"building-group"===
K.type?(a={type:"symbol-table",title:K.title,infos:[]},E=yield this._generateLegendElementsForBuildingSublayers(K.sublayers,E),a.infos.push(...E),C=[a,...C]):K.renderer&&(C=[...yield this._getRendererLegendElements(K.renderer,{title:K.title,opacity:E,sublayer:K}),...C])}return C.filter(K=>!!K&&("infos"in K?0<K.infos.length:!0))});return function(a,f){return b.apply(this,arguments)}}();ia._constructLegendElementsForSublayers=function(){var b=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");
const a=this.layer;this._handles.add(h.watch(a,"sublayers",()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(f){za.warn("Request to server for legend has failed!",f)}});return function(){return b.apply(this,arguments)}}();ia._generateLegendElementsForSublayers=function(){var b=H._asyncToGenerator(function*(a,f,C){const E=this.layer;let K=[];this._handles.add(a.on("change",
()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!C&&this.sublayerIds&&this.sublayerIds.length&&(a=this.sublayerIds.map(W=>E.findSublayerById(W)).filter(Boolean));for(const W of a)if(a=W.watch("renderer, opacity, title, visible, legendEnabled",()=>this._constructLegendElementsForSublayers()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||W.visible&&W.legendEnabled&&this._isSublayerInScale(W))a=W&&null!=W.opacity?W.opacity:null,a=null!=a?a*
f:f,W.renderer&&!W.sublayers&&W.originIdOf("renderer")>M.OriginId.SERVICE?(yield W.load(),K=[...yield this._getRendererLegendElements(W.renderer,{title:W.title,opacity:a,sublayer:W}),...K]):(a=yield this._generateSymbolTableElementForSublayer(W,a,C))&&K.unshift(a);return K.filter(W=>!!W&&("infos"in W?0<W.infos.length:!0))});return function(a,f,C){return b.apply(this,arguments)}}();ia._generateSymbolTableElementForSublayer=function(){var b=H._asyncToGenerator(function*(a,f,C){if(!C){C=new Map;var E=
this.layer,K=a.source;let W=null;if(K&&("map-layer"!==K.type||K.mapLayerId!==a.id||K.gdbVersion&&K.gdbVersion!==("gdbVersion"in E&&E.gdbVersion))||a.originIdOf("renderer")>M.OriginId.SERVICE||a.originIdOf("labelingInfo")>M.OriginId.SERVICE||a.originIdOf("labelsVisible")>M.OriginId.SERVICE)K=new R.ExportImageParameters({layer:this.layer}),W=K.hasDynamicLayers?K.dynamicLayers:null,K.destroy();(yield this._getLegendLayers(W||`${E.uid}-default`,W)).forEach(ca=>C.set(ca.layerId,ca))}E=C.get(a.id);return(!E||
null!=E&&E.subLayerIds&&E.defaultVisibility)&&a.sublayers?(f=yield this._generateLegendElementsForSublayers(a.sublayers,f,C),{type:"symbol-table",title:a.title,infos:f}):this._generateSymbolTableElementForLegendLayer(E,a,f)});return function(a,f,C){return b.apply(this,arguments)}}();ia._generateSymbolTableElementForLegendLayer=function(b,a,f){var C;if(!b||!b.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(b,a))return null;var E=null==a?void 0:a.renderer;let K=(null==a?void 0:a.title)||
b.layerName;E&&(!a||(null==a?void 0:a.originIdOf("renderer"))>M.OriginId.SERVICE)&&(E=(null==a?void 0:a.title)||this._getRendererTitle(E,a))&&(K&&"string"!==typeof E&&"title"in E&&(E.title=K),K=E);const W={type:"symbol-table",title:K,legendType:b.legendType?b.legendType:null,infos:[]},ca=a?this._sanitizeLegendForSublayer(b.legend.slice(),a):b.legend;0<(null==(C=b.legendGroups)?void 0:C.length)?b.legendGroups.forEach(ma=>{var ua;const Ca={type:"symbol-table",title:ma.heading,legendType:b.legendType?
b.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(ca.filter(ha=>ha.groupId===ma.id),b.layerId,f)};0<(null==(ua=Ca.infos)?void 0:ua.length)&&W.infos.push(Ca)}):W.infos=this._generateSymbolTableElementInfosForLegendLayer(ca,b.layerId,f);return 0<W.infos.length?W:null};ia._generateSymbolTableElementInfosForLegendLayer=function(b,a,f){return b.map(C=>{let E=C.url;if(C.imageData&&0<C.imageData.length)E=`data:image/png;base64,${C.imageData}`;else if(0!==E.indexOf("http"))E=O.addTokenParameter(`${this.layer.url}/${a}/images/${E}`);
else return null;return{label:C.label,src:E,opacity:null==f?this.opacity:f,width:C.width,height:C.height}}).filter(C=>!!C)};ia._isSublayerInScale=function(b){const a=b.minScale||0;b=b.maxScale||0;return 0<a&&a<this.scale||b>this.scale?!1:!0};ia._isLegendLayerInScale=function(b,a){a=a||this.layer;let f=null,C=null,E=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0===b.minScale&&a.tileInfo&&(f=a.tileInfo.lods[0].scale),0===b.maxScale&&a.tileInfo&&(C=a.tileInfo.lods[a.tileInfo.lods.length-
1].scale)):(f=Math.min(a.minScale,b.minScale)||a.minScale||b.minScale,C=Math.max(a.maxScale,b.maxScale));if(0<f&&f<this.scale||C>this.scale)E=!1;return E};ia._sanitizeLegendForSublayer=function(b,a){if("version"in this.layer&&10.1>this.layer.version||0===b.length)return b;a=a.renderer;let f=null,C=null;b.some(E=>E.values)&&b.some((E,K)=>{E.values||(f=K,C=E,C.label||(C.label="others"));return null!=C});a?"unique-value"===a.type?C&&(b.splice(f,1),b.push(C)):"class-breaks"===a.type&&(C&&b.splice(f,1),
b.reverse(),C&&b.push(C)):C&&(b.splice(f,1),b.push(C));return b};ia._getRendererLegendElements=function(){var b=H._asyncToGenerator(function*(a,f={}){var C=this.view;C=ea(a)||ja(a)||ra(a)||qa(a)||ta(a)?"2d"===C.type||y.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||la(a)||na(a)||aa(a)||"vector-field"===a.type||"flow"===a.type;return C?la(a)||na(a)||aa(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,
f):ta(a)?this._constructDotDensityRendererLegendElements(a):this._constructRendererLegendElements(a,f):(za.warn(`Renderer of type '${a.type}' not supported!`),[])});return function(a){return b.apply(this,arguments)}}();ia._getPointCloudRendererTitle=function(b){return b.legendOptions&&b.legendOptions.title||b.field};ia._constructPointCloudRendererLegendElements=function(b,a={}){a=a.title;const f=[];let C=null;var E=null;if(la(b))C={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),
infos:[]},b.colorClassBreakInfos.forEach(K=>{C.infos.unshift({label:K.label||K.minValue+" - "+K.maxValue,value:[K.minValue,K.maxValue],symbol:this._getAppliedCloneSymbol(Ia,K.color)})});else if(na(b)){E=b.stops;let K=null;if(E.length&&(1===E.length&&(K=E[0].color),!K)){const W=E[0].value,ca=E[E.length-1].value;null!=W&&null!=ca&&(K=p.getColorFromPointCloudStops(W+(ca-W)/2,E))}C={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ia,K||Ia.color)}]};E=p.getRampStopsForPointCloud(b.stops);
E={type:"color-ramp",title:a||this._getPointCloudRendererTitle(b),infos:E,preview:Q.renderColorRampPreviewHTML(E.map(W=>W.color))}}else aa(b)&&(C={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),infos:[]},b.colorUniqueValueInfos.forEach(K=>{C.infos.push({label:K.label||K.values.join(", "),value:K.values.join(", "),symbol:this._getAppliedCloneSymbol(Ia,K.color)})}));C&&C.infos.length&&f.push(C);E&&E.infos.length&&f.push(E);a=f.reduce((K,W)=>K.concat(W.infos),[]).filter(K=>!!K.symbol).map(K=>
this._getSymbolPreview(K,this.opacity,{symbolConfig:{applyColorModulation:!!b.colorModulation}}));return k.eachAlways(a).then(()=>f)};ia._getElementInfoForDotDensity=function(b,a){const {backgroundColor:f,outline:C,dotSize:E}=b;var K=this.effectList;K=null==K?void 0:K.effects.map(ca=>ca.toJSON());K=B.effectFunctionsFromJSON(K);K=E+"-"+a+"-"+f+"-"+(C&&JSON.stringify(C.toJSON()))+"-"+K;const W=this._dotDensityUrlCache;b=W.has(K)?W.get(K):Q.renderDotDensityPreviewHTML(b,a);W.set(K,b);a=L.renderSymbol([[{shape:{type:"image",
x:0,y:0,width:b.width,height:b.height,src:b.src},fill:null,stroke:null,offset:[0,0]}]],[b.width,b.height],{effectView:this.effectList});return{opacity:1,src:b.src,preview:a,width:b.width,height:b.height}};ia._constructDotDensityRendererLegendElements=function(b){const a=b.calculateDotValue(this.view.scale),f={type:"symbol-table",title:{value:a&&Math.round(a),unit:b.legendOptions&&b.legendOptions.unit||""},infos:[]};b.attributes.forEach(C=>{const E=this._getElementInfoForDotDensity(b,C.color);E.label=
C.label||C.valueExpressionTitle||C.field;f.infos.push(E)});return Promise.resolve([f])};ia._constructRendererLegendElements=function(){var b=H._asyncToGenerator(function*(a,f={}){const {title:C,sublayer:E}=f,K=E||this.layer;a=yield this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const W=(yield this._getVisualVariableLegendElements(a,K))||[],ca={type:"symbol-table",title:C||this._getRendererTitle(a,K),infos:[]};let ma=null,ua=!1;
const Ca=new Set;if("flow"!==a.type||this._hasSizeRamp)if(wa(a)){var ha=C,ka=xa(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",Aa=W.findIndex(pa=>"color-ramp"===pa.type);Aa=-1!==Aa?W.splice(Aa,1)[0]:null;var va=W.findIndex(pa=>"size-ramp"===pa.type);va=-1!==va?W.splice(va,1)[0]:null;var Ba=[];Aa&&(ha=Aa.title,Ba.push(Aa));va&&(ha=va.title,Ba.push(va));0<Ba.length&&W.push({type:ka,title:ha,infos:Ba})}else if(qa(a))ha=v.getHeatmapRampStops(a),W.push({type:"heatmap-ramp",title:C,infos:ha,
preview:Q.renderColorRampPreviewHTML(ha.map(pa=>pa.color),{effectList:this.effectList})});else if(ra(a)){if((ka=a&&a.authoringInfo)&&"relationship"===ka.type){const {focus:pa,numClasses:Da,field1:Ka,field2:La}=ka;if(Da&&Ka&&La){Aa=[Ka,La];ka=G.getRotationAngleForFocus(pa)||0;for(ha of Aa){const {field:Pa,normalizationField:Ma,label:Qa}=ha;Aa=Qa||{field:this._getFieldAlias(Pa,K),normField:Ma&&this._getFieldAlias(Ma,K)};va=Oa.clone();va.angle=ka;ca.infos.push({label:Aa,symbol:va});Ca.add(va);ka+=90}ha=
G.getRelationshipRampElement({focus:pa,numClasses:Da,infos:a.uniqueValueInfos});W.unshift(ha)}}else{const pa=a.field;a.uniqueValueInfos.forEach(Da=>{Da.symbol&&ca.infos.push({label:Da.label||this._getDomainName(pa,Da.value,K)||Da.value,value:Da.value,symbol:Da.symbol})})}a.defaultSymbol&&(ca.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ua=!0)}else if(ja(a))ma=this._isUnclassedRenderer(a),ma&&this._hasSizeRamp||(a.classBreakInfos.forEach(pa=>{pa.symbol&&ca.infos.unshift({label:pa.label||
(ma?null:pa.minValue+" - "+pa.maxValue),value:[pa.minValue,pa.maxValue],symbol:pa.symbol})}),ma&&(ca.title=null),this._updateInfosforClassedSizeRenderer(a,ca.infos)),a.defaultSymbol&&!ma&&(ca.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ua=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?W.push(ha):
ca.infos=ha;else{ha=this.layer;a.statistics&&a.statistics.length&&(ka=null!=a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],Aa=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]);va=[];va=x.unwrap(ha.renderingRule?yield ha.generateRasterInfo(ha.renderingRule):ha.serviceRasterInfo);const pa=va.keyProperties.BandProperties;Ba=Fa[ha.rasterInfo.pixelType.toLowerCase()];1===va.bandCount?(ka=null!=ka?ka:va.statistics?va.statistics[ha.bandIds[0]].min:Ba[0],Aa=null!=Aa?Aa:va.statistics?
va.statistics[ha.bandIds[0]].max:Ba[1],ka||Aa?W.push(this._getStretchLegendElements(a,{min:ka,max:Aa})):this._getServerSideLegend()):ha.bandIds&&1===ha.bandIds.length?(ka=null!=ka?ka:va.statistics?va.statistics[ha.bandIds[0]].min:Ba[0],Aa=null!=Aa?Aa:va.statistics?va.statistics[ha.bandIds[0]].max:Ba[1],ka||Aa?W.push(this._getStretchLegendElements(a,{min:ka,max:Aa})):this._getServerSideLegend()):3<=va.bandCount?pa&&pa.length>=va.bandCount?ha.bandIds&&3===ha.bandIds.length?(va=ha.bandIds.map(Da=>pa[Da].BandName),
ca.infos=this._createSymbolTableElementMultiBand(va)):"lerc"===ha.format?(va=[0,1,2].map(Da=>pa[Da].BandName),ca.infos=this._createSymbolTableElementMultiBand(va)):this._getServerSideLegend():"lerc"===ha.format?(va=["band1","band2","band3"],ca.infos=this._createSymbolTableElementMultiBand(va)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(pa=>{ca.infos.push({label:pa.label,value:pa.value,symbol:this._getAppliedCloneSymbol(Na,pa.color)})});
else if(ea(a)){ha=a.symbol;switch(f.geometryType){case "point":ha="pointSymbol"in K&&K.pointSymbol;break;case "polyline":ha="lineSymbol"in K&&K.lineSymbol;break;case "polygon":ha="polygonSymbol"in K&&K.polygonSymbol}a.symbol&&!this._hasSizeRamp&&ca.infos.push({label:a.label,symbol:ha})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),ca.title=a.attributeField,ha=a.getClassBreakInfos(),null!=ha&&ha.length?ha.forEach(pa=>{ca.infos.push({label:pa.minValue+" - "+pa.maxValue,
symbol:pa.symbol})}):ca.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&W.push(this._getStretchLegendElements(a,{min:0,max:255}));else ha=yield Y.getSymbolForFlowRenderer(a),ca.infos.push({label:null,symbol:ha});const Ga=a.defaultSymbol;!Ga||ua||ea(a)||ma&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||W.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Ga}]});ca.infos.length&&W.unshift(ca);const Ra=null==f.opacity?
this.opacity:f.opacity,Sa=this._isTallSymbol("visualVariables"in a&&a.visualVariables),Ta="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;f=W.reduce((pa,Da)=>pa.concat(this._getAllInfos(Da)),[]).filter(pa=>!(null==pa||!pa.symbol)).map(pa=>this._getSymbolPreview(pa,Ra,{isDefault:pa.symbol===Ga,applyScaleDrivenSize:!Ca.has(pa.symbol),symbolConfig:{isTall:Sa,isSquareFill:Ta},effectList:Ca.has(pa.symbol)?null:this.effectList}));a=null;yield k.eachAlways(f);
return W});return function(a){return b.apply(this,arguments)}}();ia._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};ia._getAllInfos=function(b){const a=null==b?void 0:b.infos;return a?a.reduce((f,C)=>f.concat(this._getAllInfos(C)),[]):[b]};ia._constructTileImageryStretchRendererElements=function(b){function a(ua){var Ca;const ha=(null!=E&&null!=(Ca=E.bandIds)&&Ca.length?E.bandIds:Array.from(Array(Math.min(K.bandCount,3)).keys())).map(ka=>ua&&ua[ka]&&ua[ka].BandName||
"band"+(ka+1));3>ha.length?ha.push(ha[1]):3<ha.length&&ha.splice(3);return ha}var f,C;const E=this.layer,K=E.rasterInfo,W=K.bandCount||b.statistics.length;var ca,ma=[];ma=K.keyProperties&&K.keyProperties.BandProperties;(ca=null!=b&&null!=(f=b.statistics)&&f.length?b.statistics:null==K?void 0:K.statistics)?(f=void 0!==ca[0].min?ca[0].min:ca[0][0],ca=ca[0].max||ca[0][1]):(ca=Fa[E.rasterInfo.pixelType.toLowerCase()],f=ca[0],ca=ca[1]);E.hasStandardTime()&&(f=E.getStandardTimeValue(f),ca=E.getStandardTimeValue(ca));
if(1===K.bandCount||1===(null==(C=E.bandIds)?void 0:C.length))return this._getStretchLegendElements(b,{min:f,max:ca});ma=ma&&ma.length>=W?a(ma):a();return this._createSymbolTableElementMultiBand(ma)};ia._getStretchLegendElements=function(b,a){b=p.getStrectchRampStops(b.colorRamp,a);return{type:"stretch-ramp",title:"",infos:b,preview:Q.renderColorRampPreviewHTML(b.map(f=>f.color))}};ia._getSizeLegendElement=function(){var b=H._asyncToGenerator(function*(a,f,C,E){return{type:"size-ramp",title:this._hasClusterSizeVariable?
this._getClusterTitle(f):a,infos:yield da.getRampStops(C,f,yield Y.getMedianColor(C),this.scale,this.view.type,E)}});return function(a,f,C,E){return b.apply(this,arguments)}}();ia._createSymbolTableElementMultiBand=function(b){const a=[],f=["red","green","blue"];b.forEach((C,E)=>{a.push({label:{colorName:f[E],bandName:C},src:Y.RGB_IMG_SOURCE[E],opacity:1})});return a};ia._updateInfosforClassedSizeRenderer=function(b,a){const f=b.authoringInfo&&"class-breaks-size"===b.authoringInfo.type,C=b.classBreakInfos.some(E=>
V.isVolumetricSymbol(E.symbol));if(f&&C){const E=da.REAL_WORLD_MAX_SIZE;b=b.classBreakInfos.length;const K=(E-da.REAL_WORLD_MIN_SIZE)/(1<b?b-1:b);a.forEach((W,ca)=>{W.size=E-K*ca})}};ia._isTallSymbol=function(b){let a=!1,f=!1;if(b)for(let C=0;C<b.length&&(!a||!f);C++){const E=b[C];"size"===E.type&&("height"===E.axis&&(a=!0),"width-and-depth"===E.axis&&(f=!0))}return a&&f};ia._getSymbolPreview=function(){var b=H._asyncToGenerator(function*(a,f,C){var E=null!=C&&C.isDefault||null!=a.size||!this._hasSizeRamp?
a.size:w.px2pt(n.SymbolSizeDefaults.size);this._scaleDrivenSizeVariable&&null!=C&&C.applyScaleDrivenSize&&({getSize:E}=yield new Promise((K,W)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],K,W)),E=E(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return Q.renderPreviewHTML(a.symbol,{size:E,opacity:f,scale:!1,symbolConfig:null==C?void 0:C.symbolConfig,effectView:null==C?void 0:C.effectList}).then(K=>
{a.preview=K;return a}).catch(()=>{a.preview=null;return a})});return function(a,f,C){return b.apply(this,arguments)}}();ia._loadRenderer=function(){var b=H._asyncToGenerator(function*(a){var f,C;const E=[];var K=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const W="visualVariables"in a&&(null==(f=a.visualVariables)?void 0:f.some(ma=>"size"===ma.type&&"outline"!==ma.target&&!ya.test(ma.valueExpression)));if(a&&"visualVariables"in a&&!W&&"featureReduction"in K&&"cluster"===(null==(C=K.featureReduction)?
void 0:C.type)&&(f=x.unwrap(c.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){K=K.featureReduction;if("clusterMinSize"in K&&"clusterMaxSize"in K){const {clusterMinSize:ma,clusterMaxSize:ua}=K;f.legendOptions=new P({showLegend:ma!==ua})}a.visualVariables=(a.visualVariables||[]).concat([f]);this._hasClusterSizeVariable=!0}const ca=yield Y.getMedianColor(a);if(ja(a)||ra(a))K=(a.classBreakInfos||a.uniqueValueInfos).map(ma=>this._fetchSymbol(ma.symbol,ca).then(ua=>{ma.symbol=ua}).catch(()=>
{ma.symbol=null})),Array.prototype.push.apply(E,K);E.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:ca).then(ma=>{this._applySymbolToRenderer(a,ma,ea(a))}).catch(()=>{this._applySymbolToRenderer(a,null,ea(a))}));return k.eachAlways(E).then(()=>a)});return function(a){return b.apply(this,arguments)}}();ia._applySymbolToRenderer=function(b,a,f){f?b.symbol=a:b.defaultSymbol=a};ia._fetchSymbol=function(b,a){if(!b)return Promise.reject();if("web-style"===b.type){var f=b.portal;f=
b.name+"-"+b.styleName+"-"+b.styleUrl+"-"+(f&&f.url)+"-"+(f&&f.user&&f.user.username);const C=this._webStyleSymbolCache;C.has(f)||("2d"===this.view.type?C.set(f,b.fetchCIMSymbol()):C.set(f,b.fetchSymbol()));return C.get(f).then(E=>this._getAppliedCloneSymbol(E,a)).catch(()=>{za.warn("Fetching web-style failed!");return Promise.reject()})}return Promise.resolve(this._getAppliedCloneSymbol(b,a))};ia._getAppliedCloneSymbol=function(b,a){if(!b||!a)return b;b=b.clone();const f=a&&a.toRgba();-1<b.type.indexOf("3d")?
this._applyColorTo3dSymbol(b,f):"cim"===b.type?r.applyCIMSymbolColor(b,a):b.color&&(b.color=new T(f||b.color));return b};ia._applyColorTo3dSymbol=function(b,a){a&&b.symbolLayers.forEach(f=>{f&&(f.material||(f.material={}),f.material.color=new T(a))})};ia._getVisualVariableLegendElements=function(){var b=H._asyncToGenerator(function*(a,f){var C=this;if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var E=a.visualVariables,K=[];const W=[],ca=[];for(const ha of E)"color"===
ha.type?K.push(ha):"size"===ha.type?W.push(ha):"opacity"===ha.type&&ca.push(ha);E=[...K,...W,...ca];let ma;if(0===K.length&&ja(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ua=(ua=a.classBreakInfos[0])&&ua.symbol;0===K.length&&ea(a)&&(ua=a.symbol);ua&&(-1<ua.type.indexOf("3d")?(K=ua.symbolLayers.getItemAt(0),"water"===K.type?x.isSome(K.color)&&(ma=K.color):x.isSome(K.material)&&x.isSome(K.material.color)&&(ma=K.material.color)):ua.url||(ma=ua.color));const Ca=this.effectList;return(yield Promise.all(E.map(function(){var ha=
H._asyncToGenerator(function*(ka){if(!ka.legendOptions||!1!==ka.legendOptions.showLegend){const va="flow"===a.type?ka.field:C._getRampTitle(ka,f);let Ba=null;var Aa="getField"in f&&f.getField&&f.getField(ka.field);Aa=Aa&&fa.isDateField(Aa);"color"===ka.type?(ka=yield p.getRampStops(ka,null,Aa),Ba={type:"color-ramp",title:va,infos:ka,preview:Q.renderColorRampPreviewHTML(ka.map(Ga=>Ga.color),{effectList:Ca})},C._hasColorRamp||(C._hasColorRamp=!(null==Ba.infos||!Ba.infos.length))):"size"===ka.type&&
"outline"!==ka.target?ya.test(ka.valueExpression)?C._hasClusterSizeVariable||(C._scaleDrivenSizeVariable=ka):(Ba=yield C._getSizeLegendElement(va,ka,a,Aa),C._hasSizeRamp||(C._hasSizeRamp=!(null==Ba.infos||!Ba.infos.length))):"opacity"===ka.type&&(ka=yield p.getRampStops(ka,ma,Aa),Ba={type:"opacity-ramp",title:va,infos:ka,preview:Q.renderColorRampPreviewHTML(ka.map(Ga=>Ga.color),{effectList:Ca})},C._hasOpacityRamp||(C._hasOpacityRamp=!(null==Ba.infos||!Ba.infos.length)));return Ba&&Ba.infos?Ba:null}});
return function(ka){return ha.apply(this,arguments)}}()))).filter(ha=>!!ha)});return function(a,f){return b.apply(this,arguments)}}();ia._getDomainName=function(b,a,f){return b&&"function"!==typeof b?(f=(b="getField"in f&&f.getField&&f.getField(b))&&"getFieldDomain"in f&&f.getFieldDomain?f.getFieldDomain(b.name):null)&&"coded-value"===f.type?f.getName(a):null:null};ia._getClusterTitle=function(b){var a=this.layer;b=b.field;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type&&
(a=a.featureReduction,a=(a="popupTemplate"in a&&a.popupTemplate)&&a.fieldInfos))for(const f of a)if(f.fieldName===b)return"cluster_count"===b?f.label||{showCount:!0}:f.label;return{showCount:!0}};ia._getRampTitle=function(b,a){let f=b.field,C=b.normalizationField,E=!1,K=!1,W=!1;var ca=null;f="function"===typeof f?null:f;C="function"===typeof C?null:C;ca=b.legendOptions&&b.legendOptions.title;if(null==ca)if(b.valueExpressionTitle)ca=b.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in
a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(b=a.renderer.authoringInfo.visualVariables,ca=0;ca<b.length;ca++){const ma=b[ca];if("color"===ma.type){if("ratio"===ma.style){E=!0;break}if("percent"===ma.style){K=!0;break}if("percent-of-total"===ma.style){W=!0;break}}}ca={field:f&&this._getFieldAlias(f,a),normField:C&&this._getFieldAlias(C,a),ratio:E,ratioPercent:K,ratioPercentTotal:W}}return ca};ia._getRendererTitle=function(b,a){if(b.legendOptions&&b.legendOptions.title)return b.legendOptions.title;
if(b.valueExpressionTitle)return b.valueExpressionTitle;let f=b.field,C=null,E=null;ja(b)&&(C=b.normalizationField,E="percent-of-total"===b.normalizationType);f="function"===typeof f?null:f;C="function"===typeof C?null:C;b=null;if(f||C)b={field:f&&this._getFieldAlias(f,a),normField:C&&this._getFieldAlias(C,a),normByPct:E};return b};ia._getFieldAlias=function(b,a){var f="popupTemplate"in a&&a.popupTemplate;f=f&&f.fieldInfos;let C=null;f&&f.some(K=>b===K.fieldName?(C=K,!0):!1);f=null;"getField"in a&&
a.getField?f=a.getField(b):"fieldsIndex"in a&&a.fieldsIndex&&(f=a.fieldsIndex.get(b));a=C||f;let E=null;a&&(E=C&&C.label||f&&f.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName);return E};ia._isUnclassedRenderer=function(b){const a=b.visualVariables;let f=!1;ja(b)&&b.classBreakInfos&&1===b.classBreakInfos.length&&a&&(f=b.field?a.some(C=>!(!C||b.field!==C.field||(b.normalizationField||C.normalizationField)&&b.normalizationField!==C.normalizationField)):!!a.length);return f};H._createClass(Ja,
[{key:"effectList",get:function(){const b=this.layer;let a=null;"effect"in b&&b.effect&&(a=new U.EffectView,a.effect=b.effect,a.end(),a.scale=this.scale);return a}},{key:"opacity",get:function(){var b;const a=this.layer.opacity,f=null==(b=this.parent)?void 0:b.opacity;b=(b=this.layer.parent)&&"uid"in b?this._getParentLayerOpacity(b):null;return null!=f?f*a:null!=b?b*a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},
{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",get:function(){var b=this.layer;if(null===b)return!1;if("effect"in b&&b.effect&&Array.isArray(b.effect)||"featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type)return!0;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;const a=b.get("renderer.valueExpression");if(ya.test(a))return!0;if(b=b.get("renderer.visualVariables"))return b.some(f=>this._isScaleDrivenSizeVariable(f))}return this._isLayerScaleDriven(this.layer)}},
{key:"version",get:function(){return this._get("version")+1}}]);return Ja}(J);I.__decorate([z.property()],N.prototype,"children",void 0);I.__decorate([z.property({readOnly:!0})],N.prototype,"effectList",null);I.__decorate([z.property()],N.prototype,"layerView",void 0);I.__decorate([z.property()],N.prototype,"layer",void 0);I.__decorate([z.property()],N.prototype,"legendElements",void 0);I.__decorate([z.property({readOnly:!0})],N.prototype,"opacity",null);I.__decorate([z.property()],N.prototype,"parent",
void 0);I.__decorate([z.property({readOnly:!0,dependsOn:[]})],N.prototype,"ready",null);I.__decorate([z.property()],N.prototype,"hideLayersNotInCurrentView",void 0);I.__decorate([z.property()],N.prototype,"keepCacheOnDestroy",void 0);I.__decorate([z.property()],N.prototype,"respectLayerVisibility",void 0);I.__decorate([z.property({readOnly:!0})],N.prototype,"scale",null);I.__decorate([z.property()],N.prototype,"sublayerIds",void 0);I.__decorate([z.property({readOnly:!0})],N.prototype,"isScaleDriven",
null);I.__decorate([z.property()],N.prototype,"title",void 0);I.__decorate([z.property({readOnly:!0,dependsOn:["ready"],value:0})],N.prototype,"version",null);I.__decorate([z.property()],N.prototype,"view",void 0);return N=I.__decorate([m.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],N)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u){function x(g){g=q.parse(g)||[];var h=(h=g[0])?"type"in h:!1;return h?[{scale:-1,effects:g}]:g}function k(g,h,z){var l,A,d,m;return null!=(l=g[0])&&l.effects&&null!=(A=h[0])&&A.effects?(-1===(null==(d=g[0])?void 0:d.scale)||-1===(null==(m=h[0])?void 0:m.scale))&&(1<g.length||1<h.length)&&0>=z?!1:u.canInterpolateEffects(g[0].effects,h[0].effects):!0}function w(g,h,z){var l,A;const d=g.length>h.length?g:h;g=g.length>h.length?h:g;const m=g[g.length-1];h=null!=(l=null==
m?void 0:m.scale)?l:z;l=null!=(A=null==m?void 0:m.effects)?A:[];for(A=g.length;A<d.length;A++)g.push({scale:h,effects:[...l]});for(A=0;A<d.length;A++)g[A].scale=-1===g[A].scale?z:g[A].scale,d[A].scale=-1===d[A].scale?z:d[A].scale,u.normalizeEffects(g[A].effects,d[A].effects)}F.EffectView=function(g){function h(l){l=g.call(this,l)||this;l._from=null;l._to=null;l._final=null;l._current=[];l._time=0;l.duration=O("mapview-transitions-duration");l.effects=[];return l}H._inheritsLoose(h,g);var z=h.prototype;
z.canTransitionTo=function(l){try{return 0<this.scale&&k(this._current,x(l),this.scale)}catch{return!1}};z.transitionStep=function(l,A){this._applyTimeTransition(l);this._updateForScale(A)};z.end=function(){this._applyTimeTransition(this.duration)};z._transitionTo=function(l){0<this.scale&&k(this._current,l,this.scale)?(this._final=l,this._to=X.clone(l),w(this._current,this._to,this.scale),this._from=X.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=l);this._set("effects",
this._current[0]?X.clone(this._current[0].effects):[])};z._applyTimeTransition=function(l){if(this._to&&this._from&&this._current&&this._final){this._time+=l;l=Math.min(1,this._time/this.duration);for(let d=0;d<this._current.length;d++){const m=this._current[d],M=this._from[d],U=this._to[d];var A=M.scale;m.scale=A+(U.scale-A)*l;for(A=0;A<m.effects.length;A++)m.effects[A].interpolate(M.effects[A],U.effects[A],l)}1===l&&(this._current=this._final,this._set("effects",this._current[0]?X.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};z._updateForScale=function(l){this._set("scale",l);if(0!==this._current.length){var A=this._current,d=this._current.length-1,m,M=1;if(1===A.length||l>=A[0].scale)var U=m=A[0].effects;else if(l<=A[d].scale)U=m=A[d].effects;else for(let B=0;B<d;B++){const R=A[B],fa=A[B+1];if(R.scale>=l&&fa.scale<=l){M=(l-R.scale)/(fa.scale-R.scale);m=R.effects;U=fa.effects;break}}for(l=0;l<this.effects.length;l++)this.effects[l].interpolate(m[l],U[l],M)}};H._createClass(h,
[{key:"effect",set:function(l){const A=this._get("effect");l=l||"";if(A!==l){this._set("effect",l);try{this._transitionTo(x(l))}catch(d){this._transitionTo([]),N.getLogger(this.declaredClass).warn("Invalid Effect",{effect:l,error:d})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(l){this._updateForScale(l)}},{key:"transitioning",get:function(){return null!==this._to}}]);return h}(T);I.__decorate([J.property()],F.EffectView.prototype,
"_to",void 0);I.__decorate([J.property()],F.EffectView.prototype,"duration",void 0);I.__decorate([J.property({value:""})],F.EffectView.prototype,"effect",null);I.__decorate([J.property({readOnly:!0})],F.EffectView.prototype,"effects",void 0);I.__decorate([J.property({readOnly:!0})],F.EffectView.prototype,"hasEffects",null);I.__decorate([J.property({value:0})],F.EffectView.prototype,"scale",null);I.__decorate([J.property({readOnly:!0})],F.EffectView.prototype,"transitioning",null);F.EffectView=I.__decorate([e.subclass("esri.layers.effects.EffectView")],
F.EffectView);F.canInterpolateEffectStops=k;F.convertEffectToStops=x;F.normalizeEffectStops=w;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./sublayerUtils ../../views/support/floorFilterUtils".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k){const w={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};F.ExportImageParameters=function(g){function h(l){l=g.call(this,l)||this;l.floors=null;l.scale=0;return l}H._inheritsLoose(h,g);var z=h.prototype;z.destroy=function(){this.layer=null};z.toJSON=
function(){var l=this.layer;l={dpi:l.dpi,format:l.imageFormat,transparent:l.imageTransparency,gdbVersion:l.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?l.dynamicLayers=this.dynamicLayers:l={...l,layers:this.layers,layerDefs:this.layerDefs};return l};H._createClass(h,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const l=this.visibleSublayers.map(A=>{const d=k.getLayerFloorFilterClause(this.floors,A);return A.toExportImageJSON(d)});return l.length?JSON.stringify(l):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&x.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(l){this._get("layer")!==l&&(this._set("layer",l),this.handles.remove("layer"),l&&this.handles.add([l.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),l.on("sublayer-update",A=>this.notifyChange(w[A.propertyName]))],"layer"))}},{key:"layers",get:function(){const l=this.visibleSublayers;return l?l.length?"show:"+
l.map(A=>A.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var l;const A=!(null==(l=this.floors)||!l.length);l=this.visibleSublayers.filter(d=>null!=d.definitionExpression||A&&null!=d.floorInfo);return l.length?JSON.stringify(l.reduce((d,m)=>{var M=k.getLayerFloorFilterClause(this.floors,m);M=X.isSome(M)?k.combineFloorsDefinitionExpression(M,m):m.definitionExpression;d[m.id]=M;return d},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");
this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");const l=this.layer;l&&(l.commitProperty("dpi"),l.commitProperty("imageFormat"),l.commitProperty("imageTransparency"),l.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const l=[];if(!this.layer)return l;var A=this.layer.sublayers;const d=m=>{const M=this.scale,U=0===m.minScale||M<=m.minScale,B=0===m.maxScale||M>=m.maxScale;m.visible&&(0===M||U&&B)&&(m.sublayers?m.sublayers.forEach(d):
l.unshift(m))};A&&A.forEach(d);A=this._get("visibleSublayers");return!A||A.length!==l.length||A.some((m,M)=>l[M]!==m)?l:A}}]);return h}(O.HandleOwnerMixin(T));I.__decorate([N.property({readOnly:!0})],F.ExportImageParameters.prototype,"dynamicLayers",null);I.__decorate([N.property()],F.ExportImageParameters.prototype,"floors",void 0);I.__decorate([N.property({readOnly:!0})],F.ExportImageParameters.prototype,"hasDynamicLayers",null);I.__decorate([N.property()],F.ExportImageParameters.prototype,"layer",
null);I.__decorate([N.property({readOnly:!0})],F.ExportImageParameters.prototype,"layers",null);I.__decorate([N.property({readOnly:!0})],F.ExportImageParameters.prototype,"layerDefs",null);I.__decorate([N.property({type:Number})],F.ExportImageParameters.prototype,"scale",void 0);I.__decorate([N.property(u.combinedViewLayerTimeExtentProperty)],F.ExportImageParameters.prototype,"timeExtent",void 0);I.__decorate([N.property({readOnly:!0})],F.ExportImageParameters.prototype,"version",null);I.__decorate([N.property({readOnly:!0})],
F.ExportImageParameters.prototype,"visibleSublayers",null);F.ExportImageParameters=I.__decorate([q.subclass("esri.layers.mixins.ExportImageParameters")],F.ExportImageParameters);Object.defineProperty(F,"__esModule",{value:!0})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],function(F,H,I,T,O){function X(e){return T.isNone(e)||"simple"===e.type||"unique-value"===e.type||"class-breaks"===
e.type||"dictionary"===e.type||"heatmap"===e.type}function N(e,q){if(!q)return null;q=Array.isArray(q)?q:[q];if(0<q.length){const u=q.map(k=>k.details.symbol.type||k.details.symbol.declaredClass).filter(k=>!!k);u.sort();const x=[];u.forEach((k,w)=>{0!==w&&k===u[w-1]||x.push(k)});return new I("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${x.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:q})}return null}function J(e){const q=e.uniqueValueInfos.map(x=>
O.to3D(x.symbol).error).filter(x=>!!x),u=O.to3D(e.defaultSymbol);u.error&&q.unshift(u.error);return N(e,q)}function Z(e){const q=e.classBreakInfos.map(x=>O.to3D(x.symbol).error).filter(x=>!!x),u=O.to3D(e.defaultSymbol);u.error&&q.unshift(u.error);return N(e,q)}F.isSupportedRenderer3D=X;F.validateTo3D=function(e){if(T.isNone(e))return null;if(!X(e))return new I("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case "simple":return N(e,
O.to3D(e.symbol).error);case "unique-value":return J(e);case "class-breaks":return Z(e)}return null};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(F,H,I,T,O,X,N,J,Z,e){function q(x,k,w){return x?I(x,{responseType:"image"}).then(g=>{g=g.data;const h=g.width,
z=g.height,l=h/z;let A=k;w&&(A=Math.min(A,Math.max(h,z)));return{image:g,width:1>=l?Math.ceil(A*l):A,height:1>=l?A:Math.ceil(A/l)}}):Promise.reject(new O("renderUtils: imageDataSize","href not provided."))}const u=J.createProjector();F.renderSymbol=function(x,k,w){const g=Math.ceil(k[0]);k=Math.ceil(k[1]);if(!x.some(z=>!!z.length))return null;const h=w&&w.node||document.createElement("div");null!=w.opacity&&(h.style.opacity=w.opacity.toString());null!=w.effectView&&(h.style.filter=e.getCSSFilterFromEffectList(w.effectView));
u.append(h,Z.renderSVG.bind(null,x,g,k,w));return h};F.tintImageWithColor=function(x,k,w,g,h){return q(x,k,h).then(z=>{const l=z.width?z.width:k,A=z.height?z.height:k;var d;if(d=z.image)d=w&&"ignore"!==g?"multiply"===g&&255===w.r&&255===w.g&&255===w.b&&1===w.a?!1:!0:!1;if(d){var m=z.image.width,M=z.image.height;X("edge")&&/\.svg$/i.test(x)&&(--m,--M);d=Math.ceil(l);var U=Math.ceil(A);var B=document.createElement("canvas");B.width=d;B.height=U;B.style.width=d+"px";B.style.height=U+"px";B=B.getContext("2d");
B.clearRect(0,0,d,U);d=B;d.drawImage(z.image,0,0,m,M,0,0,l,A);U=d.getImageData(0,0,l,A);B=[w.r/255,w.g/255,w.b/255,w.a];const fa=T.toHSV(w);for(let ba=0;ba<U.data.length;ba+=4){z=U.data;m=ba;M=B;var R=fa;switch(g){case "multiply":z[m+0]*=M[0];z[m+1]*=M[1];z[m+2]*=M[2];z[m+3]*=M[3];break;default:{const y=T.toHSV({r:z[m+0],g:z[m+1],b:z[m+2]});y.h=R.h;y.s=R.s;y.v=y.v/100*R.v;R=T.toRGB(y);z[m+0]=R.r;z[m+1]=R.g;z[m+2]=R.b;z[m+3]*=M[3]}}}d.putImageData(U,0,0);x=d.canvas.toDataURL("image/png")}else(d=H.id&&
H.id.findCredential(x))&&d.token&&(z=-1===x.indexOf("?")?"?":"\x26",x=`${x}${z}token=${d.token}`);return{url:x,width:l,height:A}}).catch(function(){return{url:x,width:k,height:k}})};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(F){function H(e,q){const u=[];let x,k;if(e[0].length!==q.length)throw"dimensions do not match";const w=e.length,g=e[0].length;let h=0;for(x=0;x<w;x++){for(k=h=0;k<g;k++)h+=e[x][k]*q[k];u.push(h)}return u}function I(e){e=
[e.r/255,e.g/255,e.b/255].map(q=>.04045>=q?q/12.92:((q+.055)/1.055)**2.4);e=H(J,e);return{x:100*e[0],y:100*e[1],z:100*e[2]}}function T(e){e=H(Z,[e.x/100,e.y/100,e.z/100]).map(q=>Math.min(1,Math.max(.0031308>=q?12.92*q:1.055*q**(1/2.4)-.055,0)));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function O(e){e=[e.x/95.047,e.y/100,e.z/108.883].map(q=>q>(6/29)**3?q**(1/3):1/3*(29/6)**2*q+4/29);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function X(e){const q=
e.l;e=[(q+16)/116+e.a/500,(q+16)/116,(q+16)/116-e.b/200].map(u=>u>6/29?u**3:3*(6/29)**2*(u-4/29));return{x:95.047*e[0],y:100*e[1],z:108.883*e[2]}}function N(e){if("r"in e&&"g"in e&&"b"in e)return e;if("l"in e&&"c"in e&&"h"in e){var q=e.c;var u=e.h;q={l:e.l,a:q*Math.cos(u),b:q*Math.sin(u)};return T(X(q))}if("l"in e&&"a"in e&&"b"in e)return T(X(e));if("x"in e&&"y"in e&&"z"in e)return T(e);if("h"in e&&"s"in e&&"v"in e){{u=(e.h+360)%360/60;q=e.v/100*255;e=e.s/100*q;const x=e*(1-Math.abs(u%2-1));switch(Math.floor(u)){case 0:u=
{r:e,g:x,b:0};break;case 1:u={r:x,g:e,b:0};break;case 2:u={r:0,g:e,b:x};break;case 3:u={r:0,g:x,b:e};break;case 4:u={r:x,g:0,b:e};break;case 5:case 6:u={r:e,g:0,b:x};break;default:u={r:0,g:0,b:0}}u.r=Math.round(u.r+q-e);u.g=Math.round(u.g+q-e);u.b=Math.round(u.b+q-e);q=u}return q}return e}const J=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],Z=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];F.darken=function(e,q){e=O(I(e));e.l*=1-q;return T(X(e))};F.toHSV=function(e){if("h"in
e&&"s"in e&&"v"in e)return e;var q=N(e);{e=q.r;const u=q.g,x=q.b;q=Math.max(e,u,x);const k=q-Math.min(e,u,x);e=0===k?0:q===e?(u-x)/k%6:q===u?(x-e)/k+2:(e-u)/k+4;0>e&&(e+=6);e={h:60*e,s:100*(0===k?0:k/q),v:100/255*q}}return e};F.toLAB=function(e){return"l"in e&&"a"in e&&"b"in e?e:O(I(N(e)))};F.toLCH=function(e){if(!("l"in e&&"c"in e&&"h"in e)){{var q=O(I(N(e)));e=q.l;var u=q.a;const x=q.b;q=Math.sqrt(u*u+x*x);u=Math.atan2(x,u);u=0<u?u:u+2*Math.PI;e={l:e,c:q,h:u}}}return e};F.toRGB=N;F.toXYZ=function(e){return"x"in
e&&"y"in e&&"z"in e?e:I(N(e))};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../core/Logger ../../widgets/support/jsxFactory".split(" "),function(F,H,I,T,O,X,N,J){function Z(c,p){c*=Q/180;return Math.abs(p*Math.sin(c))+Math.abs(p*Math.cos(c))}function e(c){return c.map(p=>`${p.command} ${p.values.join(" ")}`).join(" ").trim()}function q(c,
p,v,G){if(c){if("circle"===c.type)return J.tsx("circle",{fill:p,"fill-rule":"evenodd",stroke:v.color,"stroke-width":v.width,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-dasharray":v.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,r:c.r});if("ellipse"===c.type)return J.tsx("ellipse",{fill:p,"fill-rule":"evenodd",stroke:v.color,"stroke-width":v.width,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-dasharray":v.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,rx:c.rx,ry:c.ry});
if("rect"===c.type)return J.tsx("rect",{fill:p,"fill-rule":"evenodd",stroke:v.color,"stroke-width":v.width,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-dasharray":v.dashArray,"stroke-miterlimit":"4",x:c.x,y:c.y,width:c.width,height:c.height});if("image"===c.type)return J.tsx("image",{href:c.src,x:c.x,y:c.y,width:c.width,height:c.height,preserveAspectRatio:"none"});if("path"===c.type)return c="string"!==typeof c.path?e(c.path):c.path,J.tsx("path",{fill:p,"fill-rule":"evenodd",stroke:v.color,
"stroke-width":v.width,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-dasharray":v.dashArray,"stroke-miterlimit":"4",d:c});if("text"===c.type)return J.tsx("text",{fill:p,"fill-rule":"evenodd",stroke:v.color,"stroke-width":v.width,"stroke-linecap":v.cap,"stroke-linejoin":v.join,"stroke-dasharray":v.dashArray,"stroke-miterlimit":"4","text-anchor":G.align,"text-decoration":G.decoration,kerning:G.kerning,rotate:G.rotate,"text-rendering":ba,"font-style":G.font.style,"font-variant":G.font.variant,
"font-weight":G.font.weight,"font-size":G.font.size,"font-family":G.font.family,x:c.x,y:c.y},c.text)}return null}function u(c){const p={fill:"none",pattern:null,linearGradient:null};if(c)if("type"in c&&"pattern"===c.type){var v=`patternId-${++R}`;p.fill=`url(#${v})`;p.pattern={id:v,x:c.x,y:c.y,width:c.width,height:c.height,image:{x:0,y:0,width:c.width,height:c.height,href:c.src}}}else"type"in c&&"linear"===c.type?(v=`linearGradientId-${++fa}`,p.fill=`url(#${v})`,p.linearGradient={id:v,x1:c.x1,y1:c.y1,
x2:c.x2,y2:c.y2,stops:c.colors.map(G=>({offset:G.offset,color:G.color&&(new H(G.color)).toString()}))}):c&&(c=new H(c),p.fill=c.toString());return p}function x(c){const p={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(c&&(null!=c.width&&(p.width=c.width),c.cap&&(p.cap=c.cap),c.join&&(p.join=c.join.toString()),c.color&&(p.color=(new H(c.color)).toString()),c.style)){let G=null;c.style in L&&(G=L[c.style]);if(Array.isArray(G)){G=G.slice(0);for(var v=0;v<G.length;++v)G[v]*=c.width;if("butt"!==
c.cap){for(v=0;v<G.length;v+=2)G[v]-=c.width,1>G[v]&&(G[v]=1);for(v=1;v<G.length;v+=2)G[v]+=c.width}G=G.join(",")}p.dashArray=G}return p}function k(c,p){const v={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};c&&(v.align=c.align,v.decoration=c.decoration,v.kerning=c.kerning?"auto":"0",v.rotate=c.rotated?"90":"0",v.font.style=p.style||"normal",v.font.variant=p.variant||"normal",v.font.weight=p.weight||"normal",v.font.size=p.size&&
p.size.toString()||"10pt",v.font.family=p.family||"serif");return v}function w(c){const {pattern:p,linearGradient:v}=c;return p?J.tsx("pattern",{id:p.id,patternUnits:"userSpaceOnUse",x:p.x,y:p.y,width:p.width,height:p.height},J.tsx("image",{x:p.image.x,y:p.image.y,width:p.image.width,height:p.image.height,href:p.image.href})):v?(c=v.stops.map((G,da)=>J.tsx("stop",{key:`${da}-stop`,offset:G.offset,"stop-color":G.color})),J.tsx("linearGradient",{id:v.id,gradientUnits:"userSpaceOnUse",x1:v.x1,y1:v.y1,
x2:v.x2,y2:v.y2},c)):null}function g(c,p,v){return O.translate(c,O.identity(c),[p,v])}function h(c,p,v,G,da){O.scale(c,O.identity(c),[p,v]);c[4]=c[4]*p-G*p+G;c[5]=c[5]*v-da*v+da;return c}function z(c,p,v,G){var da=p%360*Math.PI/180;O.rotate(c,O.identity(c),da);p=Math.cos(da);da=Math.sin(da);const Y=c[4],t=c[5];c[4]=Y*p-t*da+G*da-v*p+v;c[5]=t*p+Y*da-v*da-G*p+G;return c}function l(c,p){r&&"left"in r?(r.left>c&&(r.left=c),r.right<c&&(r.right=c),r.top>p&&(r.top=p),r.bottom<p&&(r.bottom=p)):r={left:c,
bottom:p,right:c,top:p}}function A(c){const p=c.args,v=p.length;switch(c.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<v;c+=2)l(p[c],p[c+1]);n.x=p[v-2];n.y=p[v-1];break;case "H":for(c=0;c<v;++c)l(p[c],n.y);n.x=p[v-1];break;case "V":for(c=0;c<v;++c)l(n.x,p[c]);n.y=p[v-1];break;case "m":c=0;"x"in n||(l(n.x=p[0],n.y=p[1]),c=2);for(;c<v;c+=2)l(n.x+=p[c],n.y+=p[c+1]);break;case "l":case "t":for(c=0;c<v;c+=2)l(n.x+=p[c],n.y+=p[c+1]);break;case "h":for(c=0;c<v;++c)l(n.x+=p[c],n.y);
break;case "v":for(c=0;c<v;++c)l(n.x,n.y+=p[c]);break;case "c":for(c=0;c<v;c+=6)l(n.x+p[c],n.y+p[c+1]),l(n.x+p[c+2],n.y+p[c+3]),l(n.x+=p[c+4],n.y+=p[c+5]);break;case "s":case "q":for(c=0;c<v;c+=4)l(n.x+p[c],n.y+p[c+1]),l(n.x+=p[c+2],n.y+=p[c+3]);break;case "A":for(c=0;c<v;c+=7)l(p[c+5],p[c+6]);n.x=p[v-2];n.y=p[v-1];break;case "a":for(c=0;c<v;c+=7)l(n.x+=p[c+5],n.y+=p[c+6])}}function d(c,p,v){const G=y[c.toLowerCase()];"number"===typeof G&&(G?p.length>=G&&(c={action:c,args:p.slice(0,p.length-p.length%
G)},v.push(c),A(c)):(c={action:c,args:[]},v.push(c),A(c)))}function m(c){const p={x:0,y:0,width:0,height:0};if("circle"===c.type)p.x=c.cx-c.r,p.y=c.cy-c.r,p.width=2*c.r,p.height=2*c.r;else if("ellipse"===c.type)p.x=c.cx-c.rx,p.y=c.cy-c.ry,p.width=2*c.rx,p.height=2*c.ry;else if("image"===c.type||"rect"===c.type)p.x=c.x,p.y=c.y,p.width=c.width,p.height=c.height;else if("path"===c.type){{const da=("string"!==typeof c.path?e(c.path):c.path).match(P),Y=[];r={};n={};if(da){c="";var v=[],G=da.length;for(let t=
0;t<G;++t){const D=da[t],S=parseFloat(D);isNaN(S)?(c&&d(c,v,Y),v=[],c=D):v.push(S)}d(c,v,Y);c={x:0,y:0,width:0,height:0};r&&"left"in r&&(c.x=r.left,c.y=r.top,c.width=r.right-r.left,c.height=r.bottom-r.top)}else c=null}p.x=c.x;p.y=c.y;p.width=c.width;p.height=c.height}return p}function M(c){const p={x:0,y:0,width:0,height:0};let v=null,G=Number.NEGATIVE_INFINITY,da=Number.NEGATIVE_INFINITY;for(const Y of c)v?(v.x=Math.min(v.x,Y.x),v.y=Math.min(v.y,Y.y),G=Math.max(G,Y.x+Y.width),da=Math.max(da,Y.y+
Y.height)):(v=p,v.x=Y.x,v.y=Y.y,G=Y.x+Y.width,da=Y.y+Y.height);v&&(v.width=G-v.x,v.height=da-v.y);return v}function U(c,p,v,G,da,Y,t,D,S){var ea=(t&&Y?Z(Y,p):p)/2,ja=(t&&Y?Z(Y,v):v)/2;S&&(ea=S[0],ja=S[1],ea=(t&&Y?Z(Y,ea):ea)/2,ja=(t&&Y?Z(Y,ja):ja)/2);const ra=c.width+G,qa=c.height+G;t=T.create();S=T.create();var la=!1;if(da&&0!==ra&&0!==qa){da=p!==v?p/v:ra/qa;la=p>v?p:v;let na=1,aa=1;isNaN(la)||(1<da?(na=la/ra,aa=la/da/qa):(aa=la/qa,na=la*da/ra));O.multiply(S,S,h(t,na,aa,ea,ja));la=!0}da=c.x+(ra-
G)/2;c=c.y+(qa-G)/2;O.multiply(S,S,g(t,ea-da,ja-c));!la&&(ra>p||qa>v)&&(G=ra/p>qa/v,p=(G?p:v)/(G?ra:qa),O.multiply(S,S,h(t,p,p,da,c)));Y&&O.multiply(S,S,z(t,Y,da,c));D&&O.multiply(S,S,g(t,D[0],D[1]));return`matrix(${S[0]},${S[1]},${S[2]},${S[3]},${S[4]},${S[5]})`}function B(c,p,v){c=null==c?void 0:c.effects.find(D=>"bloom"===D.type);if(!c)return null;const {strength:G,radius:da}=c;c=0<G?da:0;const Y=(G+c)*p,t=4*G+1;return J.tsx("filter",{id:`bloom${v}`,x:"-100%",y:"-100%",width:"300%",height:"300%",
filterUnits:"userSpaceOnUse"},J.tsx("feMorphology",{operator:"dilate",radius:(G+.5*c)*5**(p/100)*(.4+p/100),in:"SourceGraphic",result:"dilate"}),J.tsx("feGaussianBlur",{in:"dilate",stdDeviation:Y/25,result:"blur"}),J.tsx("feGaussianBlur",{in:"blur",stdDeviation:Y/50,result:"intensityBlur"}),J.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},J.tsx("feFuncR",{type:"linear",slope:t}),J.tsx("feFuncG",{type:"linear",slope:t}),J.tsx("feFuncB",{type:"linear",slope:t})),J.tsx("feMerge",
null,J.tsx("feMergeNode",{in:"intensityBlur"}),J.tsx("feMergeNode",{in:"intensityBrightness"}),J.tsx("feGaussianBlur",{stdDeviation:G/10})))}let R=0,fa=0;X=I("android");const ba=I("chrome")||X&&4<=X?"auto":"optimizeLegibility",y={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},P=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let r={},n={};const L={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],
longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},Q=Math.PI;let V=1;F.computeBBox=M;F.generateFillAttributes=u;F.generateStrokeAttributes=x;F.generateTextAttributes=k;F.getBoundingBox=m;F.getTransformMatrix=U;F.renderDef=w;F.renderSVG=function(c,p,v,G){const da=[],Y=[],t=++V,D=B(null==G?void 0:G.effectView,p,t);var S=null;if(D){var ea;S=null==G?void 0:null==(ea=G.effectView)?void 0:ea.effects.find(ja=>"bloom"===ja.type);S=(S.strength?S.strength+S.radius/2:0)/3;S=[Math.max(p+p*S,10),Math.max(v+v*
S,10)]}for(const ja of c){c=[];ea=[];let ra=0,qa=0,la=0;for(const na of ja){const {shape:aa,fill:ta,stroke:oa,font:wa,offset:xa}=na;ra+=oa&&oa.width||0;const za=u(ta),ya=x(oa),Ea="text"===aa.type?k(aa,wa):null;da.push(w(za));c.push(q(aa,za.fill,ya,Ea));ea.push(m(aa));xa&&(qa+=xa[0],la+=xa[1])}ea=U(M(ea),p,v,ra,null==G?void 0:G.scale,null==G?void 0:G.rotation,null==G?void 0:G.useRotationSize,[qa,la],S);Y.push(J.tsx("g",{transform:ea},c))}null!=G&&G.useRotationSize&&null!=G&&G.rotation&&(p=Z(null==
G?void 0:G.rotation,p),v=Z(null==G?void 0:G.rotation,v));D&&(p=S[0],v=S[1]);return J.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:p,height:v,style:"display: block;"},D,J.tsx("defs",null,da),D?J.tsx("g",{filter:`url(#bloom${t})`},Y):Y)};F.renderShape=q;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(F,H){const I=(T,O)=>{T=T.featuresTilingScheme.getClosestInfoForScale(T.scale).level;
return null!=O&&O.levels?O.levels[T]:null};F.getClusterSizeVariable=function(T,O){if(!(T&&"visualVariables"in T&&T.visualVariables))return null;T=T.visualVariables.find(X=>"size"===X.type);return(O=I(O,T))?new H({field:T.field,minSize:O[2].size,minDataValue:O[2].value,maxSize:O[3].size,maxDataValue:O[3].value}):null};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color",
"./utils"],function(F,H,I,T,O){function X(x,k){const w=[],g=x.length-1;5===x.length?w.push(0,2,4):w.push(0,g);return x.map((h,z)=>-1<w.indexOf(z)?O.createStopLabel(h,z,g,k):null)}function N(){N=I._asyncToGenerator(function*(x,k,w){let g=!1,h=[],z=[];if(x.stops){var l=x.stops;h=l.map(d=>d.value);(g=l.some(d=>!!d.label))&&(z=l.map(d=>d.label))}l=h[h.length-1];if(null==h[0]&&null==l)return null;const A=g?null:X(h,w);return(yield Promise.all(h.map(function(){var d=I._asyncToGenerator(function*(m,M){const U=
"opacity"===x.type?yield J(m,x,k):(yield new Promise((B,R)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],B,R))).getColor(x,m);return{value:m,color:U,label:g?z[M]:A[M]}});return function(m,M){return d.apply(this,arguments)}}()))).reverse()});return N.apply(this,arguments)}function J(x,k){return Z.apply(this,arguments)}function Z(){Z=I._asyncToGenerator(function*(x,k,w=u){w=new T(w);x=(yield new Promise((g,h)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],
g,h))).getOpacity(k,x);null!=x&&(w.a=x);return w});return Z.apply(this,arguments)}function e(x,k){const {startIndex:w,endIndex:g,weight:h}=q(x,k);if(w===g)return k[w].color;x=T.blendColors(k[w].color,k[g].color,h);return new T(x)}function q(x,k){let w=0,g=k.length-1;k.some((h,z)=>{if(x<h.value)return g=z,!0;w=z;return!1});return{startIndex:w,endIndex:g,weight:(x-k[w].value)/(k[g].value-k[w].value)}}const u=new T([64,64,64]);H.getColorFromPointCloudStops=e;H.getRampStops=function(x,k,w){return N.apply(this,
arguments)};H.getRampStopsForPointCloud=function(x){let k=!1,w=[],g=[];w=x.map(l=>l.value);(k=x.some(l=>!!l.label))&&(g=x.map(l=>l.label));const h=w[w.length-1];if(null==w[0]&&null==h)return null;const z=k?null:X(w,!1);return w.map((l,A)=>{const d=e(l,x);return{value:l,color:d,label:k?g[A]:z[A]}}).reverse()};H.getStrectchRampStops=function(x,k){let w=[];if(x&&"multipart"===x.type)x.colorRamps.reverse().forEach(function(g,h){0===h?w.push({value:k.max,color:new T(g.toColor),label:"high"}):w.push({value:null,
color:new T(g.toColor),label:""});h===x.colorRamps.length-1?w.push({value:k.min,color:new T(g.fromColor),label:"low"}):w.push({value:null,color:new T(g.fromColor),label:""})});else{let g,h;x&&"algorithmic"===x.type?(g=x.fromColor,h=x.toColor):(g=[0,0,0,1],h=[255,255,255,1]);w=[{value:k.max,color:new T(h),label:"high"},{value:k.min,color:new T(g),label:"low"}]}return w};Object.defineProperty(H,"__esModule",{value:!0})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),
function(F,H,I,T,O,X,N){function J(u){return Z.apply(this,arguments)}function Z(){Z=I._asyncToGenerator(function*(u){if(!("visualVariables"in u&&u.visualVariables))return null;u=u.visualVariables.find(w=>"color"===w.type);if(!u)return null;var x=null,k=null;if(u.stops){if(1===u.stops.length)return u.stops[0].color;x=u.stops[0].value;k=u.stops[u.stops.length-1].value}x+=(k-x)/2;({getColor:k}=yield new Promise((w,g)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],w,g)));return k(u,
x)});return Z.apply(this,arguments)}function e(){e=I._asyncToGenerator(function*(u,x){const k=u.trailWidth||1;u=x||(yield J(u))||u.color;return new N({cap:"butt",color:u,width:k})});return e.apply(this,arguments)}const q=O.convertDateFormatToIntlOptions("short-date");H.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];H.SPECIAL_CHARS_GREATER_THAN="\x3e";H.SPECIAL_CHARS_LESS_THAN="\x3c";H.createStopLabel=function(u,x,k,w){let g="";0===x?g="\x3c ":x===k&&(g="\x3e ");x=null;x=w?O.formatDate(u,q):X.format(u);return g+x};H.getMedianColor=J;H.getSymbolForFlowRenderer=function(u,x){return e.apply(this,arguments)};Object.defineProperty(H,
"__esModule",{value:!0})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(F,H,I){function T(q,u){return q-u}function O(q,u){let x;x=Number(q.toFixed(u));x<q?q=x+1/10**u:(q=x,x-=1/10**u);x=Number(x.toFixed(u));q=Number(q.toFixed(u));return[x,q]}function X(q,u,x,k,w){q=J(q,u,x,k);u=null==q.next||q.next<=w;return(null==q.previous||q.previous<=w)&&u||q.previous+q.next<=2*w}function N(q){q=String(q);var u=q.match(Z);if(u&&u[1])return{integer:u[1].split("").length,
fractional:u[3]?u[3].split("").length:0};if(-1<q.toLowerCase().indexOf("e")&&(u=q.split("e"),q=u[0],u=u[1],q&&u)){q=Number(q);u=Number(u);const x=0<u;x||(u=Math.abs(u));q=N(q);x?(q.integer+=u,q.fractional=u>q.fractional?0:q.fractional-u):(q.fractional+=u,q.integer=u>q.integer?1:q.integer-u);return q}return{integer:0,fractional:0}}function J(q,u,x,k){const w={previous:null,next:null};if(null!=x){const g=q-x;w.previous=Math.floor(Math.abs(100*(u-x-g)/g))}null!=k&&(q=k-q,w.next=Math.floor(Math.abs(100*
(k-u-q)/q)));return w}const Z=/^-?(\d+)(\.(\d+))?$/i,e={maximumFractionDigits:20};F.format=function(q){return I.formatNumber(q,e)};F.numDigits=N;F.percentChange=J;F.round=function(q,u={}){q=q.slice(0);const {tolerance:x=2,strictBounds:k=!1,indexes:w=q.map((h,z)=>z)}=u;w.sort(T);for(u=0;u<w.length;u++){const h=w[u],z=q[h],l=0===h?null:q[h-1],A=h===q.length-1?null:q[h+1],d=N(z).fractional;if(d){let m=0,M=!1;for(var g=void 0;m<=d&&!M;)g=O(z,m),g=k&&0===u?g[1]:g[0],M=X(z,g,l,A,x),m++;M&&(q[h]=g)}}return q};
Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(F,H){F.getHeatmapRampStops=function(I){I=I.colorStops;let T=I.length-1;if(I&&I[0]){const O=I[T];O&&1!==O.ratio&&(I=I.slice(0),I.push(new H({ratio:1,color:O.color})),T++)}return I.map((O,X)=>{let N="";0===X?N="low":X===T&&(N="high");return{color:O.color,label:N,ratio:O.ratio}}).reverse()};Object.defineProperty(F,"__esModule",
{value:!0})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(F,H,I,T){function O(e){if(e){var {type:q}=e;return-1<q.indexOf("3d")?T.getSymbolLayerFill(e.symbolLayers.getItemAt(0)):"simple-line"===q||"simple-marker"===e.type&&("x"===e.style||"cross"===e.style)?(e=I.getStroke(e))&&e.color:I.getFill(e)}}function X(e,q){const u=q.HH.label,x=q.LL.label,k=q.HL.label;
q=q.LH.label;switch(e){case "HH":return{top:u,bottom:x,left:k,right:q};case "HL":return{top:k,bottom:q,left:x,right:u};case "LL":return{top:x,bottom:u,left:q,right:k};case "LH":return{top:q,bottom:k,left:u,right:x};default:return{top:u,bottom:x,left:k,right:q}}}function N(e){let q=J[e];e&&null==q&&(q=J.HH);return q||0}const J={HH:315,HL:45,LL:135,LH:225},Z={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L",
"M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};F.getRelationshipRampColors2D=function(e,q){const u=[],x=e.length**.5;e=H.clone(e);var k=(q||"HH").split("");q=k[0];for(k="H"===k[1];e.length;){const w=[];for(;w.length<x;)w.push(e.shift());k&&w.reverse();u.push(w)}"L"===q&&u.reverse();return u};F.getRelationshipRampElement=function(e){const {focus:q,infos:u,numClasses:x}=e;var k=Z[x];const w={};u.forEach(g=>{w[g.value]={label:g.label,fill:O(g.symbol)}});e=[];for(let g=0;g<x;g++){const h=[];for(let z=
0;z<x;z++)h.push(w[k[g][z]].fill);e.push(h)}k=X(q,w);return{type:"relationship-ramp",numClasses:x,focus:q,colors:e,labels:k,rotation:N(q)}};F.getRotationAngleForFocus=N;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k,w,g,h){function z(t){const D=t.outline;var S=J.isSome(t.material)?t.material.color:null;S=J.isSome(S)?S.toHex():null;if(J.isNone(D)||"pattern"in D&&J.isSome(D.pattern)&&"style"===D.pattern.type&&"none"===D.pattern.style)return"fill"===t.type&&"#ffffff"===S?{color:"#bdc3c7",width:.75}:null;t=e.pt2px(D.size)||0;return{color:"rgba("+(J.isSome(D.color)?D.color.toRgba():"255,255,255,1")+")",width:Math.min(t,v),style:"pattern"in D&&J.isSome(D.pattern)&&"style"===D.pattern.type?
q.dekebabifyLineStyle(D.pattern.style):null,join:"butt",cap:"patternCap"in D?D.patternCap:"butt"}}function l(t,D){var S=D&&D.resource;S=S&&S.href;if(t.thumbnail&&t.thumbnail.url)return Promise.resolve(t.thumbnail.url);if(S&&"object"!==D.type)return Promise.resolve(g.getIconHref(t,D));const ea=I.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)?h.resolveWebStyleSymbol(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch(ja=>
ja).then(ja=>{var ra;return(null==ja?void 0:null==(ra=ja.thumbnail)?void 0:ra.url)||ea}):Promise.resolve(ea)}function A(t,D=1){const S=t.a;t=T.toHSV(t);const {r:ea,g:ja,b:ra}=T.toRGB({h:t.h,s:t.s/D,v:100-(100-t.v)/D});return[ea,ja,ra,S]}function d(t){return"water"===t.type?J.isNone(t.color)?null:t.color:J.isNone(t.material)||J.isNone(t.material.color)?null:t.material.color}function m(t,D=0){var S=d(t);if(!S){if("fill"===t.type)return null;D=k.adjustColorComponentBrightness(q.defaultThematicColor.r,
D);return[D,D,D,100]}t=S.toRgba();for(S=0;3>S;S++)t[S]=k.adjustColorComponentBrightness(t[S],D);return t}function M(t,D){return U.apply(this,arguments)}function U(){U=H._asyncToGenerator(function*(t,D){t=t.style;return"none"===t?null:{type:"pattern",x:0,y:0,src:yield q.getPatternUrlWithColor(I.getAssetUrl(`esri/symbols/patterns/${t}.png`),D.toCss(!0)),width:5,height:5}});return U.apply(this,arguments)}function B(t){return t.outline?z(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function R(t,D){t=d(t);
if(!t)return null;let S;S="rgba("+(k.adjustColorComponentBrightness(t.r,D)+",");S+=k.adjustColorComponentBrightness(t.g,D)+",";S+=k.adjustColorComponentBrightness(t.b,D)+",";return S+t.a+");"}function fa(t,D){D=R(t,D);if(!D)return{};if("pattern"in t&&J.isSome(t.pattern)&&"style"===t.pattern.type&&"none"===t.pattern.style)return null;const S=Math.min(t.size?e.pt2px(t.size):.75,v);return{color:D,width:S,style:"pattern"in t&&J.isSome(t.pattern)&&"style"===t.pattern.type?q.dekebabifyLineStyle(t.pattern.style):
null,cap:"cap"in t?t.cap:null,join:"join"in t?"miter"===t.join?e.pt2px(2):t.join:null}}function ba(t,D,S){S*=.75;return{type:"linear",x1:S?.25*S:0,y1:S?.5*S:0,x2:S||4,y2:S?.5*S:4,colors:[{color:t,offset:0},{color:D,offset:1}]}}function y(t){const D=t.depth,S=t.height;return(t=t.width)&&D&&S&&t===D&&t<S}function P(t,D,S){const ea=[];if(!t)return ea;switch(t.type){case "icon":switch(t.resource&&t.resource.primitive||u.defaultPrimitive){case "circle":ea.push({shape:{type:"circle",cx:0,cy:0,r:.5*D},fill:m(t,
0),stroke:z(t)});break;case "square":ea.push({shape:{type:"path",path:[{command:"M",values:[0,D]},{command:"L",values:[0,0]},{command:"L",values:[D,0]},{command:"L",values:[D,D]},{command:"Z",values:[]}]},fill:m(t,0),stroke:z(t)});break;case "triangle":ea.push({shape:{type:"path",path:[{command:"M",values:[0,D]},{command:"L",values:[.5*D,0]},{command:"L",values:[D,D]},{command:"Z",values:[]}]},fill:m(t,0),stroke:z(t)});break;case "cross":ea.push({shape:{type:"path",path:[{command:"M",values:[.5*D,
0]},{command:"L",values:[.5*D,D]},{command:"M",values:[0,.5*D]},{command:"L",values:[D,.5*D]}]},stroke:B(t)});break;case "x":ea.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[D,D]},{command:"M",values:[D,0]},{command:"L",values:[0,D]}]},stroke:B(t)});break;case "kite":ea.push({shape:{type:"path",path:[{command:"M",values:[0,.5*D]},{command:"L",values:[.5*D,0]},{command:"L",values:[D,.5*D]},{command:"L",values:[.5*D,D]},{command:"Z",values:[]}]},fill:m(t,0),stroke:z(t)})}break;
case "object":switch(t.resource&&t.resource.primitive||x.defaultPrimitive){case "cone":var ja=m(t,0);t=m(t,-.6);t=ba(ja,t,S?da:D);D=k.getConeShapes(D,S);ea.push({shape:D[0],fill:t});ea.push({shape:D[1],fill:t});break;case "inverted-cone":S=m(t,0);t=m(t,-.6);t=ba(S,t,D);D=k.getInvertedConeShapes(D);ea.push({shape:D[0],fill:t});ea.push({shape:D[1],fill:S});break;case "cube":D=k.getCubeShapes(D,S);ea.push({shape:D[0],fill:m(t,0)});ea.push({shape:D[1],fill:m(t,-.3)});ea.push({shape:D[2],fill:m(t,-.5)});
break;case "cylinder":{ja=m(t,0);const ra=m(t,-.6);ja=ba(ja,ra,S?da:D);D=k.getCylinderShapes(D,S);ea.push({shape:D[0],fill:ja});ea.push({shape:D[1],fill:ja});ea.push({shape:D[2],fill:m(t,0)});break}case "diamond":D=k.getDiamondShapes(D);ea.push({shape:D[0],fill:m(t,-.3)});ea.push({shape:D[1],fill:m(t,0)});ea.push({shape:D[2],fill:m(t,-.3)});ea.push({shape:D[3],fill:m(t,-.7)});break;case "sphere":S=m(t,0);t=m(t,-.6);t=ba(S,t);t.x1=0;t.y1=0;t.x2=.25*D;t.y2=.25*D;ea.push({shape:{type:"circle",cx:0,cy:0,
r:.5*D},fill:t});break;case "tetrahedron":D=k.getTetrahedronShapes(D),ea.push({shape:D[0],fill:m(t,-.3)}),ea.push({shape:D[1],fill:m(t,0)}),ea.push({shape:D[2],fill:m(t,-.6)})}}return ea}function r(t){return(t="number"===typeof(null==t?void 0:t.size)?null==t?void 0:t.size:null)?e.pt2px(t):null}function n(t,D){const S=r(D),ea=D&&D.maxSize?e.pt2px(D.maxSize):null,ja=D&&D.disableUpsampling,ra=t.symbolLayers,qa=[];let la=0,na=0;const aa=ra.getItemAt(ra.length-1);let ta;aa&&"icon"===aa.type&&(ta=aa.size&&
e.pt2px(aa.size));ra.forEach(oa=>{if("icon"===oa.type||"object"===oa.type){var wa="icon"===oa.type?oa.size&&e.pt2px(oa.size):0,xa=S||wa?Math.ceil(Math.min(S||wa,ea||p)):c;if(oa&&oa.resource&&oa.resource.href){var za=l(t,oa).then(function(ya){const Ea=oa.get("material.color");var Fa="icon"===oa.type?"multiply":"tint";return w.tintImageWithColor(ya,xa,Ea,Fa,ja)}).then(function(ya){const Ea=ya.width,Fa=ya.height;la=Math.max(la,Ea);na=Math.max(na,Fa);return[{shape:{type:"image",x:0,y:0,width:Ea,height:Fa,
src:ya.url},fill:null,stroke:null}]});qa.push(za)}else{let ya=xa;"icon"===oa.type&&ta&&S&&(ya=wa/ta*xa);wa="tall"===(null==D?void 0:D.symbolConfig)||(null==D?void 0:null==(za=D.symbolConfig)?void 0:za.isTall)||("object"===oa.type?y(oa):!1);la=Math.max(la,wa?da:ya);na=Math.max(na,ya);qa.push(Promise.resolve(P(oa,ya,wa)))}}});return Z.eachAlways(qa).then(function(oa){const wa=[];oa.forEach(function(xa){xa.value?wa.push(xa.value):xa.error&&Y.warn("error while building swatchInfo!",xa.error)});return w.renderSymbol(wa,
[la,na],{node:D&&D.node,scale:!1,opacity:D&&D.opacity})})}function L(t,D){const S=t.symbolLayers,ea=[];t=g.isVolumetricSymbol(t);const ja=r(D),ra=(D&&D.maxSize?e.pt2px(D.maxSize):null)||v;let qa=0,la=0,na;S.forEach((aa,ta)=>{if(aa&&("line"===aa.type||"path"===aa.type)){var oa=[];switch(aa.type){case "line":var wa=fa(aa,0);if(J.isNone(wa))break;var xa=wa&&wa.width||0;0===ta&&(na=xa);aa=Math.min(ja||xa,ra);ta=0===ta?aa:ja?xa/na*aa:aa;xa=ta>G/2?2*ta:G;la=Math.max(la,ta);qa=Math.max(qa,xa);wa.width=ta;
oa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*la]},{command:"L",values:[qa,.5*la]}]},stroke:wa});break;case "path":wa=Math.min(ja||c,ra);ta=m(aa,0);xa=m(aa,-.2);var za=R(aa,-.4);za=za?{color:za,width:1}:{};if("quad"===aa.profile){const ya=aa.width;aa=aa.height;aa=k.getPathSymbolShapes(ya&&aa?ya/aa:1,0===aa,0===ya);za={...za,join:"bevel"};oa.push({shape:aa[0],fill:xa,stroke:za});oa.push({shape:aa[1],fill:xa,stroke:za});oa.push({shape:aa[2],fill:ta,stroke:za})}else oa.push({shape:k.shapes.pathSymbol3DLayer[0],
fill:xa,stroke:za}),oa.push({shape:k.shapes.pathSymbol3DLayer[1],fill:ta,stroke:za});qa=la=Math.max(la,wa)}ea.push(oa)}});return Promise.resolve(w.renderSymbol(ea,[qa,la],{node:D&&D.node,scale:t,opacity:D&&D.opacity}))}function Q(t,D){return V.apply(this,arguments)}function V(){V=H._asyncToGenerator(function*(t,D){const S="mesh-3d"===t.type;t=t.symbolLayers;var ea=r(D);const ja=D&&D.maxSize?e.pt2px(D.maxSize):null;ea=ea||c;const ra=[];let qa=0,la=0;var na=!1;for(let za=0;za<t.length;za++){var aa=
t.getItemAt(za);const ya=[];if(!S||"fill"===aa.type){var ta=k.shapes.fill[0];switch(aa.type){case "fill":var oa=z(aa);na=Math.min(ea,ja||p);qa=Math.max(qa,na);la=Math.max(la,na);na=!0;var wa=m(aa,0),xa="pattern"in aa&&aa.pattern;aa=d(aa);!S&&J.isSome(xa)&&"style"===xa.type&&"solid"!==xa.style&&aa&&(wa=yield M(xa,aa));ya.push({shape:ta,fill:wa,stroke:oa});break;case "line":aa=fa(aa,0);if(J.isNone(aa))break;aa={stroke:aa,shape:ta};qa=Math.max(qa,c);la=Math.max(la,c);ya.push(aa);break;case "extrude":ta=
{join:"round",width:1,...fa(aa,-.4)};oa=m(aa,0);aa=m(aa,-.2);wa=Math.min(ea,ja||p);xa=k.getExtrudeSymbolShapes(wa);ta.width=1;ya.push({shape:xa[0],fill:aa,stroke:ta});ya.push({shape:xa[1],fill:aa,stroke:ta});ya.push({shape:xa[2],fill:oa,stroke:ta});aa=.7*c+.5*wa;qa=Math.max(qa,c);la=Math.max(la,aa);break;case "water":na=d(aa),aa=A(na),ta=A(na,2),oa=A(na,3),wa=k.getWaterSymbolShapes(),na=!0,ya.push({shape:wa[0],fill:aa}),ya.push({shape:wa[1],fill:ta}),ya.push({shape:wa[2],fill:oa}),aa=Math.min(ea,
ja||p),qa=Math.max(qa,aa),la=Math.max(la,aa)}ra.push(ya)}}return Promise.resolve(w.renderSymbol(ra,[qa,la],{node:D&&D.node,scale:na,opacity:D&&D.opacity}))});return V.apply(this,arguments)}const c=k.SymbolSizeDefaults.size,p=k.SymbolSizeDefaults.maxSize,v=k.SymbolSizeDefaults.maxOutlineSize,G=k.SymbolSizeDefaults.lineWidth,da=k.SymbolSizeDefaults.tallSymbolWidth,Y=N.getLogger("esri.symbols.support.previewSymbol3D");F.getPatternDescriptor=M;F.getSizeFromOptions=r;F.getSymbolLayerFill=m;F.previewSymbol3D=
function(t,D){if(0===t.symbolLayers.length)return Promise.reject(new X("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case "point-3d":return n(t,D);case "line-3d":return L(t,D);case "polygon-3d":case "mesh-3d":return Q(t,D)}return Promise.reject(new X("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q){function u(k,w,g,h,z){var l=k.data;const A={portal:g&&g.portal||X.getDefault(),url:O.urlToObject(k.baseUrl),origin:"portal-item"};l=l.items.find(B=>B.name===w);if(!l)return Promise.reject(new T("symbolstyleutils:symbol-name-not-found",`The symbol name '${w}' could not be found`,{symbolName:w}));let d=N.fromJSON(e.symbolUrlFromStyleItem(l,h),A),m=l.thumbnail&&l.thumbnail.href;const M=l.thumbnail&&l.thumbnail.imageData;I.isDevEnvironment()&&(d=I.adjustStaticAGOUrl(d),
m=I.adjustStaticAGOUrl(m));const U={portal:g.portal,url:O.urlToObject(O.removeFile(d)),origin:"portal-item"};return e.requestJSON(d,z).then(B=>{B="cimRef"===h?e.makeCIMSymbolRef(B.data):B.data;if((B=J.fromJSON(B,U))&&H.isSymbol3D(B)){if(m){const R=N.fromJSON(m,A);B.thumbnail=new q.Thumbnail({url:R})}else M&&(B.thumbnail=new q.Thumbnail({url:`data:image/png;base64,${M}`}));k.styleUrl?B.styleOrigin=new Z({portal:g.portal,styleUrl:k.styleUrl,name:w}):k.styleName&&(B.styleOrigin=new Z({portal:g.portal,
styleName:k.styleName,name:w}))}return B})}function x(k,w,g){const h=e.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,k.name);return e.requestJSON(h,g).then(z=>{z=e.makeCIMSymbolRef(z.data);return J.fromJSON(z,{portal:w.portal,url:O.urlToObject(O.removeFile(h)),origin:"portal-item"})})}F.fetchSymbolFromStyle=u;F.resolveWebStyleSymbol=function(k,w,g,h){return k.name?k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName?x(k,w,h):e.fetchStyle(k,w,h).then(z=>u(z,k.name,w,g,h)):Promise.reject(new T("symbolstyleutils:style-symbol-reference-name-missing",
"Missing name in style symbol reference"))};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetThemeUtils".split(" "),function(F,H,I,T,O,X,N,J,Z,e){function q(r,n){const L=r.length-1;return r.map((Q,V)=>Z.createStopLabel(Q,
V,L,n))}function u(){u=I._asyncToGenerator(function*(r,n,L,Q,V,c){var p,v,G=n.legendOptions;G=G&&G.customValues;const da=yield w(r,L);var Y=null!=n.minSize&&null!=n.maxSize;L=n.stops&&1<n.stops.length;var t=!!n.target;if(da&&(G||Y||L&&!t)){var D=J.isVolumetricSymbol(da),S=null,ea=Y=null;Y=D&&!L?X.round([n.minDataValue,n.maxDataValue]):G||(yield A(n,da,Q,V));G=null==r?void 0:r.authoringInfo;var ja=(t="univariate-color-size"===(null==G?void 0:G.type))&&"above-and-below"===(null==G?void 0:G.univariateTheme);
!Y&&L&&(Y=n.stops.map(na=>na.value),S=n.stops.some(na=>!!na.label),"flow"===r.type&&(Y=X.round(Y)),S&&(ea=n.stops.map(na=>na.label)));D&&2<(null==(p=Y)?void 0:p.length)&&!ja&&(Y=[Y[0],Y[Y.length-1]]);if(!Y)return null;t&&5!==(null==(v=Y)?void 0:v.length)&&(Y=m({minSize:Y[0],maxSize:Y[Y.length-1]}));var ra=D?x(r,Y):null,qa=J.getSymbolOutlineSize(da),la=S?null:q(Y,c);return(yield Promise.all(Y.map(function(){var na=I._asyncToGenerator(function*(aa,ta){const oa=D?ra[ta]:yield B(n,da,aa,Q,V),wa=fa(ja&&
"class-breaks"===r.type?k(r,ta):da,oa);return{value:aa,symbol:wa,label:S?ea[ta]:la[ta],size:oa,outlineSize:qa}});return function(aa,ta){return na.apply(this,arguments)}}()))).reverse()}});return u.apply(this,arguments)}function x(r,n){r=null==r?void 0:r.authoringInfo;const L="univariate-color-size"===(null==r?void 0:r.type);let Q=[12,30];if(L){const V=n[0],c=n[n.length-1];Q=n.map(p=>12+(p-V)/(c-V)*18)}L&&"below"===(null==r?void 0:r.univariateTheme)&&Q.reverse();return Q}function k(r,n){const L=r.classBreakInfos,
Q=L.length;n=2>Q||!(2<=n)?L[0].symbol.clone():L[Q-1].symbol.clone();r.visualVariables.some(V=>"color"===V.type)&&(-1<n.type.indexOf("3d")?z(n):l(n));return n}function w(r,n){return g.apply(this,arguments)}function g(){g=I._asyncToGenerator(function*(r,n){if("flow"===r.type)return Z.getSymbolForFlowRenderer(r,n);let L=null,Q=null;"simple"===r.type?L=r.symbol:"class-breaks"===r.type?(L=(r=r.classBreakInfos)&&r[0]&&r[0].symbol,Q=1<r.length):"unique-value"===r.type&&(L=(r=r.uniqueValueInfos)&&r[0]&&r[0].symbol,
Q=1<r.length);if(!L||h(L))return null;L=L.clone();if(n||Q)-1<L.type.indexOf("3d")?z(L):l(L);return L});return g.apply(this,arguments)}function h(r){return r?O.isSymbol3D(r)?r.symbolLayers?r.symbolLayers.some(n=>n&&"fill"===n.type):!1:-1!==r.type.indexOf("fill"):!1}function z(r){"line-3d"===r.type?r.symbolLayers.forEach(n=>{n.material={color:P}}):r.symbolLayers.forEach(n=>{"icon"!==n.type||n.resource&&n.resource.href?n.material={color:y}:(n.material={color:ba},n.outline={color:P,size:1.5})})}function l(r){const n=
e.isDarkTheme();if("cim"===r.type)N.applyCIMSymbolColor(r,new T(y));else if(-1!==r.type.indexOf("line"))r.color=P;else if(r.color=n?P:ba,"simple-marker"===r.type)if(r.outline){var L,Q;"#ffffff"===(null==(L=r.outline)?void 0:null==(Q=L.color)?void 0:Q.toHex())&&(r.outline.color=P)}else r.outline={color:P,width:1.5}}function A(r,n,L,Q){return d.apply(this,arguments)}function d(){d=I._asyncToGenerator(function*(r,n,L,Q){const V=(yield new Promise((v,G)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],
v,G))).getSizeRangeAtScale(r,L,Q),c=V&&m(V);if(V||c){var p=c.map(v=>{{const G=V.minSize,da=V.maxSize,Y=r.minDataValue,t=r.maxDataValue;let D=null;v=D=v<=G?Y:v>=da?t:(v-G)/(da-G)*(t-Y)+Y}return v});p=X.round(p);for(let v=1;v<p.length-1;v++){const G=yield M(r,n,p[v],p[v-1],L,Q);G&&(p[v]=G[0],c[v]=G[1])}return p}});return d.apply(this,arguments)}function m(r){const n=r.minSize;r=(r.maxSize-n)/4;const L=[];for(let Q=0;5>Q;Q++)L.push(n+r*Q);return L}function M(r,n,L,Q,V,c){return U.apply(this,arguments)}
function U(){U=I._asyncToGenerator(function*(r,n,L,Q,V,c){const p=yield B(r,n,L,V,c);Q=yield B(r,n,Q,V,c);var v=X.numDigits(L),G=v.fractional,da=v.integer;let Y=v=null;0<L&&1>L&&(v=10**G,L*=v,da=X.numDigits(L).integer);for(G=da-1;0<=G;G--){var t=10**G;da=Math.floor(L/t)*t;t*=Math.ceil(L/t);null!=v&&(da/=v,t/=v);let D=(da+t)/2;[,D]=X.round([da,D,t],{indexes:[1]});const S=yield B(r,n,da,V,c),ea=yield B(r,n,t,V,c),ja=yield B(r,n,D,V,c),ra=X.percentChange(p,S,Q,null),qa=X.percentChange(p,ea,Q,null),la=
X.percentChange(p,ja,Q,null);let na=20>=ra.previous,aa=20>=qa.previous;na&&aa&&(ra.previous<=qa.previous?(na=!0,aa=!1):(aa=!0,na=!1));na?Y=[da,S]:aa?Y=[t,ea]:20>=la.previous&&(Y=[D,ja]);if(Y)break}return Y});return U.apply(this,arguments)}function B(r,n,L,Q,V){return R.apply(this,arguments)}function R(){R=I._asyncToGenerator(function*(r,n,L,Q,V){const {getSize:c}=yield new Promise((p,v)=>F(["../../../renderers/visualVariables/support/visualVariableUtils"],p,v));return c(r,L,{scale:Q,view:V,shape:"simple-marker"===
n.type?n.style:null})});return R.apply(this,arguments)}function fa(r,n){r=r.clone();if(O.isSymbol3D(r))J.isVolumetricSymbol(r)||r.symbolLayers.forEach(L=>{"fill"!==L.type&&(L.size=n)});else if("esri.symbols.SimpleMarkerSymbol"===r.declaredClass)r.size=n;else if("esri.symbols.PictureMarkerSymbol"===r.declaredClass){const L=r.width,Q=r.height;r.height=n;r.width=L/Q*n}else"esri.symbols.SimpleLineSymbol"===r.declaredClass?r.width=n:"esri.symbols.TextSymbol"===r.declaredClass&&r.font&&(r.font.size=n);
return r}const ba=[255,255,255],y=[200,200,200],P=[128,128,128];H.REAL_WORLD_MAX_SIZE=30;H.REAL_WORLD_MIN_SIZE=12;H.getRampStops=function(r,n,L,Q,V,c){return u.apply(this,arguments)};Object.defineProperty(H,"__esModule",{value:!0})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(F,H,I,T,O,X,N){F.formatDateLabel=
function(J){return T.formatDate(new Date(J),X.timelineDateFormatOptions)};F.formatNumberLabel=function(J){const Z=Math.floor(Math.log10(Math.abs(J)))+1;return O.formatNumber(J,{notation:1E6<=Math.abs(J)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>Z||6<Z?4:Z})};F.getDeviationValues=function(J,Z,e){if(!I.isSome(Z)||!I.isSome(J))return[];const q=[];for(let u=-1*e;u<=e;u++)0!==u&&q.push(Z+u*J);return q};F.getDynamicPathForSizeStops=function(J){const {max:Z,min:e,padding:q,
pathHeight:u,pathWidth:x,stops:k}=J,w=Z-e;let g=`M0 0 L${x} 0 `,h;J=3===k.length?[k[0],k[1],k[2]]:[k[0],k[2],k[4]];const z=Math.min.apply(Math,J.map(A=>A.size)),l=Math.max(Math.abs(J[0].size-J[1].size),Math.abs(J[2].size-J[1].size));J.reverse();J.forEach(({size:A,value:d},m)=>{d=Math.round(u-(d-e)/w*u);h=Math.round((A-z)/l*100)/100*x;0===h&&(h=q*x);0===m&&(g+=`L${h} 0 `);g+=`L${h} ${d} `});return g+=`L${h} ${u} L0 ${u} L0 0 Z`};F.getFillFromColor=function(J){return J instanceof H?J.toCss(!0):H.fromString(J).toCss(!0)};
F.getPathForSizeStops=function(J){const {bottomValue:Z,bottomWidth:e,max:q,min:u,pathHeight:x,pathWidth:k,topValue:w,topWidth:g}=J;J=g*k;const h=e*k,z=q-u;return`M${J} 0 L${J} ${Math.round(x-(w-u)/z*x)} L${h} ${Math.round(x-(Z-u)/z*x)} L${h} ${x} L0 ${x} L0 0 Z`};F.getSizesFromVariable=function(J){let Z=J.maxSize;J=J.minSize;Z instanceof N&&(Z=Z.stops[0].size);J instanceof N&&(J=J.stops[0].size);return[Z,J]};F.getStopChanges=function(J,Z,e){const q=e.length-1,u=e[0],x=e[q]-u,k=Z-J,w=[];for(let g=
1;g<q;g++)w.push({index:g,value:(e[g]-u)/x*k+J});w.unshift({index:0,value:J});w.push({index:q,value:Z});return w};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),function(F,H,I,T,O,X){function N(k,w,g){let h="";0===w?h=q.lt+" ":w===g&&(h=q.gt+" ");return h+k}function J(k){let w=k.minValue,g=k.maxValue;const h=k.isFirstBreak?
"":q.gt+" ";k="percent-of-total"===k.normalizationType?q.pct:"";w=null==w?"":O.format(w);g=null==g?"":O.format(g);return h+w+k+" "+q.ld+" "+g+k}function Z(k,w){return"normalizationField"in k&&k.normalizationField?{type:"normalized-field",field:k.field,normalizationField:k.normalizationField}:"field"in k&&k.field?{type:"field",field:k.field}:"valueExpression"in k&&k.valueExpression?{type:"expression",expression:k.valueExpression,title:k.valueExpressionTitle,returnType:w}:null}const e=I.getLogger("esri.renderers.support.utils"),
q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},u={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},x={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};I=T.convertDateFormatToIntlOptions("short-date");F.calculateDateFormatInterval=function(k){k=k.map(l=>new Date(l));const w=k.length;
let g=Infinity,h=null;for(let l=0;l<w-1;l++){const A=k[l];let d=Infinity,m=null;for(let M=l+1;M<w;M++){var z=k[M];z=A.getFullYear()!==z.getFullYear()&&"year"||A.getMonth()!==z.getMonth()&&"month"||A.getDate()!==z.getDate()&&"day"||A.getHours()!==z.getHours()&&"hour"||A.getMinutes()!==z.getMinutes()&&"minute"||A.getSeconds()!==z.getSeconds()&&"second"||"millisecond";const U=u[z];U<d&&(d=U,m=z)}d<g&&(g=d,h=m)}return h};F.createClassBreakLabel=J;F.createColorStops=function(k){const {values:w,colors:g,
labelIndexes:h,isDate:z,dateFormatOptions:l}=k;return w.map((A,d)=>{let m=null;if(!h||-1<h.indexOf(d)){let M;(M=z?T.formatDate(A,l):O.format(A))&&(m=N(M,d,w.length-1))}return new X({value:A,color:g[d],label:m})})};F.createUniqueValueLabel=function(k){const {value:w,domain:g,fieldInfo:h,dateFormatInterval:z}=k;k=String(w);const l=g&&"codedValues"in g&&g.codedValues?g.getName(w):null;l?k=l:"number"===typeof w&&(k=h&&"date"===h.type?T.formatDate(w,z&&T.convertDateFormatToIntlOptions(x[z])):O.format(w));
return k};F.getAttribute=Z;F.getAttributes=function(k,w){const g=[];if("class-breaks"===k.type||"heatmap"===k.type)g.push(Z(k,"number"));else if("unique-value"===k.type){var h=k.authoringInfo;if(h&&"relationship"===h.type){if(h.field1&&h.field2){var z=h.field2.field;const l=h.field2.normalizationField;g.push(Z({field:h.field1.field,normalizationField:h.field1.normalizationField}));g.push(Z({field:z,normalizationField:l}))}}else z=k.uniqueValueInfos[0],h=null,z&&z.value&&(z=typeof k.uniqueValueInfos[0].value,
"string"===z||"number"===z)&&(h=z),g.push(Z(k,h)),[k.field2,k.field3].forEach(l=>l&&g.push({type:"field",field:l}))}else"dot-density"===k.type&&k.attributes.forEach(l=>g.push(Z(l,"number")));(k=w?w(k):"visualVariables"in k?k.visualVariables:null)&&k.forEach(l=>g.push(Z(l,"number")));return H.unique(g.filter(Boolean),(l,A)=>"field"===l.type&&"field"===A.type?l.field===A.field:"normalized-field"===l.type&&"normalized-field"===A.type?l.field===A.field&&l.normalizationField===A.normalizationField:"expression"===
l.type&&"expression"===A.type?l.expression===A.expression:!1)};F.setLabelsForClassBreaks=function(k){const w=k.classBreakInfos,g=k.normalizationType;let h=[];if(w&&w.length)if("standard-deviation"===k.classificationMethod)e.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(k.round){h.push(w[0].minValue);for(const z of w)h.push(z.maxValue);h=O.round(h);w.forEach((z,l)=>{z.label=J({minValue:0===l?h[0]:h[l],maxValue:h[l+1],isFirstBreak:0===
l,normalizationType:g})})}else w.forEach((z,l)=>{z.label=J({minValue:z.minValue,maxValue:z.maxValue,isFirstBreak:0===l,normalizationType:g})})};F.timelineDateFormatOptions=I;F.updateClassBreak=function(k){if("standard-deviation"===k.classificationMethod)e.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var w=k.classBreaks,g=k.change,h=g.index;g=g.value;var z=w.length,l=-1,A=-1;0===h?l=h:h===z?A=h-1:(A=h-1,l=h);k=k.normalizationType;
h=null;-1<l&&l<z&&(h=w[l],h.minValue=g,h.label=J({minValue:h.minValue,maxValue:h.maxValue,isFirstBreak:0===l,normalizationType:k}));-1<A&&A<z&&(h=w[A],h.maxValue=g,h.label=J({minValue:h.minValue,maxValue:h.maxValue,isFirstBreak:0===A,normalizationType:k}))}};F.updateColorStops=function(k){const {stops:w,changes:g,isDate:h,dateFormatOptions:z}=k,l=w.map(d=>d.value);k=[];for(const d of g)k.push(d.index),l[d.index]=d.value;const A=O.round(l,{indexes:k});w.forEach((d,m)=>{d.value=l[m];if(null!=d.label){let M,
U=null;(M=h?T.formatDate(A[m],z):O.format(A[m]))&&(U=N(M,m,w.length-1));d.label=U}})};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../../core/Logger ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k,w,g,h,z,l,A,d,m,M){var U;(function(R){R.Auto="auto";R.Stack="stack";R.SideBySide="side-by-side"})(U||(U={}));const B=window.devicePixelRatio;I=function(R){function fa(y,P){y=R.call(this,y,P)||this;y._handles=new T;y._hasIndicators=!1;y._selectedSectionName=null;y._sectionNames=[];y._sectionMap=new Map;y.activeLayerInfos=null;y.headingLevel=3;y.layout=U.Stack;y.messages=null;y.messagesCommon=null;y.type="card";y.view=null;return y}F._inheritsLoose(fa,R);var ba=
fa.prototype;ba.initialize=function(){this.own([this.watch("activeLayerInfos",y=>{this._handles.removeAll();this._watchForSectionChanges(y)})])};ba.destroy=function(){this._handles.destroy();this._handles=null};ba.render=function(){this._hasIndicators=this.layout===U.Auto&&768>=this.view.container.clientWidth||this.layout===U.Stack;var y=this.activeLayerInfos;y=y&&y.toArray().map(n=>this._renderLegendForLayer(n)).filter(n=>!!n);this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||
(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const P=this._sectionNames.length;var r=this._sectionNames.map((n,L)=>{L=M.substitute(this.messagesCommon.pagination.pageText,{index:L+1,total:P});return d.tsx("div",{key:n,role:"tab",id:n,"aria-label":L,"aria-controls":`${n}-panel`,"aria-selected":(this._selectedSectionName===n).toString(),tabIndex:this._selectedSectionName===n?0:-1,title:L,onclick:this._selectSection,onkeydown:this._focusSection,
bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===n}),"data-section-name":n})});r=this._hasIndicators&&1<P?d.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},r):null;y=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):y&&y.length?y:null;return d.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},
y?y:d.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),r)};ba._selectSection=function(y){if(y=y.target.getAttribute("data-section-name"))this._selectedSectionName=y};ba._focusSection=function(y){switch(y.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(y);break;case "Enter":case " ":this._selectSection(y)}};ba._switchSectionOnArrowPress=function(y){const P=y.key,r="ArrowLeft"===P?-1:1;y=y.target.getAttribute("data-section-name");y=this._sectionNames.indexOf(y);
const n=this._sectionNames;let L=null;-1!==y&&(n[y+r]?L=document.getElementById(n[y+r]):"ArrowLeft"===P?L=document.getElementById(n[n.length-1]):"ArrowRight"===P&&(L=document.getElementById(n[0])),L&&L.focus())};ba._watchForSectionChanges=function(y){this._generateSectionNames();y&&(y.forEach(P=>{const r=`activeLayerInfo-${P.layer.uid}-version-change`;this._handles.remove(r);this._watchForSectionChanges(P.children);this._handles.add(P.watch("version",()=>this._generateSectionNames()),r)}),this._handles.remove("activeLayerInfos-collection-change"),
this._handles.add(y.on("change",()=>this._watchForSectionChanges(y)),"activeLayerInfos-collection-change"))};ba._generateSectionNames=function(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};ba._getSectionName=function(y,P,r){return`${this.id}${y.uid}-type-${P.type}-${r}`};ba._generateSectionNamesForActiveLayerInfo=function(y){y.children.forEach(this._generateSectionNamesForActiveLayerInfo,
this);y.legendElements&&y.legendElements.forEach((P,r)=>{this._sectionNames.push(this._getSectionName(y.layer,P,r))})};ba._renderLegendForLayer=function(y){if(!y.ready)return null;if(y.children.length){var P=y.children.map(r=>this._renderLegendForLayer(r)).toArray();return d.tsx("div",{key:y.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},d.tsx("div",{class:"esri-legend--card__service-caption-container"},y.title),P)}{if((P=y.legendElements)&&!P.length)return null;
const r=P.some(n=>"relationship-ramp"===n.type);P=P.map((n,L)=>this._renderLegendForElement(n,y,L,r)).filter(n=>!!n);return P.length?d.tsx("div",{key:y.layer.uid,class:this.classes("esri-legend--card__service",{["esri-legend--card__group-layer-child"]:!!y.parent})},d.tsx("div",{class:"esri-legend--card__service-caption-container"},d.tsx("div",{class:"esri-legend--card__service-caption-text"},y.title)),d.tsx("div",{class:"esri-legend--card__service-content"},P)):null}};ba._renderLegendForElement=function(y,
P,r,n=!1){var L="color-ramp"===y.type,Q="opacity-ramp"===y.type,V="size-ramp"===y.type;const c=P.layer;var p=null;"string"===typeof y.title?p=y.title:y.title&&(p=y.title,L=g.getTitle(this.messages,p,L||Q),p=p.title?`${p.title} (${L})`:L);r=this._getSectionName(c,y,r);L=this._hasIndicators?d.tsx("div",null,d.tsx(h.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},P.title),d.tsx(h.Heading,{level:h.incrementHeadingLevel(this.headingLevel),class:"esri-legend--card__layer-caption"},
p)):p?d.tsx(h.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},p):null;p=P.effectList;Q=null;"symbol-table"===y.type?(V=y.infos.map((v,G)=>this._renderLegendForElementInfo(v,P,y.legendType,G)).filter(v=>!!v),V.length&&(Q=d.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(V[0].properties.classes&&V[0].properties.classes["esri-legend--card__symbol-row"])&&!n,["esri-legend--card__relationship-label-container"]:n})},V))):"color-ramp"===y.type||"opacity-ramp"===
y.type||"heatmap-ramp"===y.type?Q=this._renderLegendForRamp(y,c.opacity,p):V?Q=this._renderSizeRamp(y,c.opacity):"relationship-ramp"===y.type?Q=k.renderRelationshipRamp(y,this.id,c.opacity,p):"univariate-above-and-below-ramp"===y.type?Q=this._renderUnivariateAboveAndBelowRamp(y,c.opacity,p):"univariate-color-size-ramp"===y.type&&(Q=this._renderUnivariateColorSizeRamp(y,c.opacity,p));if(!Q)return null;n=d.tsx("div",{key:r,class:"esri-legend--card__section",id:`${r}-panel`,role:"tabpanel","aria-labelledby":r,
tabIndex:0},[L,Q]);this._sectionMap.set(r,n);return n};ba._renderUnivariateAboveAndBelowRamp=function(y,P,r){const {sizeRampElement:n,colorRampElement:L}=w.getUnivariateAboveAndBelowRampElements(y,P,"horizontal");if(!n)return null;y=w.getUnivariateSizeRampSize(n,"full",!0,"horizontal");var Q=w.getUnivariateColorRampSize(n,"above",!0,"horizontal"),V=w.getUnivariateColorRampSize(n,"below",!0,"horizontal");Q=w.getUnivariateColorRampPreview(L,{width:Q,height:12,rampAlignment:"horizontal",opacity:P,type:"above",
effectList:r});P=w.getUnivariateColorRampPreview(L,{width:V,height:12,rampAlignment:"horizontal",opacity:P,type:"below",effectList:r});r=w.getUnivariateColorRampMargin(n,"card");V=n.infos.map(v=>v.label);const c=V.length-1;V=V.map((v,G)=>0===G||G===c?d.tsx("div",{key:G},v):null);const p={marginTop:"3px",display:"flex"};m.isRTL(this.container)?p.marginRight=`${r}px`:p.marginLeft=`${r}px`;y={width:`${y}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return d.tsx("div",{class:"esri-legend--card__layer-row",
key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},d.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},n.infos.map((v,G)=>d.tsx("div",{key:G,class:"esri-legend--card__symbol",bind:v.preview,afterCreate:g.attachToNode}))),Q?d.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:p,key:"color-ramp-preview"},d.tsx("div",{bind:Q,afterCreate:g.attachToNode}),d.tsx("div",
{bind:P,afterCreate:g.attachToNode})):null,d.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},d.tsx("div",{class:"esri-legend__ramp-labels",styles:y},V)))};ba._renderUnivariateColorSizeRamp=function(y,P,r){const {sizeRampElement:n,colorRampElement:L}=w.getUnivariateColorSizeRampElements(y,"horizontal");if(!n)return null;y=w.getUnivariateSizeRampSize(n,"full",!1,"horizontal");var Q=w.getUnivariateColorRampSize(n,"full",!1,"horizontal");P=w.getUnivariateColorRampPreview(L,{width:Q,
height:12,rampAlignment:"horizontal",opacity:P,type:"full",effectList:r});const V=w.getUnivariateColorRampMargin(n,"card"),c=n.infos.length-1;r=n.infos.map((p,v)=>0===v||v===c?d.tsx("div",{key:v},p.label):null);Q={marginTop:"3px",display:"flex"};m.isRTL(this.container)?Q.marginRight=`${V}px`:Q.marginLeft=`${V}px`;y={width:`${y}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return d.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",
flexDirection:"column"}},d.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},n.infos.map((p,v)=>d.tsx("div",{key:v,class:"esri-legend--card__symbol",bind:p.preview,afterCreate:g.attachToNode}))),d.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:Q,key:"color-ramp-preview"},d.tsx("div",{bind:P,afterCreate:g.attachToNode})),d.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},
d.tsx("div",{class:"esri-legend__ramp-labels",styles:y},r)))};ba._renderLegendForElementInfo=function(y,P,r,n){var L=P.layer;if(y.type)return this._renderLegendForElement(y,P,n);r=g.isImageryStretchedLegend(L,r);if(y.preview){var Q;if(!y.symbol||-1===y.symbol.type.indexOf("simple-fill")){if(!y.label)return d.tsx("div",{key:n,bind:y.preview,afterCreate:g.attachToNode});P={["esri-legend--card__symbol-cell"]:this._hasIndicators};return d.tsx("div",{key:n,class:this.classes("esri-legend--card__layer-row",
{["esri-legend--card__symbol-row"]:this._hasIndicators})},d.tsx("div",{class:this.classes(P),bind:y.preview,afterCreate:g.attachToNode}),d.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},g.getTitle(this.messages,y.label,!1)||""))}let c=r=255,p=255,v=0,G=255,da=255,Y=255,t=0;const D=y.symbol.color&&y.symbol.color.a,S=y.symbol.outline&&y.symbol.outline.color&&y.symbol.outline.color.a;D&&(r=y.symbol.color.r,c=y.symbol.color.g,p=
y.symbol.color.b,v=y.symbol.color.a*L.opacity);S&&(G=y.symbol.outline.color.r,da=y.symbol.outline.color.g,Y=y.symbol.outline.color.b,t=y.symbol.outline.color.a*L.opacity);var V=(L=null!=(V=null==(Q=y.symbol.color)?void 0:Q.isBright)?V:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";P={background:D?`rgba(${r}, ${c}, ${p}, ${v})`:"none",color:L?"black":"white",textShadow:`-1px -1px 0 ${V},\n                                              1px -1px 0 ${V},\n                                              -1px 1px 0 ${V},\n                                              1px 1px 0 ${V}`,
border:S?`1px solid rgba(${G}, ${da}, ${Y}, ${t})`:"none",filter:u.getCSSFilterFromEffectList(P.effectList)};return d.tsx("div",{key:n,class:"esri-legend--card__layer-row"},d.tsx("div",{class:"esri-legend--card__label-element",styles:P}," ",y.label," "))}if(y.src)return P=this._renderImage(y,L,r),d.tsx("div",{key:n,class:"esri-legend--card__layer-row"},P,d.tsx("div",{class:"esri-legend--card__image-label"},y.label||""))};ba._renderImage=function(y,P,r){const {label:n,src:L,opacity:Q}=y;r={["esri-legend--card__imagery-layer-image--stretched"]:r,
["esri-legend--card__symbol"]:!r};P={opacity:`${null!=Q?Q:P.opacity}`};return d.tsx("img",{alt:g.getTitle(this.messages,n,!1),src:L,border:0,width:y.width,height:y.height,class:this.classes(r),styles:P})};ba._renderSizeRampLines=function(y){y=y.infos;var P=y[0],r=y[y.length-1],n=P.symbol;y=this._hasIndicators;P=O.pt2px(P.size+P.outlineSize)*B;r=O.pt2px(r.size+r.outlineSize)*B;const L=y?P:P+50*B,Q=y?P/2+50*B:P;var V;n?-1<n.type.indexOf("3d")?(V=n.symbolLayers&&n.symbolLayers.length)?(V=n.symbolLayers.getItemAt(V-
1).get("resource.primitive"),V="triangle"===V||"cone"===V||"tetrahedron"===V):V=void 0:V="triangle"===n.style:V=void 0;if(n)if(-1<n.type.indexOf("3d")){var c=n.symbolLayers&&n.symbolLayers.length;c?(n=n.symbolLayers.getItemAt(c-1),n=n.resource&&n.resource.primitive,n="circle"===n||"cross"===n||"kite"===n||"sphere"===n||"cube"===n||"diamond"===n):n=void 0}else n=n.style,n="circle"===n||"diamond"===n||"cross"===n;else n=void 0;c=document.createElement("canvas");c.width=L;c.height=Q;c.style.width=`${c.width/
B}px`;c.style.height=`${c.height/B}px`;const p=c.getContext("2d");if(y){p.beginPath();var v=L/2-r/2;p.moveTo(0,0);p.lineTo(v,Q);v=L/2+r/2;p.moveTo(L,0);p.lineTo(v,Q)}else p.beginPath(),p.moveTo(0,Q/2-r/2),p.lineTo(L,0),p.moveTo(0,Q/2+r/2),p.lineTo(L,Q);p.strokeStyle="#ddd";p.stroke();return d.tsx("div",{bind:c,afterCreate:g.attachToNode,styles:y?{display:"flex",marginTop:`-${V?0:n?P/2:0}px`,marginBottom:`-${V?r:n?r/2:0}px`}:{display:"flex",marginRight:`-${V?0:n?P/2:0}px`,marginLeft:`-${V?0:n?r/2:
0}px`}})};ba._renderSizeRamp=function(y,P){var r=y.infos;const n=r[0].label,L=r[r.length-1].label;let Q=r[0].preview;r=r[r.length-1].preview;const V=this._hasIndicators,c={"flex-direction":V?"column":"row-reverse"};Q&&(Q=Q.cloneNode(!0),Q.style.display="flex");r&&(r=r.cloneNode(!0),r.style.display="flex");P={opacity:null!=P?`${P}`:""};return d.tsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:V})},d.tsx("div",{class:"esri-legend--card__ramp-label"},
V?n:L),d.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:c},d.tsx("div",{bind:Q,afterCreate:g.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:P}),this._renderSizeRampLines(y),d.tsx("div",{bind:r,afterCreate:g.attachToNode,class:"esri-legend--card__size-ramp-container",styles:P})),d.tsx("div",{class:"esri-legend--card__ramp-label"},V?L:n))};ba._renderLegendForRamp=function(y,P,r){var n=y.infos;const L="heatmap-ramp"===y.type,Q=n.length-1;var V=2<Q&&!L?25*Q:100,c=V+
20;const p=n.slice(0).reverse();p.forEach((da,Y)=>{da.offset=L?da.ratio:Y/Q});const v=p.length-1;y=(y=0!==p.length%2&&p[p.length/2|0])&&d.tsx("div",{class:"esri-legend--card__interval-separators-container"},d.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),d.tsx("div",{class:"esri-legend--card__ramp-label"},y.label));const G=n[n.length-1].label;n=n[0].label;V=q.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:p[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,
y:0,width:V,height:25},fill:{type:"linear",x1:10,y1:0,x2:V+10,y2:0,colors:p},stroke:{width:0}},{shape:{type:"path",path:`M${V+10} 0 L${c} ${12.5} L${V+10} ${25} Z`},fill:p[v].color,stroke:{width:0}}]],c,25);({messages:c}=this);P={filter:u.getCSSFilterFromEffectList(r),opacity:null==P?null:`${P}`};return d.tsx("div",{class:"esri-legend--card__layer-row",styles:{justifyContent:"center"}},d.tsx("div",{class:"esri-legend--card__ramp-label"},L?c[G]:G),d.tsx("div",{class:"esri-legend--card__symbol-container"},
d.tsx("div",{styles:P},V),y),d.tsx("div",{class:"esri-legend--card__ramp-label"},L?c[n]:n))};return fa}(x);H.__decorate([X.property()],I.prototype,"activeLayerInfos",void 0);H.__decorate([X.property()],I.prototype,"headingLevel",void 0);H.__decorate([X.property()],I.prototype,"layout",void 0);H.__decorate([X.property(),l.messageBundle("esri/widgets/Legend/t9n/Legend")],I.prototype,"messages",void 0);H.__decorate([X.property(),l.messageBundle("esri/t9n/common")],I.prototype,"messagesCommon",void 0);
H.__decorate([X.property({readOnly:!0})],I.prototype,"type",void 0);H.__decorate([X.property()],I.prototype,"view",void 0);H.__decorate([z.accessibleHandler()],I.prototype,"_selectSection",null);return I=H.__decorate([e.subclass("esri.widgets.Legend.styles.Card")],I)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define("exports ../../../../symbols/support/svgUtils ../../../../symbols/support/utils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),
function(F,H,I,T,O,X,N){function J(q,u,x){const k=`${x}_arrowStart`;x=`${x}_arrowEnd`;q="left"===q;const w={markerStart:null,markerEnd:null};switch(u){case "HL":q?w.markerStart=`url(#${x})`:w.markerEnd=`url(#${k})`;break;case "LL":w.markerStart=`url(#${x})`;break;case "LH":q?w.markerEnd=`url(#${k})`:w.markerStart=`url(#${x})`;break;default:w.markerEnd=`url(#${k})`}return w}function Z(q,u,x,k,w=60){const {focus:g,numClasses:h,colors:z,rotation:l}=q;q=!!g;const A=Math.sqrt(w**2+w**2)+(q?0:5),d=[],m=
[];var M=[],U=(w||75)/h;for(var B=0;B<h;B++){var R=B*U;for(var fa=0;fa<h;fa++){var ba=fa*U;const y=H.generateFillAttributes(z[B][fa]),P=H.generateStrokeAttributes(null);ba={type:"rect",x:ba,y:R,width:U,height:U};d.push(H.renderDef(y));m.push(H.renderShape(ba,y.fill,P,null));M.push(H.getBoundingBox(ba))}}U=null;q||(U="margin: -15px -15px -18px -15px");B=J("left",g,u);R=J("right",g,u);fa=H.computeBBox(M);M=H.getTransformMatrix(fa,A,A,0,!1,l,!1);fa=H.getTransformMatrix(fa,A,A,0,!1,q?-45:null,!1);x={filter:I.getCSSFilterFromEffectList(k),
opacity:null==x?null:`${x}`};return N.tsx("div",{styles:x,class:q?e.diamondMidColRamp:e.squareTableCell},N.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:A,height:A,style:U},N.tsx("defs",null,N.tsx("marker",{id:`${u}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},N.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),N.tsx("marker",{id:`${u}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",
markerUnits:"strokeWidth",orient:"auto"},N.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),d),N.tsx("g",{transform:M},m),N.tsx("g",{transform:fa},N.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":B.markerStart,"marker-end":B.markerEnd,x1:-10,y1:w-15,x2:-10,y2:15}),N.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":R.markerStart,"marker-end":R.markerEnd,x1:15,y1:w+10,x2:w-15,y2:w+10}))))}const e={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};F.renderRelationshipRamp=function(q,u,x,k){const {focus:w,labels:g}=q,h=!!w;q=Z(q,u,x,k);u={justifyContent:"center"};
x=T.isRTL();return h?N.tsx("div",{class:e.diamondContainer,styles:u},N.tsx("div",{class:e.diamondLeftCol},x?g.right:g.left),N.tsx("div",{class:e.diamondMidCol},N.tsx("div",{class:e.diamondMidColLabel},g.top),q,N.tsx("div",{class:e.diamondMidColLabel},g.bottom)),N.tsx("div",{class:e.diamondRightCol},x?g.left:g.right)):N.tsx("div",{class:e.squareTable},N.tsx("div",{class:e.squareTableRow},N.tsx("div",{class:T.classes(e.squareTableCell,e.squareTableLabel,e.squareTableLabelRightBottom)},x?g.top:g.left),
N.tsx("div",{class:e.squareTableCell}),N.tsx("div",{class:T.classes(e.squareTableCell,e.squareTableLabel,e.squareTableLabelLeftBottom)},x?g.left:g.top)),N.tsx("div",{class:e.squareTableRow},N.tsx("div",{class:e.squareTableCell}),q,N.tsx("div",{class:e.squareTableCell})),N.tsx("div",{class:e.squareTableRow},N.tsx("div",{class:T.classes(e.squareTableCell,e.squareTableLabel,e.squareTableLabelRightTop)},x?g.right:g.bottom),N.tsx("div",{class:e.squareTableCell}),N.tsx("div",{class:T.classes(e.squareTableCell,
e.squareTableLabel,e.squareTableLabelLeftTop)},x?g.bottom:g.right)))};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),function(F,H,I,T,O,X,N,J,Z){function e(g="vertical"){return"vertical"===
g?Z.tsx("svg",{height:"4",width:"10"},Z.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):Z.tsx("svg",{height:"10",width:"10"},Z.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function q(g,h="vertical"){const z=document.createElement("div");z.style.height="20px";z.className=w.univariateAboveAndBelowSymbol;null!=g&&(z.style.opacity=g.toString());k.append(z,e.bind(null,h));return z}function u(g,h,z="vertical",l){g.infos.forEach((A,
d)=>{if(l&&2===d)A.preview=q(h,z);else{d=H.pt2px(A.size)+("horizontal"===z?20:10);const m="div"===A.preview.tagName.toLowerCase(),M=m?A.preview:document.createElement("div");M.className=w.univariateAboveAndBelowSymbol;"horizontal"===z?M.style.width=`${d}px`:M.style.height=`${d}px`;m||M.appendChild(A.preview);A.preview=M}})}function x(g,h,z,l="vertical"){let A=0;g=g.infos;const d=Math.floor(g.length/2);var m="full"===h||"above"===h?0:d;for(h="full"===h||"below"===h?g.length-1:d;m<=h;m++)if(z&&m===
d)A+="horizontal"===l?10:20;else{const M=H.pt2px(g[m].size)+("horizontal"===l?20:10);A+=M}return Math.round(A)}const k=T.createProjector(),w={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};F.getUnivariateAboveAndBelowRampElements=function(g,h,z="vertical"){var l=g.infos;g=l.find(({type:m})=>"size-ramp"===m);l=l.find(({type:m})=>"color-ramp"===m);g&&(g={...g},g.infos=[...g.infos],u(g,h,z,!0));l&&(l={...l},l.infos=[...l.infos]);if("horizontal"===
z){var A,d;null==(A=g)?void 0:A.infos.reverse();null==(d=l)?void 0:d.infos.reverse()}return{sizeRampElement:g,colorRampElement:l}};F.getUnivariateColorRampMargin=function(g,h="classic"){g=g.infos;return"classic"===h?(H.pt2px(g[0].size)+10)/2:(H.pt2px(g[0].size)-H.pt2px(g[g.length-1].size))/2};F.getUnivariateColorRampPreview=function(g,h){if(!g)return null;g=g.infos.map(z=>z.color);g=O.renderColorRampPreviewHTML("full"===h.type?g:"above"===h.type?g.slice(0,3):g.slice(2,5),{width:h.width,height:h.height,
align:h.rampAlignment,effectList:h.effectList});g.className=w.colorRamp;null!=h.opacity&&(g.style.opacity=h.opacity.toString());return g};F.getUnivariateColorRampSize=function(g,h,z,l="vertical"){const A=x(g,h,z,l);g=g.infos;var d=Math.floor(g.length/2);const m="full"===h||"above"===h?0:d;d="full"===h||"below"===h?g.length-1:d;z=z?"vertical"===l?20:10:0;l="vertical"===l?10*("full"===h?2:1):20*("full"===h?2:1);return Math.round(A-(H.pt2px("full"===h?g[m].size+g[d].size:"above"===h?g[m].size:g[d].size)/
2+z/2+l/2))};F.getUnivariateColorSizeRampElements=function(g,h="vertical"){var z=g.infos;g=z.find(({type:d})=>"size-ramp"===d);z=z.find(({type:d})=>"color-ramp"===d);g&&(g={...g},g.infos=[...g.infos],u(g,null,h,!1));z&&(z={...z},z.infos=[...z.infos]);if("horizontal"===h){var l,A;null==(l=g)?void 0:l.infos.reverse();null==(A=z)?void 0:A.infos.reverse()}return{sizeRampElement:g,colorRampElement:z}};F.getUnivariateSizeRampSize=x;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports",
"../../../intl","../../../intl/substitute"],function(F,H,I){F.attachToNode=function(T){T.appendChild(this)};F.getTitle=function(T,O,X){if(O){if("string"===typeof O||"number"===typeof O)return O;if("value"in O||"unit"in O)return I.substitute(T.dotValue,O);if("colorName"in O||"bandName"in O)return T[O.colorName]+": "+(T[O.bandName]||O.bandName);if("showCount"in O)return O.showCount?T.clusterCountTitle:null;var N=null;X?N=O.ratioPercentTotal?"showRatioPercentTotal":O.ratioPercent?"showRatioPercent":
O.ratio?"showRatio":O.normField?"showNormField":O.field?"showField":null:X||(N=O.normField?"showNormField":O.normByPct?"showNormPct":O.field?"showField":null);return N?I.substitute("showField"===N?"{field}":T[N],{field:O.field,normField:O.normField}):null}};F.isImageryStretchedLegend=function(T,O){return!!(O&&"Stretched"===O&&10.3<=T.version&&"esri.layers.ImageryLayer"===T.declaredClass)};F.isRendererTitle=function(T,O){return!O};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../../core/Logger ../../support/jsxFactory ../../../intl/number".split(" "),
function(F,H,I,T,O,X,N,J,Z,e,q,u,x,k,w,g,h,z){const l={display:"flex",alignItems:"flex-start"},A={marginLeft:"3px"},d={display:"table-cell",verticalAlign:"middle"};I=function(m){function M(B,R){B=m.call(this,B,R)||this;B.activeLayerInfos=null;B.headingLevel=3;B.messages=null;B.type="classic";return B}F._inheritsLoose(M,m);var U=M.prototype;U.render=function(){var B=this.activeLayerInfos;B=B&&B.toArray().map(R=>this._renderLegendForLayer(R)).filter(R=>!!R);return h.tsx("div",null,B&&B.length?B:h.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};U._renderLegendForLayer=function(B){if(!B.ready)return null;var R=!!B.children.length;const fa=`${"esri-legend__"}${B.layer.uid}-version-${B.version}`,ba=B.title?x.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},B.title):null;if(R)return R=B.children.map(y=>this._renderLegendForLayer(y)).toArray(),h.tsx("div",{key:fa,class:this.classes("esri-legend__service","esri-legend__group-layer")},
ba,R);if((R=B.legendElements)&&!R.length)return null;R=R.map(y=>this._renderLegendForElement(y,B.layer,B.effectList)).filter(y=>!!y);return R.length?h.tsx("div",{key:fa,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!B.parent}),tabIndex:0},ba,h.tsx("div",{class:"esri-legend__layer"},R)):null};U._renderLegendForElement=function(B,R,fa,ba){var y="color-ramp"===B.type,P="opacity-ramp"===B.type;const r="size-ramp"===B.type;let n=null;if("symbol-table"===B.type||r){var L=
B.infos.map(V=>this._renderLegendForElementInfo(V,R,fa,r,B.legendType)).filter(V=>!!V);L.length&&(n=h.tsx("div",{class:"esri-legend__layer-body"},L))}else"color-ramp"===B.type||"opacity-ramp"===B.type||"heatmap-ramp"===B.type||"stretch-ramp"===B.type?n=this._renderLegendForRamp(B,R.opacity):"relationship-ramp"===B.type?n=e.renderRelationshipRamp(B,this.id,R.opacity,fa):"univariate-above-and-below-ramp"===B.type?n=this._renderUnivariateAboveAndBelowRamp(B,R.opacity,fa):"univariate-color-size-ramp"===
B.type&&(n=this._renderUnivariateColorSizeRamp(B,R.opacity,fa));if(!n)return null;L=B.title;var Q=null;"string"===typeof L?Q=L:L&&(Q=u.getTitle(this.messages,L,y||P),Q=u.isRendererTitle(L,y||P)&&L.title?`${L.title} (${Q})`:Q);y=ba?"esri-legend__layer-child-table":"esri-legend__layer-table";P=Q?h.tsx("div",{class:"esri-legend__layer-caption"},Q):null;return h.tsx("div",{class:this.classes(y,{["esri-legend__layer-table--size-ramp"]:r||!ba})},P,n)};U._renderUnivariateAboveAndBelowRamp=function(B,R,fa){const {sizeRampElement:ba,
colorRampElement:y}=q.getUnivariateAboveAndBelowRampElements(B,R);if(!ba)return null;var P=q.getUnivariateColorRampSize(ba,"above",!0);B=q.getUnivariateColorRampSize(ba,"below",!0);const r=q.getUnivariateColorRampPreview(y,{width:12,height:P,rampAlignment:"vertical",opacity:R,type:"above",effectList:fa});R=q.getUnivariateColorRampPreview(y,{width:12,height:B,rampAlignment:"vertical",opacity:R,type:"below",effectList:fa});var n=q.getUnivariateColorRampMargin(ba);const L=ba.infos.map(v=>v.label);fa=
L.map((v,G)=>{const da=2===G;return 0===G?h.tsx("div",{key:G,class:v?r?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},v):da?h.tsx("div",null):null});const Q=L.length-1,V=Math.floor(L.length/2),c=L.map((v,G)=>{const da=G===Q;return G===V||da?h.tsx("div",{key:G,class:v?r?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},v):null}),p={display:"table-cell",verticalAlign:"middle"};n={marginTop:`${n}px`};P={height:`${P}px`};B={height:`${B}px`};return h.tsx("div",
{key:"univariate-above-and-below-ramp-preview",styles:l},h.tsx("div",{class:"esri-legend__layer-body"},ba.infos.map((v,G)=>h.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},h.tsx("div",{class:"esri-legend__symbol",styles:p,bind:v.preview,afterCreate:u.attachToNode}),r||0!==G%2?null:h.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},L[G])))),r?h.tsx("div",{styles:n,key:"color-ramp-preview"},h.tsx("div",{styles:A},h.tsx("div",{styles:d},h.tsx("div",
{class:"esri-legend__ramps",bind:r,afterCreate:u.attachToNode})),h.tsx("div",{styles:d},h.tsx("div",{class:"esri-legend__ramp-labels",styles:P},fa))),h.tsx("div",{styles:A},h.tsx("div",{styles:d},h.tsx("div",{class:"esri-legend__ramps",bind:R,afterCreate:u.attachToNode})),h.tsx("div",{styles:d},h.tsx("div",{class:"esri-legend__ramp-labels",styles:B},c)))):null)};U._renderUnivariateColorSizeRamp=function(B,R,fa){const {sizeRampElement:ba,colorRampElement:y}=q.getUnivariateColorSizeRampElements(B);
if(!ba)return null;var P=q.getUnivariateColorRampMargin(ba);B=q.getUnivariateColorRampSize(ba,"full",!1);R=q.getUnivariateColorRampPreview(y,{width:12,height:B,rampAlignment:"vertical",opacity:R,type:"full",effectList:fa});const r=ba.infos.length-1;fa=ba.infos.map((L,Q)=>0===Q||Q===r?h.tsx("div",{key:Q,class:L.label?y?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},L.label):null);const n={display:"table-cell",verticalAlign:"middle"};P={marginTop:`${P}px`};B={height:`${B}px`};
return h.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:l},h.tsx("div",{class:"esri-legend__layer-body"},ba.infos.map(L=>h.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},h.tsx("div",{class:"esri-legend__symbol",styles:n,bind:L.preview,afterCreate:u.attachToNode})))),h.tsx("div",{styles:P,key:"color-ramp-preview"},h.tsx("div",{styles:A},h.tsx("div",{styles:d},h.tsx("div",{class:"esri-legend__ramps",bind:R,afterCreate:u.attachToNode})),h.tsx("div",
{styles:d},h.tsx("div",{class:"esri-legend__ramp-labels",styles:B},fa)))))};U._renderLegendForRamp=function(B,R){const fa=B.infos,ba="heatmap-ramp"===B.type,y="stretch-ramp"===B.type,P=B.preview;P.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===B.type?"esri-legend__opacity-ramp":""}`;null!=R&&(P.style.opacity=R.toString());B=fa.map(r=>h.tsx("div",{class:r.label?"esri-legend__ramp-label":null},ba?this.messages[r.label]:y?this._getStretchStopLabel(r):r.label));R={height:P.style.height};return h.tsx("div",
{class:"esri-legend__layer-row"},h.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},h.tsx("div",{class:"esri-legend__ramps",bind:P,afterCreate:u.attachToNode})),h.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},h.tsx("div",{class:"esri-legend__ramp-labels",styles:R},B)))};U._getStretchStopLabel=function(B){return B.label?this.messages[B.label]+": "+("string"===typeof B.value?B.value:z.formatNumber(B.value,{style:"decimal",
notation:-1<B.value.toString().indexOf("e")?"scientific":"standard"})):""};U._renderLegendForElementInfo=function(B,R,fa,ba,y){if(B.type)return this._renderLegendForElement(B,R,fa,!0);fa=null;y=u.isImageryStretchedLegend(R,y);B.preview?fa=h.tsx("div",{class:"esri-legend__symbol",bind:B.preview,afterCreate:u.attachToNode}):B.src&&(fa=this._renderImage(B,R,y));if(!fa)return null;R={["esri-legend__imagery-layer-info--stretched"]:y};return h.tsx("div",{class:"esri-legend__layer-row"},h.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",
{["esri-legend__imagery-layer-info--stretched"]:y,["esri-legend__size-ramp"]:!y&&ba})},fa),h.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",R)},u.getTitle(this.messages,B.label,!1)||""))};U._renderImage=function(B,R,fa){const {label:ba,src:y,opacity:P}=B;fa={["esri-legend__imagery-layer-image--stretched"]:fa,["esri-legend__symbol"]:!fa};R={opacity:`${null!=P?P:R.opacity}`};return h.tsx("img",{alt:u.getTitle(this.messages,ba,!1),src:y,border:0,width:B.width,height:B.height,
class:this.classes(fa),styles:R})};return M}(Z);H.__decorate([T.property()],I.prototype,"activeLayerInfos",void 0);H.__decorate([T.property()],I.prototype,"headingLevel",void 0);H.__decorate([T.property(),w.messageBundle("esri/widgets/Legend/t9n/Legend")],I.prototype,"messages",void 0);H.__decorate([T.property({readOnly:!0})],I.prototype,"type",void 0);return I=H.__decorate([J.subclass("esri.widgets.Legend.styles.Classic")],I)})},"widgets/Legend/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],
function(){})},"*now":function(F){F(['dojo/i18n!*preload*widgets/Legend/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define(["dojo/_base/declare","jimu/BaseWidget","esri/widgets/Legend"],function(F,H,I){return F([H],{name:"Legend",baseClass:"jimu-widget-legend",templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'legendDiv'\x3e\x3c/div\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);this.legend=new I({container:this.legendDiv,view:this.sceneView})},destroy:function(){this.legend&&this.legend.destroy();this.inherited(arguments)}})});