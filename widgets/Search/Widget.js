// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/events ../core/Handles ../core/string ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/widgetUtils ./support/decorators/messageBundle ../core/Logger ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q,K){const y=/<[a-z/][\s\S]*>/i;a=function(Y){function ca(m,z){var r=Y.call(this,m,z)||this;r._activeMenuItemIndex=-1;r._handles=new h;r._inputNode=null;r._menuItemCount=0;r._sourceMenuButtonNode=null;r._sourceListNode=null;r._suggestionListNode=null;r._searchResultRenderer=new E;r._locateFailed=null;r._container=null;r.activeMenu="none";r.activeSource=null;r.activeSourceIndex=null;r.allPlaceholder=null;r.allSources=null;r.autoNavigate=null;r.autoSelect=
null;r.defaultSources=null;r.disabled=!1;r.goToOverride=null;r.iconClass="esri-icon-search";r.includeDefaultSources=null;r.label=void 0;r.locationEnabled=null;r.maxResults=null;r.maxSuggestions=null;r.messages=null;r.messagesCommon=null;r.minSuggestCharacters=null;r.popupEnabled=null;r.popupTemplate=null;r.portal=null;r.resultGraphic=null;r.resultGraphicEnabled=null;r.results=null;r.searchAllEnabled=null;r.searchTerm=null;r.selectedResult=null;r.sources=null;r.suggestions=null;r.suggestionsEnabled=
null;r.view=null;r.viewModel=new H;r._clearActiveMenu=()=>{r.activeMenu="none"};r._removeActiveMenu=R=>{var w;(R=R.relatedTarget)&&null!=(w=r._container)&&w.contains(R)||r._clearActiveMenu()};r.own(G.watch(d._assertThisInitialized(r),"searchTerm",R=>{(R&&"warning"===r.activeMenu||!R&&!r.get("viewModel.selectedSuggestion.location"))&&r._clearActiveMenu()}),G.on(d._assertThisInitialized(r),"viewModel.allSources","change",()=>r._watchSourceChanges()),G.init(d._assertThisInitialized(r),"activeMenu",()=>
r._resetActiveMenuItemIndex()),G.init(d._assertThisInitialized(r),"viewModel.defaultPopupTemplate",R=>{R&&(R.content=r._renderSearchResultsContent.bind(d._assertThisInitialized(r)))}));return r}d._inheritsLoose(ca,Y);var I=ca.prototype;I.destroy=function(){this._handles.destroy();this._handles=null;this._cancelSuggest();this._cancelSearch();this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)};I.clear=function(){};
I.focus=function(){var m;null==(m=this._inputNode)?void 0:m.focus();this.emit("search-focus")};I.blur=function(){var m;null==(m=this._inputNode)?void 0:m.blur();this.emit("search-blur")};I.search=function(m){this._clearActiveMenu();this._cancelSuggest();this._cancelSearch();const z=new AbortController,{signal:r}=z;this._searchController=z;return this.viewModel.search(m,{signal:r}).catch(R=>{if(this._searchController===z)return this._clearActiveMenu(),this._searchController=null,R}).then(R=>{if(this._searchController===
z)return this.activeMenu=R.numResults?"none":"warning",this._searchController=null,R})};I.suggest=function(m){this._cancelSuggest();const z=new AbortController,{signal:r}=z;this._suggestController=z;return this.viewModel.suggest(m,null,{signal:r}).then(R=>{if(this._suggestController===z)return this._suggestController=null,R.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),R}).catch(()=>{if(this._suggestController===z)return this._suggestController=null})};I.render=function(){const {state:m}=
this.viewModel;return Q.tsx("div",{class:this.classes("esri-search esri-widget",{["esri-disabled"]:"disabled"===m,["esri-widget--disabled"]:this.disabled})},"loading"===m?this.renderLoader():this.renderContainer())};I.renderSubmitButton=function(){const {messages:m}=this;return Q.tsx("button",{"aria-label":m.searchButtonTitle,bind:this,class:this.classes("esri-search__submit-button","esri-widget--button"),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:m.searchButtonTitle,
type:"button"},Q.tsx("span",{"aria-hidden":"true",class:"esri-icon-search"}))};I.renderWarningMenu=function(){return Q.tsx("div",{key:"esri-search__error-menu",class:this.classes("esri-menu","esri-search__warning-menu")},Q.tsx("div",{class:"esri-search__warning-body"},this.renderWarning()))};I.renderSourceMenuButton=function(){const {messages:m,activeMenu:z,sourceMenuId:r,sourceMenuButtonId:R}=this,{activeSourceIndex:w,allSources:M}=this.viewModel;return 1<M.length?Q.tsx("button",{id:R,key:"esri-search__source-menu-button",
bind:this,"aria-label":m.searchIn,title:m.searchIn,"aria-haspopup":"true","aria-expanded":("source"===z).toString(),"aria-controls":r,class:this.classes("esri-search__sources-button","esri-widget--button"),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:N.storeNode,"data-node-ref":"_sourceMenuButtonNode",type:"button"},Q.tsx("span",{"aria-hidden":"true",class:"esri-icon-down-arrow esri-search__sources-button--down"}),Q.tsx("span",{"aria-hidden":"true",
class:"esri-icon-up-arrow esri-search__sources-button--up"}),Q.tsx("span",{class:"esri-search__source-name"},this._getSourceName(w))):null};I.renderSourcesList=function(){const {allSources:m,searchAllEnabled:z}=this.viewModel,{_activeMenuItemIndex:r,activeMenu:R,sourceMenuId:w,sourceMenuButtonId:M}=this,O="source"===R&&-1<r?this._buildId("source-item",r):null;return 1<m.length?Q.tsx("ul",{"aria-activedescendant":O,"aria-labelledby":M,id:w,role:"menu",bind:this,afterCreate:N.storeNode,onkeydown:this._handleSourceMenuKeydown,
onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:"esri-menu__list",tabIndex:-1},z?this.renderSource(H.ALL_INDEX):null,m.map((T,n)=>this.renderSource(n)).toArray()):null};I.renderSourcesMenu=function(){const {allSources:m}=this.viewModel;return 1<m.length?Q.tsx("div",{key:"esri-search__source-menu",class:this.classes("esri-menu","esri-search__sources-menu")},this.renderSourcesList()):null};I.renderLoader=function(){const {messages:m,messagesCommon:z}=this;return Q.tsx("div",
{class:"esri-widget__loader",key:"base-loader"},Q.tsx("span",{"aria-hidden":"true",class:"esri-widget__loader-animation"}),Q.tsx("span",{class:"esri-icon-font-fallback-text"},m.searchButtonTitle),Q.tsx("span",{class:"esri-widget__loader-text"},z.loading))};I.renderContainer=function(){const {allSources:m,state:z}=this.viewModel,{activeMenu:r}=this;return Q.tsx("div",{tabIndex:-1,afterCreate:R=>{this._container=R;R.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:R=>{R.removeEventListener("focusout",
this._removeActiveMenu)},class:this.classes({["esri-search--multiple-sources"]:1<m.length,["esri-search--loading"]:"loading"===z,["esri-search--searching"]:"searching"===z,["esri-search--warning"]:"warning"===r,["esri-search--sources"]:"source"===r,["esri-search--show-suggestions"]:"suggestion"===r},"esri-search__container"),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())};I.renderClearButton=
function(){return this.searchTerm?Q.tsx("button",{bind:this,class:this.classes("esri-search__clear-button","esri-widget--button"),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},Q.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})):null};I.renderLocationGroup=function(){const {messages:m,locationEnabled:z,displayedSearchTerm:r}=this,R="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;
return z&&!r?Q.tsx("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes("esri-menu__list","esri-search__suggestions-list","esri-search__suggestions-list--current-location")},Q.tsx("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes("esri-menu__list-item",R?"esri-menu__list-item--focus":
null)},Q.tsx("span",{"aria-hidden":"true",class:"esri-icon-locate-circled"})," ",m.useCurrentLocation)):null};I.renderInput=function(){const {activeMenu:m,locationEnabled:z,displayedSearchTerm:r,messages:R,suggestionsMenuId:w,inputId:M,_activeMenuItemIndex:O}=this,{maxInputLength:T,placeholder:n,searchTerm:g,suggestionCount:B}=this.viewModel,V=!!(z&&!r||B),X="suggestion"===m&&-1<O?this._buildId("suggestion-item",O):null;return Q.tsx("input",{"aria-activedescendant":X,"aria-autocomplete":"list","aria-expanded":(V&&
"suggestion"===m).toString(),"aria-controls":V?w:null,"aria-haspopup":"listbox","aria-label":R.searchButtonTitle,bind:this,placeholder:n,maxlength:T,autocomplete:"off",type:"text",class:this.classes("esri-input","esri-search__input"),value:g,id:M,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:N.storeNode,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:g?"":n})};I.renderForm=
function(){return Q.tsx("form",{key:"esri-search__form",bind:this,class:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this.renderInput())};I.renderSuggestList=function(m){const {sourceIndex:z}=m,r=m.results;return m.results.length?Q.tsx("ul",{role:"group",key:`esri-search__suggestion-list-${z}`,class:this.classes("esri-menu__list","esri-search__suggestions-list")},r.map(R=>this.renderSuggestion(R,this._menuItemCount++))):null};I.renderSuggestionsGroup=function(){const {suggestions:m}=
this.viewModel;return m?m.map(z=>[this.renderSuggestionHeader(z),this.renderSuggestList(z)]):null};I.renderSuggestionsMenu=function(){const {displayedSearchTerm:m,locationEnabled:z,suggestionsMenuId:r,inputId:R}=this,{suggestionCount:w}=this.viewModel;this._menuItemCount=0;return z&&!m||w?Q.tsx("div",{id:r,key:"esri-search__suggestions-menu",class:this.classes("esri-menu","esri-search__suggestions-menu"),role:"listbox","aria-labelledby":R,bind:this,afterCreate:N.storeNode,"data-node-ref":"_suggestionListNode"},
this.renderLocationGroup(),this.renderSuggestionsGroup()):null};I.renderInputContainer=function(){return Q.tsx("div",{key:"esri-search__input-container",class:"esri-search__input-container"},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())};I.renderSuggestionHeader=function(m){const {allSources:z,activeSourceIndex:r}=this.viewModel,{sourceIndex:R}=m,w=1<z.length&&r===H.ALL_INDEX;return m.results.length&&w?Q.tsx("div",{key:`esri-search__suggestion-header-${R}`,class:"esri-menu__header"},
this._getSourceName(R)):null};I.renderSuggestion=function(m,z){const {_activeMenuItemIndex:r,messages:R}=this;var {searchTerm:w}=this.viewModel;if(w){var {text:M}=m;M=M||R.untitledResult;const O=[];if(y.test(M))O.push(Q.tsx("div",{innerHTML:M}));else{M=this._splitResult(M,w);const T=w.toLowerCase();M.forEach((n,g)=>{n&&n.length&&(n.toLowerCase()===T?O.push(Q.tsx("strong",{key:g},n)):O.push(n))})}w="suggestion"===this.activeMenu&&r===z;return Q.tsx("li",{bind:this,id:this._buildId("suggestion-item",
z),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===z).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${z}`,"data-suggestion":m,role:"option",class:this.classes("esri-menu__list-item",w?"esri-menu__list-item--focus":null)},O)}};I.renderSource=function(m){const {activeSourceIndex:z,searchAllEnabled:r}=this.viewModel,R={["esri-menu__list-item--active"]:m===z,["esri-menu__list-item--focus"]:"source"===this.activeMenu&&m===(r?this._activeMenuItemIndex-
1:this._activeMenuItemIndex)};return Q.tsx("li",{bind:this,key:`esri-search__source-${m}`,id:this._buildId("source-item",r?m+1:m),"aria-checked":(m===z).toString(),onclick:this._handleSourceClick,"data-source-index":m,role:"menuitemradio",class:this.classes("esri-search__source","esri-menu__list-item",R)},this._getSourceName(m))};I.renderNoResultsWarning=function(m){const {messages:z}=this;m=m?K.substitute(z.noResultsFoundForValue,{value:`"${m}"`}):z.noResultsFound;return Q.tsx("div",{key:"esri-search__no_results"},
Q.tsx("div",{class:"esri-search__warning-header"},z.noResults),Q.tsx("div",{class:"esri-search__warning-text"},m))};I.renderEmptySearchWarning=function(){const {messages:m}=this;return Q.tsx("div",{key:"esri-search__empty-search"},Q.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),Q.tsx("span",{class:"esri-search__no-value-text"},m.emptyValue))};I.renderLocateWarning=function(){const {messages:m}=this;return Q.tsx("div",{key:"esri-search__locate-error"},Q.tsx("span",{"aria-hidden":"true",
class:"esri-icon-notice-triangle"}),Q.tsx("span",{class:"esri-search__no-value-text"},m.locateError))};I.renderWarning=function(){var m;const {displayedSearchTerm:z,_locateFailed:r}=this,{viewModel:R}=this;return r?this.renderLocateWarning():null!=(m=R.selectedSuggestion)&&m.location||z?this.renderNoResultsWarning(z):this.renderEmptySearchWarning()};I._resetActiveMenuItemIndex=function(){this._activeMenuItemIndex=-1};I._buildId=function(m,z){return`${this.id}-${m}${void 0===z?"":`-${z}`}`};I._watchSourceChanges=
function(){const {_handles:m,viewModel:{allSources:z}}=this;m.remove("sources");z.forEach(r=>m.add(G.watch(r,"name",()=>this.scheduleRender()),"sources"))};I._handleSourcesMenuToggleFocus=function(){"source"!==this.activeMenu&&this._clearActiveMenu()};I._handleSourcesMenuToggleClick=function(){this.activeMenu="source"===this.activeMenu?"none":"source";this.renderNow();if("source"===this.activeMenu){var m;null==(m=this._sourceListNode)?void 0:m.focus()}};I._handleClearButtonClick=function(){this.viewModel.clear();
this._focus()};I._handleSearchButtonClick=function(){this.search()};I._handleSuggestionClick=function(m){if(m=m.currentTarget["data-suggestion"])this._focus(),this.search(m)};I._handleUseCurrentLocationClick=function(){this._useCurrentLocation()};I._useCurrentLocation=function(){this._focus("none");this._cancelSuggest();this._cancelSearch();const m=new AbortController,{signal:z}=m;this._searchController=m;this.viewModel.searchNearby({signal:z}).then(r=>{this.activeMenu=r.numResults?"none":"warning"}).catch(()=>
{this._locateFailed=!0;this.activeMenu="warning"}).then(()=>{this._searchController=null})};I._handleSourceClick=function(m){this._setSourceFromMenuItem(m.currentTarget)};I._setSourceFromMenuItem=function(m){var z;m&&(this.viewModel.activeSourceIndex=m["data-source-index"],this._clearActiveMenu(),null==(z=this._sourceMenuButtonNode)?void 0:z.focus())};I._cancelSuggest=function(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)};I._cancelSearch=function(){this._searchController&&
(this._searchController.abort(),this._searchController=null);this._locateFailed=!1};I._handleInputKeyup=function(m){var z,r=v.eventKey(m);if(!m.ctrlKey&&!m.metaKey&&"Copy"!==r&&"ArrowLeft"!==r&&"ArrowRight"!==r&&"Shift"!==r)if("Tab"===r||"Escape"===r||m.shiftKey&&"Tab"===r)this._cancelSuggest(),"Escape"===r&&this._clearActiveMenu();else{var R="Home"===r||"End"===r||"ArrowUp"===r||"ArrowDown"===r;if("Enter"===r&&0>this._activeMenuItemIndex)this._cancelSuggest();else{var w=null==(z=this._suggestionListNode)?
void 0:z.getElementsByTagName("li");if(null!=w&&w.length){"suggestion"!==this.activeMenu&&this._openSuggestionMenu();if(R){m.preventDefault();this._cancelSuggest();this._handleItemNavigation(r,w,this._suggestionListNode);return}m=w[this._activeMenuItemIndex];if("Enter"===r&&m){(r=m["data-suggestion"])?(this._focus(),this.search(r)):m["data-current-location-item"]&&this._useCurrentLocation();return}}this.viewModel.searchTerm&&this.suggest()}}};I._handleItemNavigation=function(m,z,r){const R=this._activeMenuItemIndex;
"Home"===m&&(this._activeMenuItemIndex=0);"End"===m&&(this._activeMenuItemIndex=z.length-1);"ArrowUp"===m&&(this._activeMenuItemIndex=0>=this._activeMenuItemIndex?z.length-1:this._activeMenuItemIndex-1);"ArrowDown"===m&&(this._activeMenuItemIndex=this._activeMenuItemIndex===z.length-1?0:this._activeMenuItemIndex+1);R!==this._activeMenuItemIndex&&N.keepMenuItemWithinView(z[this._activeMenuItemIndex],r)};I._scrollToTopSuggestion=function(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=
0)};I._openSuggestionMenu=function(){this.activeMenu="suggestion"};I._handleInputPaste=function(m){m=m.target;this.viewModel.searchTerm!==m.value&&(this.viewModel.searchTerm=m.value);this.viewModel.searchTerm&&this.suggest()};I._handleSourceMenuKeydown=function(m){const z=v.eventKey(m);N.isActivationKey(z)?(m.preventDefault(),m=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex],this._setSourceFromMenuItem(m)):"ArrowUp"!==z&&"ArrowDown"!==z&&"End"!==z&&"Home"!==z||m.preventDefault()};
I._handleSourceMenuKeyup=function(m){var z;const r=v.eventKey(m),R="ArrowUp"===r||"ArrowDown"===r||"End"===r||"Home"===r;R&&m.preventDefault();if("Escape"===r){var w;this._clearActiveMenu();null==(w=this._sourceMenuButtonNode)?void 0:w.focus()}else(m=null==(z=this._sourceListNode)?void 0:z.getElementsByTagName("li"))&&0!==m.length&&R&&("source"!==this.activeMenu&&(this.activeMenu="source"),this._handleItemNavigation(r,m,this._sourceListNode.parentElement))};I._focus=function(m){this.focus();m&&(this.activeMenu=
m)};I._formSubmit=function(m){m.preventDefault();-1===this._activeMenuItemIndex&&this.search()};I._getSourceName=function(m){const {messages:z}=this;var {allSources:r}=this.viewModel;r=r.getItemAt(m);return m===H.ALL_INDEX?z.all:r?r.name||z.untitledSource:z.untitledSource};I._splitResult=function(m,z){z=S.escapeRegExpString(z);return m.replace(new RegExp(`(^|)(${z})(|$)`,"ig"),"$1|$2|$3").split("|")};I._renderSearchResultsContent=function(){this._searchResultRenderer.showMoreResultsOpen=!1;this._searchResultRenderer.viewModel=
this.viewModel;return this._searchResultRenderer};d._createClass(ca,[{key:"displayedSearchTerm",get:function(){return`${this.viewModel.searchTerm}`.trim()}},{key:"inputId",get:function(){return this._buildId("input")}},{key:"suggestionsMenuId",get:function(){return this._buildId("suggest-menu")}},{key:"sourceMenuId",get:function(){return this._buildId("source-menu")}},{key:"sourceMenuButtonId",get:function(){return this._buildId("source-menu-button")}}]);return ca}(x);b.__decorate([e.property()],
a.prototype,"_activeMenuItemIndex",void 0);b.__decorate([e.property()],a.prototype,"displayedSearchTerm",null);b.__decorate([e.property({readOnly:!0})],a.prototype,"inputId",null);b.__decorate([e.property({readOnly:!0})],a.prototype,"suggestionsMenuId",null);b.__decorate([e.property({readOnly:!0})],a.prototype,"sourceMenuId",null);b.__decorate([e.property({readOnly:!0})],a.prototype,"sourceMenuButtonId",null);b.__decorate([e.property()],a.prototype,"activeMenu",void 0);b.__decorate([J.aliasOf("viewModel.activeSource")],
a.prototype,"activeSource",void 0);b.__decorate([J.aliasOf("viewModel.activeSourceIndex")],a.prototype,"activeSourceIndex",void 0);b.__decorate([J.aliasOf("viewModel.allPlaceholder")],a.prototype,"allPlaceholder",void 0);b.__decorate([J.aliasOf("viewModel.allSources")],a.prototype,"allSources",void 0);b.__decorate([J.aliasOf("viewModel.autoNavigate")],a.prototype,"autoNavigate",void 0);b.__decorate([J.aliasOf("viewModel.autoSelect")],a.prototype,"autoSelect",void 0);b.__decorate([J.aliasOf("viewModel.defaultSources")],
a.prototype,"defaultSources",void 0);b.__decorate([e.property()],a.prototype,"disabled",void 0);b.__decorate([J.aliasOf("viewModel.goToOverride")],a.prototype,"goToOverride",void 0);b.__decorate([e.property()],a.prototype,"iconClass",void 0);b.__decorate([J.aliasOf("viewModel.includeDefaultSources")],a.prototype,"includeDefaultSources",void 0);b.__decorate([e.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],a.prototype,"label",void 0);b.__decorate([J.aliasOf("viewModel.locationEnabled")],
a.prototype,"locationEnabled",void 0);b.__decorate([J.aliasOf("viewModel.maxResults")],a.prototype,"maxResults",void 0);b.__decorate([J.aliasOf("viewModel.maxSuggestions")],a.prototype,"maxSuggestions",void 0);b.__decorate([e.property(),u.messageBundle("esri/widgets/Search/t9n/Search")],a.prototype,"messages",void 0);b.__decorate([e.property(),u.messageBundle("esri/t9n/common")],a.prototype,"messagesCommon",void 0);b.__decorate([J.aliasOf("viewModel.minSuggestCharacters")],a.prototype,"minSuggestCharacters",
void 0);b.__decorate([J.aliasOf("viewModel.popupEnabled")],a.prototype,"popupEnabled",void 0);b.__decorate([J.aliasOf("viewModel.popupTemplate")],a.prototype,"popupTemplate",void 0);b.__decorate([J.aliasOf("viewModel.portal")],a.prototype,"portal",void 0);b.__decorate([J.aliasOf("viewModel.resultGraphic")],a.prototype,"resultGraphic",void 0);b.__decorate([J.aliasOf("viewModel.resultGraphicEnabled")],a.prototype,"resultGraphicEnabled",void 0);b.__decorate([J.aliasOf("viewModel.results")],a.prototype,
"results",void 0);b.__decorate([J.aliasOf("viewModel.searchAllEnabled")],a.prototype,"searchAllEnabled",void 0);b.__decorate([J.aliasOf("viewModel.searchTerm")],a.prototype,"searchTerm",void 0);b.__decorate([J.aliasOf("viewModel.selectedResult")],a.prototype,"selectedResult",void 0);b.__decorate([J.aliasOf("viewModel.sources")],a.prototype,"sources",void 0);b.__decorate([J.aliasOf("viewModel.suggestions")],a.prototype,"suggestions",void 0);b.__decorate([J.aliasOf("viewModel.suggestionsEnabled")],
a.prototype,"suggestionsEnabled",void 0);b.__decorate([J.aliasOf("viewModel.view")],a.prototype,"view",void 0);b.__decorate([D.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),e.property({type:H})],a.prototype,"viewModel",void 0);b.__decorate([J.aliasOf("viewModel.clear")],a.prototype,"clear",null);return a=b.__decorate([k.subclass("esri.widgets.Search")],a)})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../Widget ./SearchViewModel ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../../core/Logger ../support/jsxFactory ../support/widgetUtils".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x){v=function(E){function H(u,A){u=E.call(this,u,A)||this;u.messages=null;u.showMoreResultsOpen=!1;u.viewModel=null;return u}d._inheritsLoose(H,E);var N=H.prototype;N.render=function(){return k.tsx("div",{class:"esri-search-result-renderer esri-widget"},k.tsx("div",{key:"esri-search-renderer__container",class:this.classes("esri-search-result-renderer__more-results",{["esri-search-result-renderer__more-results--show-more-results"]:this.showMoreResultsOpen})},this.renderSearchResultName(),
this.renderMoreResults()))};N.renderMoreResults=function(){return k.tsx("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())};N.renderSearchResultName=function(){var u;const A=null==(u=this.viewModel)?void 0:u.selectedResult;return k.tsx("div",{key:"esri-search-renderer__result-name",class:"esri-search-result-renderer__more-results-item"},A&&A.name||"")};N.renderMoreResultsLists=function(){var u,A=null==(u=this.viewModel)?void 0:u.results;
({resultCount:u}=this.viewModel);if(2>u)return null;A=A.map(D=>this.renderMoreResultsList(D));return k.tsx("div",{key:"esri-search-renderer__more-results-container",class:"esri-search-result-renderer__more-results-list"},A)};N.renderMoreResultsButton=function(){const {messages:u}=this,{resultCount:A}=this.viewModel;return 2>A?null:k.tsx("div",{key:"esri-search-renderer__more-results-button",class:"esri-search-result-renderer__more-results-item"},k.tsx("a",{class:"esri-widget__anchor",href:"#",bind:this,
onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?u.hideMoreResults:u.showMoreResults))};N.renderMoreResultsHeader=function(u,A){return k.tsx("div",{key:`esri-search-result-renderer__header-${A}`,class:"esri-search-result-renderer__more-results-list-header"},u)};N.renderMoreResultsList=function(u){var A,D;const {results:Q}=u;var K=Q.length;const y=!!K,Y=null==(A=this.viewModel)?void 0:A.selectedResult;A=1===K&&Q[0]===Y;K=this._getSourceName(u.source,
u.sourceIndex);K=1<(null==(D=this.viewModel)?void 0:D.results.length)&&!A?this.renderMoreResultsHeader(K,u.sourceIndex):null;D=y&&Q.map((ca,I)=>this.renderMoreResultsListItem(ca,I));D=y&&!A?k.tsx("ul",{key:`esri-search-result-renderer__list-${u.sourceIndex}`},D):null;return y?k.tsx("div",{key:`esri-search-result-renderer__results-${u.sourceIndex}`},K,D):null};N.renderMoreResultsListItem=function(u,A){const D=this.get("viewModel.selectedResult");return u!==D?k.tsx("li",{key:`esri-search-result-renderer__list-item-${A}`},
k.tsx("a",{class:"esri-widget__anchor",href:"#",tabindex:"0",bind:this,"data-result":u,onclick:this._selectResultClick,onkeydown:this._selectResultClick},u.name)):null};N._showMoreResultsClick=function(u){u.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(u=this.get("viewModel.view.popup"))&&u.reposition()};N._selectResultClick=function(u){u.preventDefault();u=u.currentTarget["data-result"];this.viewModel&&this.viewModel.select(u)};N._getSourceName=function(u,A){return A===q.ALL_INDEX?
this.messages.all:u.name};return H}(J);b.__decorate([a.property(),f.messageBundle("esri/widgets/Search/t9n/Search")],v.prototype,"messages",void 0);b.__decorate([a.property()],v.prototype,"showMoreResultsOpen",void 0);b.__decorate([a.property()],v.prototype,"viewModel",void 0);b.__decorate([l.accessibleHandler()],v.prototype,"_showMoreResultsClick",null);b.__decorate([l.accessibleHandler()],v.prototype,"_selectResultClick",null);return v=b.__decorate([G.subclass("esri.widgets.Search.SearchResultRenderer")],
v)})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../symbols ../../core/Accessor ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../intl/locale ../../intl/messages ../../portal/Portal ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/geometryUtils ./support/locatorUtils ../support/geolocationUtils ../support/GoTo ../../symbols/TextSymbol ../../symbols/PictureMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q,K,y,Y,ca,I,m,z,r,R,w,M,O,T,n,g,B,V,X,ba){function aa(ja,ea){return ja.hasOwnProperty(ea)&&null!=ja[ea]&&""!==ja[ea]}const ka=E.getLogger("esri.widgets.Search.SearchViewModel"),pa=q.ofType({key:ja=>ja.layer?"layer":"locator",base:M,typeMap:{layer:R,locator:w}}),qa=ca.WGS84,oa=/<(?:.|\s)*?>/g;G=function(ja){function ea(c){c=ja.call(this,c)||this;c._handles=new k;c._gotoController=null;c._searching=null;c.autoNavigate=!0;c.autoSelect=!0;c.defaultPopupTemplate=
null;c.defaultSources=new pa;c.defaultSymbols={point:new V({url:a.getAssetUrl(x("trident")?"esri/images/search/search-symbol-32.png":"esri/images/search/search-symbol-32.svg"),size:24,width:24,height:24}),polyline:new X({color:[130,130,130,1],width:2}),polygon:new ba({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};c.includeDefaultSources=!0;c.maxInputLength=128;c.maxResults=6;c.maxSuggestions=6;c.messages=null;c.minSuggestCharacters=3;c.popupEnabled=!0;c.popupTemplate=null;c.portal=
z.getDefault();c.resultCount=null;c.resultGraphicEnabled=!0;c.resultGraphic=null;c.results=null;c.selectedSuggestion=null;c.searchAllEnabled=!0;c.selectedResult=null;c.sources=new pa;c.suggestionDelay=350;c.suggestionCount=null;c.suggestions=null;c.suggestionsEnabled=!0;c.view=null;return c}d._inheritsLoose(ea,ja);var U=ea.prototype;U.initialize=function(){var c=this;const t=function(){var C=d._asyncToGenerator(function*(){const F=yield m.fetchMessageBundle("esri/widgets/Search/t9n/Search");c.messages=
F;c.defaultPopupTemplate=new S({title:F.searchResult,content:"{Match_addr}"})});return function(){return C.apply(this,arguments)}}();t();this._handles.add([A.init(this,["includeDefaultSources","view","portal"],()=>this._update()),I.onLocaleChange(t)])};U.destroy=function(){this._abortGoTo();this.clearGraphics();this._handles.destroy();this._handles=null};U.clear=function(){this.searchTerm=""};U.clearGraphics=function(){this._removeHighlight();this._closePopup();this.view&&this.view.graphics.remove(this.resultGraphic);
this._set("resultGraphic",null)};U.search=function(c,t){this.emit("search-start");this.clearGraphics();const C=this._createSuggestionForSearch(c);return this._searching=c=this.when().then(()=>this._getResultsFromSources(C,t).then(F=>{var L;if(null!=(L=H.unwrap(null==t?void 0:t.signal))&&L.aborted)return null;const Z={activeSourceIndex:this.activeSourceIndex,searchTerm:C.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(Z,F,C);F=this._getFirstResult(Z.results);L=(C.location&&
F?F.name:C.text).replace(oa,"");this._set("searchTerm",L);(C.key&&"number"===typeof C.sourceIndex||C.location)&&this._set("selectedSuggestion",C);this._set("results",Z.results);this._set("resultCount",Z.results.reduce((ha,ia)=>ha+ia.results.length,0));this.emit("search-complete",Z);return this._selectFirstResult(F).then(()=>Z)})).then(F=>{this._clearSearching();return F},F=>{this._clearSearching();throw F;})};U.searchNearby=function(c){if(!this.locationEnabled){var t=new f("searchNearby:geolocation-unsupported",
"Geolocation API is unsupported.",{geolocation:navigator.geolocation});ka.error(t);return Promise.reject(t)}this._searching=t=n.getCurrentPosition().then(C=>n.positionToPoint({position:C,view:this.view},c)).then(C=>this.search(C,c));t.catch(()=>{}).then(()=>this._clearSearching());return t};U.select=function(c){this.clearGraphics();if(!c){var t=new f("select:missing-parameter","Cannot select without a searchResult.",{searchResult:c});ka.error(t);return Promise.reject(t)}const {view:C}=this,F=aa(c,
"sourceIndex")?c.sourceIndex:this._getSourceIndexOfResult(c),L=this.allSources.getItemAt(F);if(!L)return t=new f("select:missing-source","Cannot select without a source.",{source:L}),ka.error(t),Promise.reject(t);t=L instanceof R?this._getLayerSourcePopupTemplate(L):L.popupTemplate;const Z=L.resultSymbol||this._getDefaultSymbol(c),ha=aa(L,"resultGraphicEnabled")?L.resultGraphicEnabled:this.resultGraphicEnabled,ia=aa(L,"autoNavigate")?L.autoNavigate:this.autoNavigate,ra=aa(L,"popupEnabled")?L.popupEnabled:
this.popupEnabled,wa=ra?t||this.popupTemplate||this.defaultPopupTemplate:null,{feature:la}=c;if(!la)return t=new f("select:missing-feature","Cannot select without a feature.",{feature:la}),ka.error(t),Promise.reject(t);const {attributes:sa,geometry:da,layer:p,sourceLayer:P}=la,W=O.getPointFromGeometry(da);t={layerViewQuery:this._getLayerView(la),elevationQuery:C&&H.isSome(W)?O.getPointWithElevation(W,C).catch(()=>W):Promise.resolve(W)};return N.eachAlways(t).then(fa=>{const ma=fa.layerViewQuery.value,
na=fa.elevationQuery.value;Z instanceof B&&(Z.text=c.name);fa=C&&ia?c.target||c.extent:null;return(H.isSome(fa)?this._goToSearchResult(fa):Promise.resolve()).then(()=>{var ua;const ta=ma?la:new h({geometry:da,symbol:Z,attributes:sa,layer:p,sourceLayer:P,popupTemplate:wa}),va=ra&&(null==(ua=this.view)?void 0:ua.popup);(ua=va&&ta.getEffectivePopupTemplate(va.defaultPopupTemplateEnabled))&&C.popup.open({features:[ta],location:na});ma&&r.highlightsSupported(ma)&&!ua&&this._highlightFeature({graphic:ta,
layerView:ma});!ma&&ha&&C&&C.graphics.push(ta);this._setResultFloor(c);this._set("selectedResult",c);this._set("resultGraphic",ta);this.emit("select-result",{result:c,source:L,sourceIndex:F});return c})})};U.suggest=function(c,t,C){const F=c||this.searchTerm;this.emit("suggest-start",{searchTerm:F});return this._suggestTimer(t,C).then(()=>this._suggestImmediate(F,C).then(L=>{this._set("suggestions",L.results);this._set("suggestionCount",L.results.reduce((Z,ha)=>Z+ha.results.length,0));this.emit("suggest-complete",
L);return L}))};U.when=function(){var c=d._asyncToGenerator(function*(){yield u.whenOnce(()=>!this.updating)});return function(){return c.apply(this,arguments)}}();U._update=function(){var c=d._asyncToGenerator(function*(){const {portal:t,view:C}=this;if(this.includeDefaultSources){const F=this._updatingPromise=N.eachAlways([null==t?void 0:t.load(),null==C?void 0:C.when()]);if(this.destroyed)return;yield F;if(F!==this._updatingPromise)return}yield u.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();
this._updatingPromise=null});return function(){return c.apply(this,arguments)}}();U._clearSearching=function(){this._searching=null};U._convertHelperServices=function(){var c,t;const C=null==(c=this.portal)?void 0:null==(t=c.helperServices)?void 0:t.geocode;return C?C.map(F=>{if(!1!==F.placefinding){var L=v.apiKey&&T.isArcGISWorldGeocoder(F.url)?{url:T.meteredArcGISLocatorUrl}:null;F=w.fromJSON({...F,...L});L=F.url;(T.isArcGISWorldGeocoder(L)||T.isProxiedArcGISWorldGeocoder(L)||T.isMeteredArcGISWorldGeocoder(L))&&
F.set({singleLineFieldName:"SingleLine",outFields:F.outFields||["Addr_type","Match_addr","StAddr","City"],placeholder:F.placeholder||this.messages.placeholder,defaultZoomScale:"number"===typeof F.defaultZoomScale?F.defaultZoomScale:2500});if(F.singleLineFieldName)return F}}).filter(Boolean):[]};U._getLayerSources=function(c,t){var C;const F=null==(C=this.view)?void 0:C.map;return c.map(L=>{const Z=F.findLayerById(L.id);if(Z){L=this._getLayerJSON(L);var ha=R.fromJSON(L);ha.placeholder=t;this._getLayer(Z,
L).then(ia=>{ha.layer=ia});return ha}}).filter(Boolean).toArray()};U._getTableSources=function(c,t){var C;const F=null==(C=this.view)?void 0:C.map;return c.map(L=>{const Z=F.findTableById(L.id);if(Z){L=this._getLayerJSON(L);var ha=R.fromJSON(L);ha.placeholder=t;this._getLayer(Z,L).then(ia=>{ha.layer=ia});return ha}}).filter(Boolean).toArray()};U._convertApplicationProperties=function(){var c,t,C;const F=null==(c=this.view)?void 0:c.map;c=null==F?void 0:null==(t=F.applicationProperties)?void 0:null==
(C=t.viewing)?void 0:C.search;if(!c)return[];const {enabled:L,hintText:Z,layers:ha,tables:ia}=c;if(!L)return[];t=this._getLayerSources(ha,Z);C=this._getTableSources(ia,Z);return[...t,...C]};U._getSubLayer=function(c,t){return c.load().then(()=>{if(!c.allSublayers)return Promise.reject();const C=c.allSublayers.find(F=>F.id===t.subLayer);return C?C.createFeatureLayer():Promise.reject()})};U._getBuildingSubLayer=function(){var c=d._asyncToGenerator(function*(t,C){yield t.load();t=t.allSublayers.find(F=>
F.id===C.subLayer);if("building-component"!==(null==t?void 0:t.type))return Promise.reject();yield t.load();if(null==t.associatedLayer)return Promise.reject();yield t.associatedLayer.load();return t});return function(t,C){return c.apply(this,arguments)}}();U._getLayer=function(c,t){return"feature"===c.type||"scene"===c.type||"csv"===c.type||"geojson"===c.type||"ogc-feature"===c.type?Promise.resolve(c):"map-image"===c.type?this._getSubLayer(c,t).catch(()=>{const C=new f("search:create-featurelayer",
"Could not create a FeatureLayer from the MapImageLayer",{layer:c});ka.error(C);return null}):"building-scene"===c.type?this._getBuildingSubLayer(c,t):Promise.resolve(null)};U._getLayerJSON=function(c){return"function"===typeof c.toJSON?c.toJSON():c};U._updateDefaultSources=function(){const {defaultSources:c,includeDefaultSources:t}=this;c.removeAll();t&&c.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])};U._abortGoTo=function(){this._gotoController&&this._gotoController.abort();
this._gotoController=null};U._clear=function(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")};U._closePopup=function(){var c;const t=null==(c=this.view)?void 0:c.popup;({resultGraphic:c}=this);if(t&&c){var {selectedFeature:C}=t;C&&C===c&&t.close()}};U._suggestTimer=function(c,t){return N.after(null!=c?c:this.suggestionDelay,
null,t&&t.signal)};U._createLocationForSearch=function(c){return c instanceof h?O.getPointFromGeometry(c.geometry):c instanceof Y?c:Array.isArray(c)&&2===c.length?new Y({longitude:c[0],latitude:c[1]}):null};U._createSuggestionForSearch=function(c){if(c&&aa(c,"key")&&aa(c,"text")&&aa(c,"sourceIndex"))return c;const t=this._createLocationForSearch(c),C="string"===typeof c?c:this.searchTerm,{selectedSuggestion:F,selectedResult:L}=this,Z=(c=!c&&F&&L)&&F.location;return c&&F.key===L.key&&F.sourceIndex===
L.sourceIndex||Z?F:{location:H.unwrap(t),text:t?"":C,sourceIndex:null,key:null}};U._getFirstResult=function(c){let t=null;c&&c.some(C=>{({results:C}=C);C=C[0];const F=!!C;F&&(t=C);return F});return t};U._selectFirstResult=function(c){return this.autoSelect&&c?this.select(c):Promise.resolve(null)};U._suggestImmediate=function(c,t){return this.when().then(()=>this._getSuggestionsFromSources(c,t)).then(C=>{var F;if(null!=(F=H.unwrap(null==t?void 0:t.signal))&&F.aborted)return null;F={activeSourceIndex:this.activeSourceIndex,
searchTerm:c,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(F,C);return F})};U._formatSourceResponse=function(c,t,C){const F=t&&t.value||[];t=t&&t.error;const L=this.allSources.getItemAt(C);t?(c.errors.push({sourceIndex:C,source:L,error:t}),ka.error(t),c.numErrors++):(c.results.push({sourceIndex:C,source:L,results:F}),c.numResults+=F.length)};U._formatResponse=function(c,t,C){if(t)if(-1===c.activeSourceIndex){const F=C&&aa(C,"sourceIndex")&&-1!==C.sourceIndex?C.sourceIndex:void 0;
t.forEach((L,Z)=>{this._formatSourceResponse(c,L,void 0!==F?F:Z)})}else this._formatSourceResponse(c,t[0],c.activeSourceIndex)};U._getResultsFromSources=function(c,t){var {allSources:C}=this;const F=!c.location&&aa(c,"sourceIndex")?c.sourceIndex:this.activeSourceIndex,L=[];if(!C.length)return C=new f("search:no-sources-defined","At least one source is required.",{allSources:C}),ka.error(C),Promise.reject(C);-1===F?C.forEach((Z,ha)=>{L.push(this._getResultsFromSource(c,ha,t))}):L.push(this._getResultsFromSource(c,
F,t));return N.eachAlways(L)};U._getSuggestionsFromSources=function(c,t){const {allSources:C,activeSourceIndex:F}=this,L=[];if(!C.length){const Z=new f("suggest:no-sources-defined","At least one source is required.",{allSources:C});ka.error(Z);return Promise.reject(Z)}-1===F?C.forEach((Z,ha)=>{L.push(this._getSuggestionsFromSource(c,ha,t))}):L.push(this._getSuggestionsFromSource(c,F,t));return N.eachAlways(L)};U._getResultsFromSource=function(c,t,C){var F;const L=this.allSources.getItemAt(t),{location:Z=
null}=c,ha=(null==(F=this.view)?void 0:F.spatialReference)||qa;F=aa(L,"maxResults")?L.maxResults:this.maxResults;const ia=L instanceof R&&aa(L,"exactMatch")?L.exactMatch:!1,{view:ra}=this;return L.getResults({view:ra,sourceIndex:t,location:Z,suggestResult:c,spatialReference:ha,exactMatch:ia,maxResults:F},C)};U._getSuggestionsFromSource=function(c,t,C){const F=this.allSources.getItemAt(t);var L=aa(F,"suggestionsEnabled")?F.suggestionsEnabled:this.suggestionsEnabled,Z=c.length,ha=aa(F,"minSuggestCharacters")?
F.minSuggestCharacters:this.minSuggestCharacters;if(L&&c.trim()&&Z>=ha){var ia;L=(null==(ia=this.view)?void 0:ia.spatialReference)||qa;ia=aa(F,"maxSuggestions")?F.maxSuggestions:this.maxSuggestions;({view:Z}=this);ha=F instanceof R&&aa(F,"exactMatch")?F.exactMatch:!1;return F.getSuggestions({view:Z,sourceIndex:t,suggestTerm:c,spatialReference:L,maxSuggestions:ia,exactMatch:ha},C)}return Promise.resolve(null)};U._getLayerSourcePopupTemplate=function(c){const {layer:t}=c;if(t)return aa(c,"popupTemplate")?
c.popupTemplate:t.popupTemplate};U._getSourceIndexOfResult=function(c){let t=null;this.results.some(C=>C.results.some(F=>F===c?(t=C.sourceIndex,!0):!1));return t};U._goToSearchResult=function(){var c=d._asyncToGenerator(function*(t){const C=!!t;this._abortGoTo();const F=new AbortController;this._gotoController=F;yield this.callGoTo({target:{target:t},options:{animate:C,signal:F.signal}});this._gotoController=null});return function(t){return c.apply(this,arguments)}}();U._getDefaultSymbol=function(c){var t;
const {defaultSymbols:C}=this;c=null==(t=c.feature)?void 0:t.geometry;if(!H.isSome(c))return null;if((t=this._get("defaultSymbol"))&&("point"===c.type||"multipoint"===c.type))return t;switch(c.type){case "point":case "multipoint":return C.point;case "polyline":return C.polyline;case "extent":case "polygon":return C.polygon;default:return null}};U._removeHighlight=function(){this._handles.remove("highlight")};U._getLayerView=function(){var c=d._asyncToGenerator(function*(t){const {view:C}=this;if(!t||
!C||"building-component"===t.layer.type||"subtype-sublayer"===t.layer.type)return Promise.resolve(null);({layer:t}=t);yield C.when();return C.whenLayerView(t)});return function(t){return c.apply(this,arguments)}}();U._highlightFeature=function(c){const {graphic:t,layerView:C}=c,{attributes:F,layer:L}=t;({objectIdField:c}=L);c=C.highlight(F&&F[c]||t);this._handles.add(c,"highlight")};U._setResultFloor=function(c){var t,C,F;const {view:L}=this,Z=null==(t=c.feature)?void 0:t.attributes;(c=null==(C=c.feature)?
void 0:C.sourceLayer)&&"floorInfo"in c&&null!=c&&null!=(F=c.floorInfo)&&F.floorField&&Z&&L.emit("select-result-floor",Z[c.floorInfo.floorField])};d._createClass(ea,[{key:"activeSource",get:function(){return this.allSources.getItemAt(this.activeSourceIndex)||null}},{key:"activeSourceIndex",get:function(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0},set:function(c){void 0===c?this._clearOverride("activeSourceIndex"):this._override("activeSourceIndex",c)}},{key:"allPlaceholder",get:function(){var c;
return null==(c=this.messages)?void 0:c.allPlaceholder},set:function(c){c?this._override("allPlaceholder",c):this._clearOverride("allPlaceholder")}},{key:"allSources",get:function(){const {sources:c,defaultSources:t,includeDefaultSources:C}=this,F="function"===typeof C?C.call(null,{sources:c,defaultSources:t}):C?t.concat(c):c,L=this._get("allSources")||new pa;L.removeAll();L.addMany(F.filter(Boolean));return L}},{key:"defaultSymbol",get:function(){l.deprecatedProperty(ka,"defaultSymbol",{replacement:"defaultSymbols",
version:"4.22"});return this._get("defaultSymbol")},set:function(c){l.deprecatedProperty(ka,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"});this._set("defaultSymbol",c)}},{key:"locationEnabled",get:function(){return this._get("locationEnabled")||n.supported()},set:function(c){if(void 0===c)this._clearOverride("locationEnabled");else{var t=n.supported();if(c&&!t){const C=new f("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});
ka.error(C)}this._override("locationEnabled",c&&t)}}},{key:"placeholder",get:function(){const {allSources:c,activeSourceIndex:t,allPlaceholder:C}=this;if(-1===t)return C;const F=c.getItemAt(t);return F?F.placeholder:""}},{key:"searchTerm",get:function(){return this._get("searchTerm")||""},set:function(c){this._set("searchTerm",c||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==c&&this._set("selectedSuggestion",null);""===c&&this._clear()}},{key:"state",get:function(){return this._searching?
"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}},{key:"updating",get:function(){return null!=this._updatingPromise}}]);return ea}(g.GoToMixin(e.EventedMixin(J)));G.ALL_INDEX=-1;b.__decorate([D.property()],G.prototype,"_searching",void 0);b.__decorate([D.property()],G.prototype,"_updatingPromise",void 0);b.__decorate([D.property({readOnly:!0,value:null})],G.prototype,"activeSource",null);b.__decorate([D.property()],G.prototype,"activeSourceIndex",null);b.__decorate([D.property()],
G.prototype,"allPlaceholder",null);b.__decorate([D.property({readOnly:!0})],G.prototype,"allSources",null);b.__decorate([D.property()],G.prototype,"autoNavigate",void 0);b.__decorate([D.property()],G.prototype,"autoSelect",void 0);b.__decorate([D.property()],G.prototype,"defaultPopupTemplate",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"defaultSources",void 0);b.__decorate([D.property()],G.prototype,"defaultSymbol",null);b.__decorate([D.property()],G.prototype,"defaultSymbols",void 0);
b.__decorate([D.property()],G.prototype,"includeDefaultSources",void 0);b.__decorate([D.property()],G.prototype,"locationEnabled",null);b.__decorate([D.property()],G.prototype,"maxInputLength",void 0);b.__decorate([D.property()],G.prototype,"maxResults",void 0);b.__decorate([D.property()],G.prototype,"maxSuggestions",void 0);b.__decorate([D.property()],G.prototype,"messages",void 0);b.__decorate([D.property()],G.prototype,"minSuggestCharacters",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,
"placeholder",null);b.__decorate([D.property()],G.prototype,"popupEnabled",void 0);b.__decorate([D.property({type:S})],G.prototype,"popupTemplate",void 0);b.__decorate([D.property({type:z})],G.prototype,"portal",void 0);b.__decorate([D.property()],G.prototype,"resultCount",void 0);b.__decorate([D.property()],G.prototype,"resultGraphicEnabled",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"resultGraphic",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"results",void 0);
b.__decorate([D.property({readOnly:!0})],G.prototype,"selectedSuggestion",void 0);b.__decorate([D.property()],G.prototype,"searchAllEnabled",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"selectedResult",void 0);b.__decorate([D.property()],G.prototype,"searchTerm",null);b.__decorate([D.property({type:pa})],G.prototype,"sources",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"state",null);b.__decorate([D.property()],G.prototype,"suggestionDelay",void 0);b.__decorate([D.property()],
G.prototype,"suggestionCount",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"suggestions",void 0);b.__decorate([D.property()],G.prototype,"suggestionsEnabled",void 0);b.__decorate([D.property({readOnly:!0})],G.prototype,"updating",null);b.__decorate([D.property()],G.prototype,"view",void 0);b.__decorate([D.property()],G.prototype,"clear",null);return G=b.__decorate([y.subclass("esri.widgets.Search.SearchViewModel")],G)})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(d,b,a,v,h,S,G,J){var q;h=q=function(l){function f(k){var x=l.call(this,k)||this;x.displayField=null;x.exactMatch=null;x.orderByFields=null;x.searchFields=null;x.searchTemplate=null;x.suggestionTemplate=null;x.getResults=(E,H)=>J.getResults({source:d._assertThisInitialized(x),...E},H);x.getSuggestions=(E,H)=>J.getSuggestions({source:d._assertThisInitialized(x),...E},H);return x}d._inheritsLoose(f,l);var e=f.prototype;e.clone=function(){return new q({autoNavigate:this.autoNavigate,filter:this.filter,
maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?a.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,
layer:this.layer,searchFields:this.searchFields?a.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})};e._getFirstStringField=function(){var k,x;return null!=(k=null==(x=this.layer.fieldsIndex.fields.find(E=>"string"===E.type))?void 0:x.name)?k:""};e._getDisplayField=function(){return this.displayField||this.layer.displayField||this._getFirstStringField()};e._getSearchFieldsString=function(){const {layer:k,searchFields:x}=this;return k.loaded?`: ${(x||
[this._getDisplayField()]).map(E=>{const H=k.getField(E);return H&&H.alias||E}).join(", ")}`:""};e._getLayerTitle=function(){var {layer:k}=this;if(k&&({title:k}=k,k))return`${k}${this._getSearchFieldsString()}`};d._createClass(f,[{key:"layer",set:function(k){this._set("layer",k);k&&k.load().catch(()=>{})}},{key:"name",get:function(){return this._getLayerTitle()||""},set:function(k){void 0===k?this._clearOverride("name"):this._override("name",k)}}]);return f}(G);b.__decorate([v.property({json:{read:{source:"field.name"},
write:{target:"field.name"}}})],h.prototype,"displayField",void 0);b.__decorate([v.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],h.prototype,"exactMatch",void 0);b.__decorate([v.property({value:null})],h.prototype,"layer",null);b.__decorate([v.property()],h.prototype,"name",null);b.__decorate([v.property({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0);b.__decorate([v.property()],h.prototype,"searchFields",void 0);b.__decorate([v.property()],
h.prototype,"searchTemplate",void 0);b.__decorate([v.property()],h.prototype,"suggestionTemplate",void 0);return h=q=b.__decorate([S.subclass("esri.widgets.Search.LayerSearchSource")],h)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,v,h,S,G,J,q){a=function(l){function f(e){e=l.call(this,e)||this;e.autoNavigate=null;e.filter=null;e.getResults=null;e.getSuggestions=null;e.maxResults=null;e.maxSuggestions=null;e.minSuggestCharacters=null;e.outFields=null;e.placeholder="";e.popupEnabled=null;e.popupTemplate=null;e.prefix="";e.resultGraphicEnabled=null;e.resultSymbol=null;e.suggestionsEnabled=null;e.suffix="";e.withinViewEnabled=!1;e.zoomScale=null;return e}d._inheritsLoose(f,l);return f}(a.IdentifiableMixin(v.JSONSupport));
b.__decorate([h.property()],a.prototype,"autoNavigate",void 0);b.__decorate([h.property()],a.prototype,"filter",void 0);b.__decorate([h.property()],a.prototype,"getResults",void 0);b.__decorate([h.property()],a.prototype,"getSuggestions",void 0);b.__decorate([h.property()],a.prototype,"maxResults",void 0);b.__decorate([h.property()],a.prototype,"maxSuggestions",void 0);b.__decorate([h.property()],a.prototype,"minSuggestCharacters",void 0);b.__decorate([h.property()],a.prototype,"outFields",void 0);
b.__decorate([h.property()],a.prototype,"placeholder",void 0);b.__decorate([h.property()],a.prototype,"popupEnabled",void 0);b.__decorate([h.property()],a.prototype,"popupTemplate",void 0);b.__decorate([h.property()],a.prototype,"prefix",void 0);b.__decorate([h.property()],a.prototype,"resultGraphicEnabled",void 0);b.__decorate([h.property()],a.prototype,"resultSymbol",void 0);b.__decorate([h.property()],a.prototype,"suggestionsEnabled",void 0);b.__decorate([h.property()],a.prototype,"suffix",void 0);
b.__decorate([h.property()],a.prototype,"withinViewEnabled",void 0);b.__decorate([h.property()],a.prototype,"zoomScale",void 0);return a=b.__decorate([q.subclass("esri.widgets.Search.SearchSource")],a)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/unitUtils ../../../geometry/Polygon ./geometryUtils ../../../intl/substitute ../../../intl/date".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e){function k(w,M){const {filter:O,withinViewEnabled:T}=w;w=M&&M.extent;return O&&O.geometry||(T&&w?w:void 0)}function x(w){return E.apply(this,arguments)}function E(){E=b._asyncToGenerator(function*(w){w&&(yield w.load())});return E.apply(this,arguments)}function H(w){var M,O,T;return null!=(M=null==w?void 0:null==(O=w.capabilities)?void 0:null==(T=O.query)?void 0:T.supportsPagination)?M:!1}function N(w){var M,O,T,n;return null!=(M=null==w?void 0:null==(O=w.fieldsIndex)?
void 0:null==(T=O.fields)?void 0:null==(n=T.find(g=>"string"===g.type))?void 0:n.name)?M:""}function u(w,M){return w&&M?M.every(O=>!!w.getField(O)):!1}function A(w,M,O){let T=null;({codedValues:w}=w);w&&w.some(n=>{var g=n.name;g=O?g:g.toLowerCase();return(O?M:M.toLowerCase())===g?(T=n.code.toString(),!0):!1});return T}function D(w,M){return(M=M&&M.where)?`(${w}) AND (${M})`:w}function Q({currentTerm:w,field:M,filter:O,exactMatch:T,url:n,type:g}){var B=M.type;M=M.name;if("string"===B||"date"===B||
"global-id"===B){if(B=n=z.test(n))a:{for(B=0;B<w.length;B++)if(255<w.charCodeAt(B)){B=!0;break a}B=!1}B=B?"N":"";if(T&&"search"===g)return D(`${M} = ${B}'${w}'`,O);g=n?M:`UPPER(${M})`;w=n?w:w.toUpperCase();return D(`${g} LIKE ${B}${T?`'${w}%'`:`'%${w}%'`}`,O)}return"oid"===B||"small-integer"===B||"integer"===B||"single"===B||"double"===B?(T=Number(w),isNaN(T)?null:D(`${M} = ${T}`,O)):D(`${M} = ${w}`,O)}function K({searchTerm:w,layer:M,searchFields:O,filter:T,exactMatch:n,type:g}){const {definitionExpression:B,
url:V}=M;let X="";w&&O&&O.forEach(ba=>{var aa=M.getField(ba);ba=((ba="function"===typeof M.getFieldDomain&&M.getFieldDomain(ba))&&"coded-value"===ba.type?A(ba,w,n):null)||w||null;null!==ba&&(aa=Q({currentTerm:ba,field:aa,filter:T,exactMatch:n,url:V,type:g}))&&(X+=X?` OR (${aa})`:`(${aa})`)});return B?`(${B}) AND (${X})`:X}function y(w,M){let O=null;({codedValues:w}=w);w&&w.length&&w.some(T=>T.code===M?(O=T.name,!0):!1);return O}function Y(w,M){return w[Object.keys(w).find(O=>O.toLowerCase()===M.toLowerCase())]}
function ca(w,M,O){const T=w.sourceLayer,{attributes:n}=w;w="function"===typeof T.getFieldDomain&&T.getFieldDomain(O);return M?f.substitute(M,n):O&&n?(M=T.getField(O),O=Y(n,O),null==O?"":w&&"coded-value"===w.type?y(w,O):"date"===(null==M?void 0:M.type)?e.formatDate(new Date(O)):"number"===typeof O?O.toString():"string"!==typeof O?"":O.trim()):""}function I(w,M,O,T){return w.features.map(n=>{var g=n.sourceLayer,{attributes:B}=n;({objectIdField:g}=g);B=B[g];return n={text:ca(n,M.suggestionTemplate,
T),key:B,sourceIndex:O}})}function m(w,M,O,T,n,g,B){return w.features.map(V=>{{var X=V.clone();var ba=V.sourceLayer;ba=(ba=ba&&ba.objectIdField)&&V.attributes[ba];const ka=ca(V,O.searchTemplate,n);var aa=l.createExtentFromGeometry(X.geometry,M,g);aa="number"===typeof B?l.scaleExtent(h.clone(aa),M,B):aa;V=V.clone();G.isSome(aa)&&(V.geometry=q.fromExtent(aa));X={extent:aa,target:V,feature:X,key:ba,name:ka,sourceIndex:T}}return X})}const z=/https?:\/\/services.*\.arcgis\.com/i,r=/(?:\{([^}]+)\})/g,R=
S.getLogger("esri.widgets.Search.support.layerSearchUtils");d.getResults=function(w,M){const {exactMatch:O=!1,location:T,maxResults:n,spatialReference:g,source:B,sourceIndex:V,suggestResult:X,view:ba}=w,{layer:aa,filter:ka,zoomScale:pa}=B,qa=ba&&ba.scale,oa=k(B,ba),ja=M&&M.signal;return x(aa).then(()=>{const ea=aa.popupTemplate;return ea?ea.getRequiredFields(aa.fieldsIndex):null}).then(ea=>{var U,c,t;const {objectIdField:C,returnZ:F}=aa,L=B.displayField||B.layer.displayField||N(B.layer);if(!aa.getField(L))throw R.error("invalid-field: displayField is invalid."),
new v("getResults():invalid-field","displayField is invalid.");ea=ea&&ea.length?ea:[L];var Z=(ea=B.outFields||ea)&&-1!==ea.indexOf("*");-1!==ea.indexOf(C)||Z||ea.push(C);null!=(U=aa.floorInfo)&&U.floorField&&ea.push(aa.floorInfo.floorField);if(!Z&&!u(aa,ea))throw R.error("invalid-field: outField is invalid."),new v("getResults():invalid-field","outField is invalid.");U=aa.createQuery();({orderByFields:Z}=B);Z&&(U.orderByFields=Z);g&&(U.outSpatialReference=g,Z=1/J.getMetersPerUnitForSR(g))&&(U.maxAllowableOffset=
Z);Z="mesh"===aa.geometryType||"multipatch"===aa.geometryType;const ha=(null==(c=aa.capabilities)?void 0:null==(t=c.data)?void 0:t.supportsZ)&&!Z;U.returnZ=ha&&!1!==F;U.returnGeometry=!0;U.multipatchOption=Z?"xyFootprint":null;ea&&(U.outFields=ea);if(T)U.geometry=T;else if(X.key)U.objectIds=[X.key];else{c=B.searchFields||[L];if(!u(aa,c))throw R.error("invalid-field: search field is invalid."),new v("getResults():invalid-field","search field is invalid.");H(aa)&&(U.num=n);oa&&(U.geometry=oa);if(!X.text.trim())return[];
const {prefix:ia="",suffix:ra=""}=B;t=`${ia}${X.text}${ra}`.replace(/'/g,"''");c=K({searchTerm:t,layer:aa,searchFields:c,filter:ka,exactMatch:O,type:"search"});if(!c)return[];U.where=c}return aa.queryFeatures(U,{signal:ja}).then(ia=>m(ia,ba,B,V,L,qa,pa))})};d.getSuggestions=function(w,M){const {source:O,spatialReference:T,view:n,suggestTerm:g,maxSuggestions:B,sourceIndex:V,exactMatch:X}=w,{layer:ba,filter:aa}=O,ka=M&&M.signal,pa=k(O,n);return x(ba).then(()=>{if(!H(ba))return[];const qa=O.displayField||
O.layer.displayField||N(O.layer);var oa=O.searchFields||[qa];const ja=[];O.suggestionTemplate?O.suggestionTemplate.replace(r,(F,L)=>{ja.push(L);return F}):ja.push(qa);var ea=ja&&-1!==ja.indexOf("*");-1!==ja.indexOf(ba.objectIdField)||ea||ja.push(ba.objectIdField);var U=!!ba.getField(qa);ea=ea||u(ba,ja);const c=u(ba,oa);if(!U)throw R.error("invalid-field: displayField is invalid."),new v("getSuggestions():invalid-field","displayField is invalid.");if(!ea)throw R.error("invalid-field: outField is invalid."),
new v("getSuggestions():invalid-field","outField is invalid.");if(!c)throw R.error("invalid-field: search field is invalid."),new v("getSuggestions():invalid-field","search field is invalid.");U=ba.createQuery();({orderByFields:ea}=O);ea&&(U.orderByFields=ea);U.outSpatialReference=T;U.returnGeometry=!1;U.num=B;U.outFields=ja;pa&&(U.geometry=pa);if(!g.trim())return[];const {prefix:t="",suffix:C=""}=O;ea=`${t}${g}${C}`.replace(/'/g,"''");oa=K({searchTerm:ea,layer:ba,searchFields:oa,filter:aa,exactMatch:X,
type:"suggest"});if(!oa)return[];U.where=oa;return ba.queryFeatures(U,{signal:ka}).then(F=>I(F,O,V,qa))})};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/widgets/Search/support/geometryUtils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/Logger ../../../core/maybe ../../../geometry/support/scaleUtils ../../../geometry/Extent".split(" "),function(d,b,a,v,h,S,G){function J(l,f,e){const k=l.hasZ?l.z:void 0;return f&&f.map?(e?S.getExtentForScale(f,e):f.extent).clone().centerAt(l).set({zmax:k,
zmin:k}):new G({xmin:l.x-.25,ymin:l.y-.25,xmax:l.x+.25,ymax:l.y+.25,spatialReference:l.spatialReference,zmin:k,zmax:k})}const q=v.getLogger("esri.widgets.Search.support.geometryUtils");d.createExtentFromGeometry=function(l,f,e){if(h.isNone(l))return null;if("extent"===l.type)return l;if("multipoint"===l.type||"polygon"===l.type||"polyline"===l.type)return l.extent;if("point"===l.type)return J(l,f,e)};d.getPointFromGeometry=function(l){if(h.isNone(l))return null;switch(l.type){case "point":return l;
case "extent":return l.center;case "polygon":return l.centroid;case "multipoint":return l.getPoint(0);case "polyline":return l.getPoint(0,0)}return null};d.getPointWithElevation=function(l,f){var e,k;if(!f)return q.error("missing-parameter: view is missing."),Promise.reject(new a("searchgeometryutils:missing-parameter","view is missing."));if(!l)return q.error("missing-parameter: point is missing."),Promise.reject(new a("searchgeometryutils:missing-parameter","point is missing."));if(l.hasZ||"2d"===
f.type)return Promise.resolve(l);const x=null==f?void 0:null==(e=f.map)?void 0:e.ground;return x&&x.layers.length?x.queryElevation(l,{cache:null==(k=f.basemapTerrain)?void 0:k.elevationQueryCache}).then(E=>E.geometry):Promise.resolve(l)};d.scaleExtent=function(l,f,e){return h.isNone(l)||h.isNone(f)?null:J(l.center,f,e)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/deprecate ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../tasks/Locator ./SearchSource ./support/locatorUtils".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f){var e;const k=h.getLogger("esri.widgets.Search.LocatorSearchSource");h=e=function(x){function E(H){var N=x.call(this,H)||this;N.apiKey=null;N.categories=null;N.countryCode=null;N.defaultZoomScale=null;N.localSearchDisabled=!1;N.locationType=null;N.name="";N.placeholder="";N.searchTemplate="";N.singleLineFieldName=null;N.suggestionsEnabled=null;N.url=null;N.zoomScale=null;N.getResults=(u,A)=>f.getResults({source:d._assertThisInitialized(N),...u},A);N.getSuggestions=
(u,A)=>f.getSuggestions({source:d._assertThisInitialized(N),...u},A);return N}d._inheritsLoose(E,x);E.prototype.clone=function(){return new e({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?v.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,
resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?v.clone(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})};d._createClass(E,[{key:"locator",get:function(){a.deprecatedProperty(k,"locator",{replacement:"url",
version:"4.22"});return this._get("locator")},set:function(H){a.deprecatedProperty(k,"locator",{replacement:"url",version:"4.22"});this._set("url",H.url);this._set("locator",H)}}]);return E}(l);b.__decorate([S.property()],h.prototype,"apiKey",void 0);b.__decorate([S.property()],h.prototype,"categories",void 0);b.__decorate([S.property()],h.prototype,"countryCode",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"defaultZoomScale",void 0);b.__decorate([S.property()],h.prototype,"localSearchDisabled",
void 0);b.__decorate([S.property({type:q,json:{read:!1,write:!1}})],h.prototype,"locator",null);b.__decorate([S.property()],h.prototype,"locationType",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"name",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"placeholder",void 0);b.__decorate([S.property()],h.prototype,"searchTemplate",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"singleLineFieldName",void 0);b.__decorate([S.property({json:{read:{source:"suggest"},
write:{target:"suggest"}}})],h.prototype,"suggestionsEnabled",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"url",void 0);b.__decorate([S.property({json:{write:!0}})],h.prototype,"zoomScale",void 0);return h=e=b.__decorate([J.subclass("esri.widgets.Search.LocatorSearchSource")],h)})},"esri/tasks/Locator":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/SpatialReference ../rest/locator/addressToLocations ../rest/locator/addressesToLocations ../rest/locator/locationToAddress ../rest/locator/suggestLocations ./Task".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k){v=function(x){function E(N){N=x.call(this,N)||this;N.outSpatialReference=null;N.url=null;return N}d._inheritsLoose(E,x);var H=E.prototype;H.addressToLocations=function(N,u){!N.outSpatialReference&&this.outSpatialReference&&(N.outSpatialReference=this.outSpatialReference);return q.addressToLocations(this.url,N,{...this.requestOptions,...u})};H.suggestLocations=function(N,u){return e.suggestLocations(this.url,N,{...this.requestOptions,...u})};H.addressesToLocations=
function(N,u){!N.outSpatialReference&&this.outSpatialReference&&(N.outSpatialReference=this.outSpatialReference);return l.addressesToLocations(this.url,N,{...this.requestOptions,...u})};H.locationToAddress=function(N,u){!N.outSpatialReference&&this.outSpatialReference&&(N.outSpatialReference=this.outSpatialReference);return f.locationToAddress(this.url,N,{...this.requestOptions,...u})};return E}(k);b.__decorate([a.property({type:J})],v.prototype,"outSpatialReference",void 0);b.__decorate([a.property()],
v.prototype,"url",void 0);return v=b.__decorate([G.subclass("esri.tasks.Locator")],v)})},"esri/rest/locator/addressToLocations":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),function(d,b,a,v,h,S,G){function J(){J=b._asyncToGenerator(function*(l,f,e){f=G.from(f);l=v.parseUrl(l);const {address:k,...x}=f.toJSON();f=v.encode({...l.query,...k,...x,f:"json"});e=v.asValidOptions(f,
e);return a(`${l.path}/findAddressCandidates`,e).then(q)});return J.apply(this,arguments)}function q({data:l}){if(!l)return[];const {candidates:f,spatialReference:e}=l;return f?f.map(k=>{if(k){var {extent:x,location:E}=k,H=x?h.isValidExtent(x):!0;if(h.isValidLocation(E)&&H)return x&&(x.spatialReference=e),E.spatialReference=e,S.fromJSON(k)}}):[]}d.addressToLocations=function(l,f,e){return J.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/rest/locator/utils":function(){define(["exports"],
function(d){d.isValidExtent=function(b){return b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===typeof b.ymax};d.isValidLocation=function(b){return b&&"number"===typeof b.x&&"number"===typeof b.y};d.normalizeExtent=function(b){return b?b.shiftCentralMeridian():null};d.normalizePoint=function(b){return b?b.clone().normalize():null};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(d,b,a,v,h,S,G,J,q,l){a=function(f){function e(k){k=f.call(this,k)||this;k.address=null;k.attributes=null;k.extent=null;k.location=null;k.score=null;return k}d._inheritsLoose(e,f);return e}(a.JSONSupport);b.__decorate([v.property({type:String,json:{write:!0}})],a.prototype,"address",void 0);b.__decorate([v.property({type:Object,json:{write:!0}})],a.prototype,"attributes",void 0);b.__decorate([v.property({type:q,json:{write:!0}})],a.prototype,"extent",void 0);b.__decorate([v.property({type:l,
json:{write:!0}})],a.prototype,"location",void 0);b.__decorate([v.property({type:Number,json:{write:!0}})],a.prototype,"score",void 0);return a=b.__decorate([J.subclass("esri.rest.support.AddressCandidate")],a)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k){a=function(x){function E(H){H=x.call(this,H)||this;H.address=null;H.apiKey=null;H.categories=null;H.countryCode=null;H.forStorage=null;H.location=null;H.locationType=null;H.magicKey=null;H.maxLocations=null;H.outFields=null;H.outSpatialReference=null;H.searchExtent=null;return H}d._inheritsLoose(E,x);return E}(v.JSONSupport);b.__decorate([h.property({type:Object,json:{write:!0}})],a.prototype,"address",void 0);b.__decorate([h.property(l.apiKey)],a.prototype,"apiKey",
void 0);b.__decorate([h.property({type:[String],json:{read:{source:"category",reader:x=>x?x.split(","):null},write:{target:"category",writer:(x,E)=>{E.category=x?x.join(","):null}}}})],a.prototype,"categories",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"countryCode",void 0);b.__decorate([h.property({type:Boolean,json:{write:!0}})],a.prototype,"forStorage",void 0);b.__decorate([h.property({type:f,json:{write:{writer:(x,E)=>{E.location=x?x.clone().normalize():null}}}})],
a.prototype,"location",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"locationType",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"magicKey",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],a.prototype,"maxLocations",void 0);b.__decorate([h.property({type:[String],json:{write:{writer:(x,E)=>{E.outFields=x?x.join(","):null}}}})],a.prototype,"outFields",void 0);b.__decorate([h.property({type:e,json:{read:{source:"outSR"},
write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([h.property({type:k,json:{write:{writer:(x,E)=>{x=x?x.shiftCentralMeridian():null;E.searchExtent=x}}}})],a.prototype,"searchExtent",void 0);a=b.__decorate([q.subclass("esri.rest.support.AddressToLocationsParameters")],a);a.from=J.ensureType(a);return a})},"esri/rest/support/commonProperties":function(){define(["exports"],function(d){d.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperty(d,
"__esModule",{value:!0})})},"esri/rest/locator/addressesToLocations":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ../support/AddressCandidate ../support/AddressesToLocationsParameters".split(" "),function(d,b,a,v,h,S){function G(){G=b._asyncToGenerator(function*(q,l,f){l=S.from(l);q=v.parseUrl(q);l={...l.toJSON(),f:"json"};l=v.encode({...q.query,...l});f=v.asValidOptions(l,f);return a(`${q.path}/geocodeAddresses`,f).then(J)});return G.apply(this,arguments)}
function J(q){({data:q}=q);if(!q)return[];const {locations:l,spatialReference:f}=q;return l?l.map(e=>{const {location:k}=e;k&&(k.spatialReference=f);return h.fromJSON(e)}):[]}d.addressesToLocations=function(q,l,f){return G.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/rest/support/AddressesToLocationsParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/SpatialReference".split(" "),
function(d,b,a,v,h,S,G,J,q,l){a=function(f){function e(k){k=f.call(this,k)||this;k.addresses=null;k.categories=null;k.countryCode=null;k.locationType=null;k.outSpatialReference=null;return k}d._inheritsLoose(e,f);return e}(v.JSONSupport);b.__decorate([h.property({type:[Object],json:{read:{reader:f=>f&&f.records?f.records.map(e=>e.attributes):null},write:{writer:(f,e)=>{const k=[];Array.isArray(f)&&f.forEach(x=>{k.push({attributes:x})});e.addresses={records:k}}}}})],a.prototype,"addresses",void 0);
b.__decorate([h.property({type:[String],json:{read:{source:"category",reader:f=>f?f.split(","):null},write:{target:"category",writer:(f,e)=>{e.category=f?f.join(","):null}}}})],a.prototype,"categories",void 0);b.__decorate([h.property({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],a.prototype,"countryCode",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"locationType",void 0);b.__decorate([h.property({type:l,json:{read:{source:"outSR"},
write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);a=b.__decorate([q.subclass("esri.rest.support.AddressesToLocationsParameters")],a);a.from=J.ensureType(a);return a})},"esri/rest/locator/locationToAddress":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ../support/AddressCandidate ../support/LocationToAddressParameters".split(" "),function(d,b,a,v,h,S){function G(){G=b._asyncToGenerator(function*(q,l,f){l=S.from(l);q=v.parseUrl(q);l={...l.toJSON(),
f:"json"};l=v.encode({...q.query,...l});f=v.asValidOptions(l,f);return a(`${q.path}/reverseGeocode`,f).then(J)});return G.apply(this,arguments)}function J({data:q}){if(q){var {address:l,location:f}=q;return h.fromJSON({address:l&&l.Match_addr||"",attributes:l||{},location:f,score:100})}}d.locationToAddress=function(q,l,f){return G.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e){a=function(k){function x(E){E=k.call(this,E)||this;E.apiKey=null;E.location=null;E.locationType=null;E.outSpatialReference=null;return E}d._inheritsLoose(x,k);return x}(v.JSONSupport);b.__decorate([h.property(l.apiKey)],a.prototype,"apiKey",void 0);b.__decorate([h.property({type:f,json:{write:{writer:(k,x)=>{k=k?k.clone().normalize():null;x.location="undefined"!==typeof k?k:null}}}})],a.prototype,"location",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],
a.prototype,"locationType",void 0);b.__decorate([h.property({type:e,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);a=b.__decorate([q.subclass("esri.rest.support.LocationToAddressParameters")],a);a.from=J.ensureType(a);return a})},"esri/rest/locator/suggestLocations":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ../support/SuggestionCandidate ../support/SuggestLocationsParameters".split(" "),function(d,b,a,
v,h,S){function G(){G=b._asyncToGenerator(function*(q,l,f){q=v.parseUrl(q);l=S.from(l);l={...l.toJSON(),f:"json"};l=v.encode({...q.query,...l});f=v.asValidOptions(l,f);return a(`${q.path}/suggest`,f).then(J)});return G.apply(this,arguments)}function J(q){({data:q}=q);if(!q)return[];({suggestions:q}=q);return q?q.map(l=>new h(l)):[]}d.suggestLocations=function(q,l,f){return G.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,v,h,S,G,J){a=function(q){function l(f){f=q.call(this,f)||this;f.isCollection=null;f.magicKey=null;f.text=null;return f}d._inheritsLoose(l,q);return l}(a.JSONSupport);b.__decorate([v.property({type:Boolean,json:{write:!0}})],a.prototype,"isCollection",void 0);b.__decorate([v.property({type:String,json:{write:!0}})],a.prototype,"magicKey",void 0);b.__decorate([v.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);return a=b.__decorate([J.subclass("esri.rest.support.SuggestionCandidate")],
a)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),function(d,b,a,v,h,S,G,J,q,l,f,e,k){a=function(x){function E(H){H=
x.call(this,H)||this;H.apiKey=null;H.categories=null;H.countryCode=null;H.location=null;H.maxSuggestions=null;H.outSpatialReference=null;H.searchExtent=null;H.text=null;return H}d._inheritsLoose(E,x);return E}(v.JSONSupport);b.__decorate([h.property(l.apiKey)],a.prototype,"apiKey",void 0);b.__decorate([h.property({type:[String],json:{read:{source:"category",reader:x=>x?x.split(","):null},write:{target:"category",writer:(x,E)=>{E.category=x?x.join(","):null}}}})],a.prototype,"categories",void 0);b.__decorate([h.property({type:String,
json:{write:!0}})],a.prototype,"countryCode",void 0);b.__decorate([h.property({type:f,json:{write:{writer:(x,E)=>{E.location=x?x.clone().normalize():null}}}})],a.prototype,"location",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],a.prototype,"maxSuggestions",void 0);b.__decorate([h.property({type:e,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([h.property({type:k,json:{write:{writer:(x,E)=>{x=x?x.shiftCentralMeridian():
null;E.searchExtent=JSON.stringify(x)}}}})],a.prototype,"searchExtent",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);a=b.__decorate([q.subclass("esri.rest.support.SuggestLocationsParameters")],a);a.from=J.ensureType(a);return a})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../core/maybe ../../../geometry/Polygon ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters ./geometryUtils".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f){function e(u,A){if(A.localSearchDisabled)return null;A=null==u?void 0:u.scale;return"number"===typeof A&&3E5>=A?u.get("extent.center"):null}function k(u,A){const {source:D,spatialReference:Q,location:K,sourceIndex:y,view:Y}=u,{apiKey:ca,url:I,zoomScale:m,defaultZoomScale:z}=D,r=Y&&Y.scale;u=A&&A.signal;A=new q;A.location=K;ca&&(A.apiKey=ca);Q&&(A.outSpatialReference=Q);return S.locationToAddress(I,A,{signal:u}).then(R=>N([R],{sourceIndex:y,scale:r,view:Y,zoomScale:m,
defaultZoomScale:z})).catch(()=>[])}function x(u,A){const {filter:D,withinViewEnabled:Q}=u;u=A&&A.extent;return(A=f.createExtentFromGeometry(D&&D.geometry,A,A&&A.scale))||(Q&&u?u:void 0)}function E(u,A){const {source:D,suggestResult:Q,spatialReference:K,view:y,maxResults:Y,sourceIndex:ca}=u,I=D&&D.zoomScale,m=D&&D.defaultZoomScale;if(!Q.text.trim())return Promise.resolve(null);u=`${!Q.key&&D.prefix?D.prefix:""}${Q.text}${!Q.key&&D.suffix?D.suffix:""}`;const z=new J,{apiKey:r,url:R}=D,w=y&&y.scale;
var M=x(D,y);A=A&&A.signal;r&&(z.apiKey=r);if(!R)return Promise.resolve(null);D.categories&&(z.categories=D.categories);D.locationType&&(z.locationType=D.locationType);K&&(z.outSpatialReference=K);const O=e(y,D);O&&(z.location=O);z.maxLocations=Y;M&&(z.searchExtent=a.unwrap(M));D.countryCode&&(z.countryCode=D.countryCode);({key:M}=Q);const T=`${M}`;M&&(z.magicKey=T);z.address={};z.address[D.singleLineFieldName||"Single Line Input"]=u;D.outFields&&(z.outFields=D.outFields);return h.addressToLocations(R,
z,{signal:A}).then(n=>N(n,{key:T,scale:w,sourceIndex:ca,view:y,zoomScale:I,defaultZoomScale:m}))}function H(u,A){return u.map(D=>({text:D.text,key:D.magicKey,sourceIndex:A}))}function N(u,A){return u.filter(Boolean).map(D=>{{const {key:y,scale:Y,sourceIndex:ca,view:I,zoomScale:m,defaultZoomScale:z}=A,{attributes:r,extent:R,location:w,address:M}=D;D=new b({geometry:w,attributes:r});var Q=R||w,K=f.createExtentFromGeometry(Q,I,Y);Q="number"===typeof m?f.scaleExtent(K,I,m):"number"===typeof z&&"point"===
Q.type?f.scaleExtent(K,I,z):K;K=w?`${w.x},${w.y}`:"";K=M||K;const O=D.clone();a.isSome(Q)&&(O.geometry=v.fromExtent(Q));D={extent:Q,feature:D,target:O,key:y,name:K,sourceIndex:ca}}return D})}d.getLocation=e;d.getResults=function(u,A){return u.location?k(u,A):E(u,A)};d.getSuggestions=function(u,A){const {source:D,spatialReference:Q,view:K,suggestTerm:y,maxSuggestions:Y,sourceIndex:ca}=u;u=new l;const {apiKey:I,url:m}=D,z=x(D,K);A=A&&A.signal;if(!m)return Promise.resolve(null);I&&(u.apiKey=I);D.categories&&
(u.categories=D.categories);Q&&(u.outSpatialReference=Q);const r=e(K,D);r&&(u.location=r);if(!y.trim())return Promise.resolve(null);const {prefix:R="",suffix:w=""}=D;u.text=`${R}${y}${w}`;z&&(u.searchExtent=a.unwrap(z));u.maxSuggestions=Y;D.countryCode&&(u.countryCode=D.countryCode);return G.suggestLocations(m,u,{signal:A}).then(M=>H(M,ca))};d.isArcGISWorldGeocoder=function(u){return u?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(u):!1};d.isMeteredArcGISWorldGeocoder=function(u){return u?
/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(u):!1};d.isProxiedArcGISWorldGeocoder=function(u){return u?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(u):!1};d.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(d,"__esModule",{value:!0})})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/urlUtils ../../core/unitUtils ../../geometry ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Polygon ../../geometry/Polyline ../../rest/geometryService/units ../../rest/operations/generalize ../../rest/support/GeneralizeParameters ../../rest/operations/lengths ../../rest/support/LengthsParameters ../../rest/operations/offset ../../rest/support/OffsetParameters ../../rest/geometryService/project ../../rest/operations/relation ../../rest/support/RelationParameters ../../rest/operations/trimExtend ../../rest/support/TrimExtendParameters ../../rest/support/ProjectParameters".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q,K,y,Y,ca,I,m,z,r,R,w){function M(g,B,V){if(!B)return Promise.resolve(g);const X=B.spatialReference;return X.isWGS84?Promise.resolve(g):X.isWebMercator?Promise.resolve(G.geographicToWebMercator(g)):O(V).then(ba=>{if(!ba)throw new a("geometry-service:missing-url","Geometry service URL is missing");const aa=new w({geometries:[g],outSpatialReference:X});return I.project(ba,aa,V).then(ka=>ka[0])})}function O(g){if(b.geometryServiceUrl)return Promise.resolve(b.geometryServiceUrl);
const B=J.getDefault();return B.load(g).catch(()=>{}).then(()=>B.get("helperServices.geometry.url"))}const T=h.getLogger("esri.widgets.support.geolocationUtils"),n={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};d.getCurrentPosition=function(g){g||(g=n);return new Promise((B,V)=>{setTimeout(()=>V(new a("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(B,V,g)})};d.positionToPoint=function(g,B){const {position:V,view:X}=g;g=
V&&V.coords||{};g={accuracy:g.accuracy,altitude:g.altitude,altitudeAccuracy:g.altitudeAccuracy,heading:g.heading,latitude:g.latitude,longitude:g.longitude,speed:g.speed};g=V?{coords:g,timestamp:V.timestamp}:V;g=(g=g&&g.coords)?new S({longitude:g.longitude,latitude:g.latitude,z:g.altitude||null,spatialReference:{wkid:4326}}):null;return M(g,X,B)};d.supported=function(){var g;(g=v("esri-geolocation"))||T.warn("geolocation-unsupported","Geolocation unsupported.");g&&((g=window.isSecureContext)||T.warn("insecure-context",
"Geolocation requires a secure origin."));return g};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/layers/SceneLayer":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../request ../core/Collection ../core/Error ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/utils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/PropertyOrigin ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/SceneService ./support/capabilities ./support/commonProperties ./support/FeatureReduction ./support/FeatureReductionSelection ./support/FetchAssociatedFeatureLayer ./support/fieldProperties ./support/FieldsIndex ./support/fieldUtils ./support/I3SLayerDefinitions ./support/LabelClass ./support/labelingInfo ./support/LayerFloorInfo ./support/RangeInfo ../renderers/support/styleUtils ../rest/support/Query ../support/popupUtils ../webdoc/support/opacityUtils".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q,K,y,Y,ca,I,m,z,r,R,w,M,O,T,n,g,B,V,X,ba,aa,ka,pa,qa,oa,ja,ea,U,c,t,C,F,L,Z){const ha=["3DObject","Point"],ia=N.getLogger("esri.layers.SceneLayer");h=pa.defineFieldProperties();A=function(la){function sa(...p){p=la.call(this,...p)||this;p.featureReduction=null;p.rangeInfos=null;p.operationalLayerType="ArcGISSceneServiceLayer";p.type="scene";p.fields=null;p.floorInfo=null;p.outFields=null;p.nodePages=null;p.materialDefinitions=null;p.textureSetDefinitions=
null;p.geometryDefinitions=null;p.serviceUpdateTimeStamp=null;p.excludeObjectIds=new E;p.definitionExpression=null;p.path=null;p.labelsVisible=!0;p.labelingInfo=null;p.legendEnabled=!0;p.cachedDrawingInfo={color:!1};p.popupEnabled=!0;p.popupTemplate=null;p.objectIdField=null;p.globalIdField=null;p._fieldUsageInfo={};p.screenSizePerspectiveEnabled=!0;return p}b._inheritsLoose(sa,la);var da=sa.prototype;da.normalizeCtorArgs=function(p,P){return"string"===typeof p?{url:p,...P}:p};da.getField=function(p){return this.fieldsIndex.get(p)};
da.getFieldDomain=function(p,P){var W,fa,ma,na;return(P=null==(W=this.getFeatureType(null==P?void 0:P.feature))?void 0:null==(fa=W.domains)?void 0:fa[p])&&"inherited"!==P.type?P:null!=(ma=null==(na=this.getField(p))?void 0:na.domain)?ma:null};da.getFeatureType=function(p){return p&&u.isSome(this.associatedLayer)?this.associatedLayer.getFeatureType(p):null};da.readNodePages=function(p,P,W){"Point"===P.layerType&&(p=P.pointNodePages);return null==p||"object"!==typeof p?null:ja.I3SNodePageDefinition.fromJSON(p,
W)};da.readCachedDrawingInfo=function(p){if(null==p||"object"!==typeof p)p={};null==p.color&&(p.color=!1);return p};da.readObjectIdField=function(p,P){!p&&P.fields&&P.fields.some(W=>{"esriFieldTypeOID"===W.type&&(p=W.name);return!!p});return p||void 0};da.readGlobalIdField=function(p,P){!p&&P.fields&&P.fields.some(W=>{"esriFieldTypeGlobalID"===W.type&&(p=W.name);return!!p});return p||void 0};da.readProfile=function(p,P){p=P.store.profile;if(null!=p&&ra[p])return ra[p];ia.error("Unknown or missing profile",
{profile:p,layer:this});return"mesh-pyramids"};da.load=function(p){const P=u.isSome(p)?p.signal:null,W=this.loadFromPortal({supportedTypes:["Scene Service"]},p).catch(D.throwIfAbortError).then(()=>this._fetchService(P)).then(()=>Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,P),this._setAssociatedFeatureLayer(P)])).then(()=>this._validateElevationInfo()).then(()=>this._applyAssociatedLayerOverrides()).then(()=>this._populateFieldUsageInfo()).then(()=>C.loadStyleRenderer(this,{origin:"service"},
P)).then(()=>oa.fixRendererFields(this.renderer,this.fieldsIndex)).then(()=>this.finishLoadEditablePortalLayer(p));this.addResolvingPromise(W);return Promise.resolve(this)};da.createQuery=function(){const p=new F;"mesh"!==this.geometryType&&(p.returnGeometry=!0,p.returnZ=!0);p.where=this.definitionExpression||"1\x3d1";p.sqlFormat="standard";return p};da.queryExtent=function(p,P){return this._getAssociatedLayerForQuery().then(W=>W.queryExtent(p||this.createQuery(),P))};da.queryFeatureCount=function(p,
P){return this._getAssociatedLayerForQuery().then(W=>W.queryFeatureCount(p||this.createQuery(),P))};da.queryFeatures=function(p,P){return this._getAssociatedLayerForQuery().then(W=>W.queryFeatures(p||this.createQuery(),P)).then(W=>{if(null!=W&&W.features)for(const fa of W.features)fa.layer=this,fa.sourceLayer=this;return W})};da.queryObjectIds=function(p,P){return this._getAssociatedLayerForQuery().then(W=>W.queryObjectIds(p||this.createQuery(),P))};da.queryAttachments=function(p,P){return this._getAssociatedLayerForQuery().then(W=>
W.queryAttachments(p,P))};da.getFieldUsageInfo=function(p){const P={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[p]||P:(ia.error("#getFieldUsageInfo()","Unavailable until layer is loaded"),P)};da.createPopupTemplate=function(p){return L.createPopupTemplate(this,p)};da._getAssociatedLayerForQuery=function(){const p=this.associatedLayer;return u.isSome(p)&&p.loaded?Promise.resolve(p):this._loadAssociatedLayerForQuery()};
da._loadAssociatedLayerForQuery=function(){var p=b._asyncToGenerator(function*(){yield this.load();if(u.isNone(this.associatedLayer))throw new H("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});try{yield this.associatedLayer.load()}catch(P){throw new H("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:this,error:P});}return this.associatedLayer});return function(){return p.apply(this,
arguments)}}();da.hasCachedStatistics=function(p){return null!=this.statisticsInfo&&this.statisticsInfo.some(P=>P.name===p)};da.queryCachedStatistics=function(){var p=b._asyncToGenerator(function*(P,W){yield this.load(W);if(!this.statisticsInfo)throw new H("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const fa=this.fieldsIndex.get(P);if(!fa)throw new H("scenelayer:field-unexisting",`Field '${P}' does not exist on the layer`);for(const ma of this.statisticsInfo)if(ma.name===
fa.name)return P=K.join(this.parsedUrl.path,ma.href),x(P,{query:{f:"json",token:this.apiKey},responseType:"json",signal:W?W.signal:null}).then(na=>na.data);throw new H("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available");});return function(P,W){return p.apply(this,arguments)}}();da.saveAs=function(){var p=b._asyncToGenerator(function*(P,W){return this._debouncedSaveOperations(B.SaveOperationType.SAVE_AS,{...W,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"},
P)});return function(P,W){return p.apply(this,arguments)}}();da.save=function(){var p=b._asyncToGenerator(function*(){return this._debouncedSaveOperations(B.SaveOperationType.SAVE,{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"})});return function(){return p.apply(this,arguments)}}();da.applyEdits=function(){var p=b._asyncToGenerator(function*(P,W){const fa=yield new Promise((ma,na)=>d(["./graphics/editingSupport"],ma,na));yield this.load();if(u.isNone(this.associatedLayer))throw new H(`${this.type}-layer:not-editable`,
"Service is not editable");yield this.associatedLayer.load();return fa.applyEdits(this,this.associatedLayer.source,P,W)});return function(P,W){return p.apply(this,arguments)}}();da.on=function(p,P){return la.prototype.on.call(this,p,P)};da.validateLayer=function(p){if(p.layerType&&-1===ha.indexOf(p.layerType))throw new H("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:p.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new H("layer:service-version-not-supported",
"Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(2<this.version.major)throw new H("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});{p=this.normalReferenceFrame;var P=this.spatialReference;let W=!1,fa=!1;if(null==p)fa=W=!0;else switch(P=P&&P.isGeographic,p){case "east-north-up":case "earth-centered":W=!0;fa=P;break;case "vertex-reference-frame":W=!0;
fa=!P;break;default:W=!1}if(!W)throw new H("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!fa)throw new H("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");}};da._getTypeKeywords=function(){const p=[];if("points"===this.profile)p.push("Point");else if("mesh-pyramids"===this.profile)p.push("3DObject");else throw new H("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+
this.profile);return p};da._populateFieldUsageInfo=function(){this._fieldUsageInfo={};if(this.fields)for(const p of this.fields){const P=!(!this.attributeStorageInfo||!this.attributeStorageInfo.some(fa=>fa.name===p.name)),W=!!(u.isSome(this.associatedLayer)&&this.associatedLayer.fields&&this.associatedLayer.fields.some(fa=>fa&&p.name===fa.name));this._fieldUsageInfo[p.name]={supportsLabelingInfo:P,supportsRenderer:P,supportsPopupTemplate:P||W,supportsLayerQuery:W}}};da._applyAssociatedLayerOverrides=
function(){this._applyAssociatedLayerFieldsOverrides();this._applyAssociatedLayerPopupOverrides()};da._applyAssociatedLayerFieldsOverrides=function(){if(!u.isNone(this.associatedLayer)&&this.associatedLayer.fields){var p=null;for(const P of this.associatedLayer.fields){const W=this.getField(P.name);W?(!W.domain&&P.domain&&(W.domain=P.domain.clone()),W.editable=P.editable,W.nullable=P.nullable,W.length=P.length):(p||(p=this.fields?this.fields.slice():[]),p.push(P.clone()))}p&&this._set("fields",p)}};
da._applyAssociatedLayerPopupOverrides=function(){if(!u.isNone(this.associatedLayer)){var p=["popupTemplate","popupEnabled"],P=I.getProperties(this);for(let W=0;W<p.length;W++){const fa=p[W],ma=this.originIdOf(fa),na=this.associatedLayer.originIdOf(fa);ma<na&&(na===R.OriginId.SERVICE||na===R.OriginId.PORTAL_ITEM)&&P.setAtOrigin(fa,this.associatedLayer[fa],na)}}};da._setAssociatedFeatureLayer=function(){var p=b._asyncToGenerator(function*(P){if(-1!==["mesh-pyramids","points"].indexOf(this.profile)){P=
new ka.FetchAssociatedFeatureLayer(this.parsedUrl,this.portalItem,this.apiKey,P);try{this.associatedLayer=yield P.fetch()}catch(W){D.isAbortError(W)||this._logWarningOnPopupEnabled()}}});return function(P){return p.apply(this,arguments)}}();da._logWarningOnPopupEnabled=function(){var p=b._asyncToGenerator(function*(){yield Q.whenOnce(()=>this.popupEnabled&&null!=this.popupTemplate);const P=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?ia.warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${P}`):
ia.info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${P}`)});return function(){return p.apply(this,arguments)}}();da._validateElevationInfo=function(){const p=this.elevationInfo;p&&("mesh-pyramids"===this.profile&&"absolute-height"!==p.mode&&ia.warn(".elevationInfo\x3d","Mesh scene layers only support absolute-height elevation mode"),p.featureExpressionInfo&&"0"!==p.featureExpressionInfo.expression&&ia.warn(".elevationInfo\x3d","Scene layers do not support featureExpressionInfo"))};
b._createClass(sa,[{key:"types",get:function(){return u.isSome(this.associatedLayer)?this.associatedLayer.types:[]}},{key:"typeIdField",get:function(){return u.isSome(this.associatedLayer)?this.associatedLayer.typeIdField:null}},{key:"formTemplate",get:function(){return u.isSome(this.associatedLayer)?this.associatedLayer.formTemplate:null}},{key:"fieldsIndex",get:function(){return new qa(this.fields)}},{key:"elevationInfo",set:function(p){this._set("elevationInfo",p);this.loaded&&this._validateElevationInfo()}},
{key:"geometryType",get:function(){return wa[this.profile]||"mesh"}},{key:"renderer",set:function(p){oa.fixRendererFields(p,this.fieldsIndex);this._set("renderer",p)}},{key:"capabilities",get:function(){var p=u.isSome(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:V.zeroCapabilities;const {query:P,editing:{supportsGlobalId:W,supportsRollbackOnFailure:fa,supportsUploadWithItemId:ma,supportsReturnServiceEditsInSourceSpatialReference:na},data:{supportsZ:ua,
supportsM:ta,isVersioned:va,supportsAttachment:xa},operations:{supportsEditing:ya,supportsUpdate:za,supportsQuery:Aa,supportsQueryAttachments:Ba}}=p;p=p.operations.supportsChangeTracking;return{query:P,editing:{supportsGlobalId:W,supportsReturnServiceEditsInSourceSpatialReference:na,supportsRollbackOnFailure:fa,supportsGeometryUpdate:!1,supportsUploadWithItemId:ma},data:{supportsAttachment:xa,supportsZ:ua,supportsM:ta,isVersioned:va},operations:{supportsQuery:Aa,supportsQueryAttachments:Ba,supportsEditing:ya&&
p,supportsAdd:!1,supportsDelete:!1,supportsUpdate:za&&p}}}},{key:"editingEnabled",get:function(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.userHasEditingPrivileges},set:function(p){null!=p?this._override("editingEnabled",p):this._clearOverride("editingEnabled")}},{key:"defaultPopupTemplate",get:function(){return u.isSome(this.associatedLayer)||this.attributeStorageInfo?this.createPopupTemplate():null}},{key:"displayField",get:function(){return u.isSome(this.associatedLayer)?
this.associatedLayer.displayField:null}}]);return sa}(B.SceneService(O.ArcGISService(T.OperationalLayer(n.PortalLayer(g.ScaleRangeLayer(A.MultiOriginJSONMixin(M.APIKeyMixin(w))))))));a.__decorate([y.property({types:{key:"type",base:ba.default,typeMap:{selection:aa}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],A.prototype,"featureReduction",void 0);a.__decorate([y.property({type:[t.default],json:{read:!1,
origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],A.prototype,"rangeInfos",void 0);a.__decorate([y.property({json:{read:!1}})],A.prototype,"associatedLayer",void 0);a.__decorate([y.property({type:["show","hide"]})],A.prototype,"listMode",void 0);a.__decorate([y.property({type:["ArcGISSceneServiceLayer"]})],A.prototype,"operationalLayerType",void 0);a.__decorate([y.property({json:{read:!1},readOnly:!0})],A.prototype,"type",
void 0);a.__decorate([y.property({...h.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],A.prototype,"fields",void 0);a.__decorate([y.property()],A.prototype,"types",null);a.__decorate([y.property()],A.prototype,"typeIdField",null);a.__decorate([y.property()],A.prototype,"formTemplate",null);a.__decorate([y.property({readOnly:!0})],A.prototype,"fieldsIndex",null);a.__decorate([y.property({type:c,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],
A.prototype,"floorInfo",void 0);a.__decorate([y.property(h.outFields)],A.prototype,"outFields",void 0);a.__decorate([y.property({type:ja.I3SNodePageDefinition,readOnly:!0,json:{read:!1}})],A.prototype,"nodePages",void 0);a.__decorate([z.reader("service","nodePages",["nodePages","pointNodePages"])],A.prototype,"readNodePages",null);a.__decorate([y.property({type:[ja.I3SMaterialDefinition],readOnly:!0})],A.prototype,"materialDefinitions",void 0);a.__decorate([y.property({type:[ja.I3STextureSetDefinition],
readOnly:!0})],A.prototype,"textureSetDefinitions",void 0);a.__decorate([y.property({type:[ja.I3SGeometryDefinition],readOnly:!0})],A.prototype,"geometryDefinitions",void 0);a.__decorate([y.property({readOnly:!0})],A.prototype,"serviceUpdateTimeStamp",void 0);a.__decorate([y.property({readOnly:!0})],A.prototype,"attributeStorageInfo",void 0);a.__decorate([y.property({readOnly:!0})],A.prototype,"statisticsInfo",void 0);a.__decorate([y.property({type:E.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,
write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],A.prototype,"excludeObjectIds",void 0);a.__decorate([y.property({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],A.prototype,"definitionExpression",void 0);a.__decorate([y.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],A.prototype,"path",void 0);a.__decorate([y.property(X.elevationInfo)],A.prototype,"elevationInfo",
null);a.__decorate([y.property({type:String})],A.prototype,"geometryType",null);a.__decorate([y.property(X.labelsVisible)],A.prototype,"labelsVisible",void 0);a.__decorate([y.property({type:[ea],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:U.reader},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:U.reader},write:!0}})],A.prototype,"labelingInfo",void 0);a.__decorate([y.property(X.legendEnabled)],A.prototype,"legendEnabled",void 0);a.__decorate([y.property({type:Number,
json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(la,sa){var da,p;if("number"===typeof la&&0<=la&&1>=la)return la;la=null==(da=sa.layerDefinition)?void 0:null==(p=da.drawingInfo)?void 0:p.transparency;return void 0!==la?Z.transparencyToOpacity(la):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],A.prototype,"opacity",
void 0);a.__decorate([y.property({types:k.webSceneRendererTypes,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],A.prototype,"renderer",null);a.__decorate([y.property({json:{read:!1}})],A.prototype,"cachedDrawingInfo",void 0);a.__decorate([z.reader("service","cachedDrawingInfo")],A.prototype,"readCachedDrawingInfo",null);a.__decorate([y.property({readOnly:!0,json:{read:!1}})],A.prototype,"capabilities",null);a.__decorate([y.property({type:Boolean,
json:{read:!1}})],A.prototype,"editingEnabled",null);a.__decorate([y.property(X.popupEnabled)],A.prototype,"popupEnabled",void 0);a.__decorate([y.property({type:v,json:{name:"popupInfo",write:!0}})],A.prototype,"popupTemplate",void 0);a.__decorate([y.property({readOnly:!0,json:{read:!1}})],A.prototype,"defaultPopupTemplate",null);a.__decorate([y.property({type:String,json:{read:!1}})],A.prototype,"objectIdField",void 0);a.__decorate([z.reader("service","objectIdField",["objectIdField","fields"])],
A.prototype,"readObjectIdField",null);a.__decorate([y.property({type:String,json:{read:!1}})],A.prototype,"globalIdField",void 0);a.__decorate([z.reader("service","globalIdField",["globalIdField","fields"])],A.prototype,"readGlobalIdField",null);a.__decorate([y.property({readOnly:!0,type:String,json:{read:!1}})],A.prototype,"displayField",null);a.__decorate([y.property({type:String,json:{read:!1}})],A.prototype,"profile",void 0);a.__decorate([z.reader("service","profile",["store.profile"])],A.prototype,
"readProfile",null);a.__decorate([y.property({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],A.prototype,"normalReferenceFrame",void 0);a.__decorate([y.property(X.screenSizePerspectiveEnabled)],A.prototype,"screenSizePerspectiveEnabled",void 0);A=a.__decorate([r.subclass("esri.layers.SceneLayer")],A);const ra={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",
lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},wa={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return A})},"esri/layers/mixins/SceneService":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Error ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/originUtils ../../geometry/Extent ../../geometry/HeightModelInfo ../../geometry/SpatialReference ../support/arcgisLayerUrl ../support/commonProperties ../support/I3SIndexInfo ../../portal/Portal ../../portal/PortalItem ../../webdoc/support/saveUtils".split(" "),
function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q,K,y,Y,ca,I,m){const z=J.getLogger("esri.layers.mixins.SceneService");var r;(function(w){w[w.existingItem=0]="existingItem";w[w.newItem=1]="newItem"})(r||(r={}));const R={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};b.SaveOperationType=void 0;(function(w){w[w.SAVE=0]="SAVE";w[w.SAVE_AS=1]="SAVE_AS"})(b.SaveOperationType||(b.SaveOperationType={}));b.SCENE_SERVICE_ITEM_TYPE=
"Scene Service";b.SceneService=w=>{w=function(M){function O(){var n=M.apply(this,arguments)||this;n.spatialReference=null;n.fullExtent=null;n.heightModelInfo=null;n.minScale=0;n.maxScale=0;n.version={major:Number.NaN,minor:Number.NaN,versionString:""};n.copyright=null;n.sublayerTitleMode="item-title";n.title=null;n.layerId=null;n.indexInfo=null;n._debouncedSaveOperations=l.debounce(function(){var g=a._asyncToGenerator(function*(B,V,X){switch(B){case b.SaveOperationType.SAVE:return n._save(V);case b.SaveOperationType.SAVE_AS:return n._saveAs(X,
V)}});return function(B,V,X){return g.apply(this,arguments)}}());return n}a._inheritsLoose(O,M);var T=O.prototype;T.readSpatialReference=function(n,g){return this._readSpatialReference(g)};T._readSpatialReference=function(n){if(null!=n.spatialReference)return Q.fromJSON(n.spatialReference);n=n.store;n=(n=n.indexCRS||n.geographicCRS)&&parseInt(n.substring(n.lastIndexOf("/")+1,n.length),10);return null!=n?new Q(n):null};T.readFullExtent=function(n,g,B){if(null!=n&&"object"===typeof n)return g=null==
n.spatialReference?{...n,spatialReference:this._readSpatialReference(g)}:n,A.fromJSON(g,B);B=g.store;g=this._readSpatialReference(g);return null==g||null==B||null==B.extent||!Array.isArray(B.extent)||B.extent.some(V=>-1E38>V)?null:new A({xmin:B.extent[0],ymin:B.extent[1],xmax:B.extent[2],ymax:B.extent[3],spatialReference:g})};T.parseVersionString=function(n){const g={major:Number.NaN,minor:Number.NaN,versionString:n};n=n.split(".");2<=n.length&&(g.major=parseInt(n[0],10),g.minor=parseInt(n[1],10));
return g};T.readVersion=function(n,g){n=g.store;return this.parseVersionString(null!=n.version?n.version.toString():"")};T.readTitlePortalItem=function(n){return"item-title"!==this.sublayerTitleMode?void 0:n};T.readTitleService=function(n,g){n=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return K.titleFromUrlAndName(this.url,g.name);g=g.name;if(!g&&this.url){const B=K.parse(this.url);q.isSome(B)&&(g=B.title)}"item-title-and-service-name"===this.sublayerTitleMode&&
n&&(g=n+" - "+g);return K.cleanTitle(g)};T.writeUrl=function(n,g,B,V){K.writeUrlWithLayerId(this,n,"layers",g,V)};T._fetchIndexAndUpdateExtent=function(){var n=a._asyncToGenerator(function*(g,B){this.indexInfo=Y.fetchIndexInfo(this.parsedUrl.path,this.rootNode,g,this.apiKey,z,B);null==this.fullExtent||this.fullExtent.hasZ||this._updateExtent(yield this.indexInfo)});return function(g,B){return n.apply(this,arguments)}}();T._updateExtent=function(n){if("page"===(null==n?void 0:n.type)){var g,B,V=n.rootIndex%
n.pageSize;n=null==(g=n.rootPage)?void 0:null==(B=g.nodes)?void 0:B[V];if(null==n||null==n.obb||null==n.obb.center||null==n.obb.halfSize)throw new S("sceneservice:invalid-node-page","Invalid node page.");-1E38>n.obb.center[0]||null==this.fullExtent||this.fullExtent.hasZ||(g=n.obb.halfSize,B=n.obb.center[2],g=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]),this.fullExtent.zmin=B-g,this.fullExtent.zmax=B+g)}else"node"===(null==n?void 0:n.type)&&(B=null==(V=n.rootNode)?void 0:V.mbs,!Array.isArray(B)||4!==B.length||
-1E38>B[0]||(g=B[2],B=B[3],this.fullExtent.zmin=g-B,this.fullExtent.zmax=g+B))};T._fetchService=function(){var n=a._asyncToGenerator(function*(g){if(null==this.url)throw new S("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==this.layerId&&/SceneServer\/*$/i.test(this.url)){const B=yield this._fetchFirstLayerId(g);null!=B&&(this.layerId=B)}return this._fetchServiceLayer(g)});return function(g){return n.apply(this,arguments)}}();T._fetchFirstLayerId=
function(){var n=a._asyncToGenerator(function*(g){g=yield h(this.url,{query:{f:"json",token:this.apiKey},responseType:"json",signal:g});if(g.data&&Array.isArray(g.data.layers)&&0<g.data.layers.length)return g.data.layers[0].id});return function(g){return n.apply(this,arguments)}}();T._fetchServiceLayer=function(){var n=a._asyncToGenerator(function*(g){g=yield h(this.parsedUrl.path,{query:{f:"json",token:this.apiKey},responseType:"json",signal:g});g.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));
let B=!1;g.data.layerType&&"Voxel"===g.data.layerType&&(B=!0);if(B)return this._fetchVoxelServiceLayer();g=g.data;this.read(g,{origin:"service",url:this.parsedUrl});this.validateLayer(g)});return function(g){return n.apply(this,arguments)}}();T._fetchVoxelServiceLayer=function(){var n=a._asyncToGenerator(function*(g){g=(yield h(this.parsedUrl.path+"/layer",{query:{f:"json",token:this.apiKey},responseType:"json",signal:g})).data;this.read(g,{origin:"service",url:this.parsedUrl});this.validateLayer(g)});
return function(g){return n.apply(this,arguments)}}();T._ensureLoadBeforeSave=function(){var n=a._asyncToGenerator(function*(){yield this.load();"beforeSave"in this&&"function"===typeof this.beforeSave&&(yield this.beforeSave())});return function(){return n.apply(this,arguments)}}();T.validateLayer=function(n){};T._updateTypeKeywords=function(n,g,B){n.typeKeywords||(n.typeKeywords=[]);g=g.getTypeKeywords();for(const V of g)n.typeKeywords.push(V);n.typeKeywords&&(n.typeKeywords=n.typeKeywords.filter((V,
X,ba)=>ba.indexOf(V)===X),B===r.newItem&&(n.typeKeywords=n.typeKeywords.filter(V=>"Hosted Service"!==V)))};T._saveAs=function(){var n=a._asyncToGenerator(function*(g,B){B={...R,...B};g=I.from(g);g||(z.error("_saveAs(): requires a portal item parameter"),yield Promise.reject(new S("sceneservice:portal-item-required","_saveAs() requires a portal item to save to")));g.id&&(g=g.clone(),g.id=null);const V=g.portal||ca.getDefault();yield this._ensureLoadBeforeSave();g.type="Scene Service";g.portal=V;const X=
{origin:"portal-item",url:null,messages:[],portal:V,portalItem:g,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},ba={layers:[this.write({},X)]};yield Promise.all(X.resources.pendingOperations);yield this._validateAgainstJSONSchema(ba,X,B);g.url=this.url;g.title||(g.title=this.title);this._updateTypeKeywords(g,B,r.newItem);yield V._signIn();yield V.user.addItem({item:g,folder:B&&B.folder,data:ba});yield m.saveResources(this.resourceReferences,
X,null);this.portalItem=g;u.updateOrigins(X);return X.portalItem=g});return function(g,B){return n.apply(this,arguments)}}();T._save=function(){var n=a._asyncToGenerator(function*(g){g={...R,...g};this.portalItem||(z.error("_save(): requires the .portalItem property to be set"),yield Promise.reject(new S("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService")));"Scene Service"!==this.portalItem.type&&(z.error("_save(): Non-matching portal item type. Got "+
this.portalItem.type+", expected Scene Service"),yield Promise.reject(new S("sceneservice:portal-item-wrong-type",'Portal item needs to have type "Scene Service"')));yield this._ensureLoadBeforeSave();const B={origin:"portal-item",url:this.portalItem.itemUrl&&f.urlToObject(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||ca.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},V={layers:[this.write({},
B)]};yield Promise.all(B.resources.pendingOperations);yield this._validateAgainstJSONSchema(V,B,g);this.portalItem.url=this.url;this.portalItem.title||(this.portalItem.title=this.title);this._updateTypeKeywords(this.portalItem,g,r.existingItem);yield this.portalItem.update({data:V});yield m.saveResources(this.resourceReferences,B,null);u.updateOrigins(B);return this.portalItem});return function(g){return n.apply(this,arguments)}}();T._validateAgainstJSONSchema=function(){var n=a._asyncToGenerator(function*(g,
B,V){B=B.messages.filter(X=>"error"===X.type).map(X=>new S(X.name,X.message,X.details));V&&V.validationOptions.ignoreUnsupported&&(B=B.filter(X=>"layer:unsupported"!==X.name&&"symbol:unsupported"!==X.name&&"symbol-layer:unsupported"!==X.name&&"property:unsupported"!==X.name&&"url:unsupported"!==X.name&&"scenemodification:unsupported"!==X.name));if(V.validationOptions.enabled&&(g=(yield new Promise((X,ba)=>d(["../support/schemaValidator"],X,ba))).validate(g,V.portalItemLayerType),0<g.length)){const X=
`Layer item did not validate:\n${g.join("\n")}`;z.error(`_validateAgainstJSONSchema(): ${X}`);if("throw"===V.validationOptions.failPolicy)throw V=g.map(ba=>new S("sceneservice:schema-validation",ba)).concat(B),new S("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:V});}if(0<B.length)throw new S("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",
{errors:B});});return function(g,B,V){return n.apply(this,arguments)}}();a._createClass(O,[{key:"url",set:function(n){n=K.sanitizeUrlWithLayerId({layer:this,url:n,nonStandardUrlAllowed:!1,logger:z});this._set("url",n.url);null!=n.layerId&&this._set("layerId",n.layerId)}},{key:"parsedUrl",get:function(){var n=this._get("url");if(!n)return null;n=f.urlToObject(n);null!=this.layerId&&(n.path=`${n.path}/layers/${this.layerId}`);return n}}]);return O}(w);v.__decorate([e.property(y.id)],w.prototype,"id",
void 0);v.__decorate([e.property({type:Q})],w.prototype,"spatialReference",void 0);v.__decorate([E.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],w.prototype,"readSpatialReference",null);v.__decorate([e.property({type:A})],w.prototype,"fullExtent",void 0);v.__decorate([E.reader("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],w.prototype,"readFullExtent",null);v.__decorate([e.property({readOnly:!0,type:D})],
w.prototype,"heightModelInfo",void 0);v.__decorate([e.property({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],w.prototype,"minScale",void 0);v.__decorate([e.property({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],w.prototype,"maxScale",void 0);v.__decorate([e.property({readOnly:!0})],w.prototype,"version",void 0);v.__decorate([E.reader("version",["store.version"])],
w.prototype,"readVersion",null);v.__decorate([e.property({type:String,json:{read:{source:"copyrightText"}}})],w.prototype,"copyright",void 0);v.__decorate([e.property({type:String,json:{read:!1}})],w.prototype,"sublayerTitleMode",void 0);v.__decorate([e.property({type:String})],w.prototype,"title",void 0);v.__decorate([E.reader("portal-item","title")],w.prototype,"readTitlePortalItem",null);v.__decorate([E.reader("service","title",["name"])],w.prototype,"readTitleService",null);v.__decorate([e.property({type:Number,
json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],w.prototype,"layerId",void 0);v.__decorate([e.property(y.url)],w.prototype,"url",null);v.__decorate([N.writer("url")],w.prototype,"writeUrl",null);v.__decorate([e.property()],w.prototype,"parsedUrl",null);v.__decorate([e.property({readOnly:!0})],w.prototype,"store",void 0);v.__decorate([e.property({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],w.prototype,"rootNode",
void 0);return w=v.__decorate([H.subclass("esri.layers.mixins.SceneService")],w)};Object.defineProperty(b,"__esModule",{value:!0})})},"esri/layers/support/I3SIndexInfo":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/maybe"],function(d,b,a,v,h){function S(){S=b._asyncToGenerator(function*(G,J,q,l,f,e){var k=null;if(h.isSome(q)){k=`${G}/nodepages/`;const x=k+Math.floor(q.rootIndex/q.nodesPerPage);try{return{type:"page",rootPage:(yield a(x,
{query:{f:"json",token:l},responseType:"json",signal:e})).data,rootIndex:q.rootIndex,pageSize:q.nodesPerPage,lodMetric:q.lodSelectionMetricType,urlPrefix:k}}catch(E){h.isSome(f)&&f.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",x,E),k=E}}if(!J)return null;J=J&&J.split("/").pop();G=`${G}/nodes/`;J=G+J;try{return{type:"node",rootNode:(yield a(J,{query:{f:"json",token:l},responseType:"json",signal:e})).data,urlPrefix:G}}catch(x){throw new v("sceneservice:root-node-missing",
"Root node missing.",{pageError:k,nodeError:x,url:J});}});return S.apply(this,arguments)}d.fetchIndexInfo=function(G,J,q,l,f,e){return S.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0})})},"esri/layers/support/capabilities":function(){define(["exports"],function(d){d.zeroCapabilities={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,
supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,
supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,
supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};
Object.defineProperty(d,"__esModule",{value:!0})})},"esri/layers/support/FetchAssociatedFeatureLayer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../kernel ../../request ../../core/maybe ../../core/promiseUtils ../FeatureLayer ../../portal/Portal ../../portal/PortalItem".split(" "),function(d,b,a,v,h,S,G,J,q){let l=function(){function f(k,x,E,H){this.parsedUrl=k;this.portalItem=x;this.apiKey=E;this.signal=H;this.rootDocument=null;if(k=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i))this.urlParts=
{root:k[1],layerId:parseInt(k[2],10)}}var e=f.prototype;e.fetch=function(){var k=b._asyncToGenerator(function*(){var x;if(!this.urlParts)return null;const E=null!=(x=this.portalItem)?x:yield this._portalItemFromServiceItemId();if(h.isNone(E))return this._loadFromUrl();x=yield this._findAndLoadRelatedPortalItem(E);return h.isNone(x)?null:this._loadFeatureLayerFromPortalItem(x)});return function(){return k.apply(this,arguments)}}();e.fetchPortalItem=function(){var k=b._asyncToGenerator(function*(){var x;
if(!this.urlParts)return null;const E=null!=(x=this.portalItem)?x:yield this._portalItemFromServiceItemId();return h.isNone(E)?null:this._findAndLoadRelatedPortalItem(E)});return function(){return k.apply(this,arguments)}}();e._fetchRootDocument=function(){var k=b._asyncToGenerator(function*(){if(h.isSome(this.rootDocument))return this.rootDocument;if(h.isNone(this.urlParts))return this.rootDocument={},{};const x={query:{f:"json",token:this.apiKey},responseType:"json",signal:this.signal},E=`${this.urlParts.root}/SceneServer`;
try{this.rootDocument=(yield v(E,x)).data}catch{this.rootDocument={}}return this.rootDocument});return function(){return k.apply(this,arguments)}}();e._fetchServiceOwningPortalUrl=function(){var k=b._asyncToGenerator(function*(){var x;const E=null==(x=a.id)?void 0:x.findServerInfo(this.parsedUrl.path);if(null!=E&&E.owningSystemUrl)return E.owningSystemUrl;x=this.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const H=(yield v(x,{query:{f:"json"},responseType:"json",signal:this.signal})).data.owningSystemUrl;
if(H)return H}catch(H){S.throwIfAbortError(H)}return null});return function(){return k.apply(this,arguments)}}();e._findAndLoadRelatedPortalItem=function(){var k=b._asyncToGenerator(function*(x){try{return(yield x.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:this.signal})).find(E=>"Feature Service"===E.type)||null}catch(E){return S.throwIfAbortError(E),null}});return function(x){return k.apply(this,arguments)}}();e._loadFeatureLayerFromPortalItem=function(){var k=
b._asyncToGenerator(function*(x){yield x.load({signal:this.signal});const E=yield this._findMatchingAssociatedSublayerUrl(x.url);return(new G({url:E,portalItem:x})).load({signal:this.signal})});return function(x){return k.apply(this,arguments)}}();e._loadFromUrl=function(){var k=b._asyncToGenerator(function*(){const x=yield this._findMatchingAssociatedSublayerUrl(`${this.urlParts.root}/FeatureServer`);return(new G({url:x})).load({signal:this.signal})});return function(){return k.apply(this,arguments)}}();
e._findMatchingAssociatedSublayerUrl=function(){var k=b._asyncToGenerator(function*(x){x=x.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");var E={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal};const H=this.urlParts.layerId;var N=this._fetchRootDocument();E=v(x,E);const [u,A]=yield Promise.all([E,N]);N=A&&A.layers;E=u.data&&u.data.layers;if(!Array.isArray(E))throw Error("expected layers array");if(!Array.isArray(N)){if(H<E.length)return`${x}/${E[H].id}`}else for(let D=
0;D<Math.min(N.length,E.length);D++)if(N[D].id===H)return`${x}/${E[D].id}`;throw Error("could not find matching associated sublayer");});return function(x){return k.apply(this,arguments)}}();e._portalItemFromServiceItemId=function(){var k=b._asyncToGenerator(function*(){var x=(yield this._fetchRootDocument()).serviceItemId;if(!x)return null;x=new q({id:x,apiKey:this.apiKey});const E=yield this._fetchServiceOwningPortalUrl();h.isSome(E)&&(x.portal=new J({url:E}));try{return x.load({signal:this.signal})}catch(H){return S.throwIfAbortError(H),
null}});return function(){return k.apply(this,arguments)}}();return f}();d.FetchAssociatedFeatureLayer=l;Object.defineProperty(d,"__esModule",{value:!0})})},"esri/layers/support/I3SLayerDefinitions":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,v,h,S,G,J,q,l){d.I3SNodePageDefinition=function(f){function e(){var k=f.apply(this,arguments)||this;k.nodesPerPage=null;k.rootIndex=0;k.lodSelectionMetricType=null;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:Number})],d.I3SNodePageDefinition.prototype,"nodesPerPage",void 0);a.__decorate([h.property({type:Number})],d.I3SNodePageDefinition.prototype,"rootIndex",void 0);a.__decorate([h.property({type:String})],d.I3SNodePageDefinition.prototype,
"lodSelectionMetricType",void 0);d.I3SNodePageDefinition=a.__decorate([l.subclass("esri.layer.support.I3SNodePageDefinition")],d.I3SNodePageDefinition);d.I3SMaterialTexture=function(f){function e(){var k=f.apply(this,arguments)||this;k.factor=1;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],d.I3SMaterialTexture.prototype,"id",void 0);a.__decorate([h.property({type:Number})],d.I3SMaterialTexture.prototype,
"factor",void 0);d.I3SMaterialTexture=a.__decorate([l.subclass("esri.layer.support.I3SMaterialTexture")],d.I3SMaterialTexture);d.I3SMaterialPBRMetallicRoughness=function(f){function e(){var k=f.apply(this,arguments)||this;k.baseColorFactor=[1,1,1,1];k.baseColorTexture=null;k.metallicRoughnessTexture=null;k.metallicFactor=1;k.roughnessFactor=1;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:[Number]})],d.I3SMaterialPBRMetallicRoughness.prototype,"baseColorFactor",
void 0);a.__decorate([h.property({type:d.I3SMaterialTexture})],d.I3SMaterialPBRMetallicRoughness.prototype,"baseColorTexture",void 0);a.__decorate([h.property({type:d.I3SMaterialTexture})],d.I3SMaterialPBRMetallicRoughness.prototype,"metallicRoughnessTexture",void 0);a.__decorate([h.property({type:Number})],d.I3SMaterialPBRMetallicRoughness.prototype,"metallicFactor",void 0);a.__decorate([h.property({type:Number})],d.I3SMaterialPBRMetallicRoughness.prototype,"roughnessFactor",void 0);d.I3SMaterialPBRMetallicRoughness=
a.__decorate([l.subclass("esri.layer.support.I3SMaterialPBRMetallicRoughness")],d.I3SMaterialPBRMetallicRoughness);d.I3SMaterialDefinition=function(f){function e(){var k=f.apply(this,arguments)||this;k.alphaMode="opaque";k.alphaCutoff=.25;k.doubleSided=!1;k.cullFace="none";k.normalTexture=null;k.occlusionTexture=null;k.emissiveTexture=null;k.emissiveFactor=null;k.pbrMetallicRoughness=null;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([q.enumeration({opaque:"opaque",mask:"mask",
blend:"blend"})],d.I3SMaterialDefinition.prototype,"alphaMode",void 0);a.__decorate([h.property({type:Number})],d.I3SMaterialDefinition.prototype,"alphaCutoff",void 0);a.__decorate([h.property({type:Boolean})],d.I3SMaterialDefinition.prototype,"doubleSided",void 0);a.__decorate([q.enumeration({none:"none",back:"back",front:"front"})],d.I3SMaterialDefinition.prototype,"cullFace",void 0);a.__decorate([h.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"normalTexture",void 0);
a.__decorate([h.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"occlusionTexture",void 0);a.__decorate([h.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"emissiveTexture",void 0);a.__decorate([h.property({type:[Number]})],d.I3SMaterialDefinition.prototype,"emissiveFactor",void 0);a.__decorate([h.property({type:d.I3SMaterialPBRMetallicRoughness})],d.I3SMaterialDefinition.prototype,"pbrMetallicRoughness",void 0);d.I3SMaterialDefinition=a.__decorate([l.subclass("esri.layer.support.I3SMaterialDefinition")],
d.I3SMaterialDefinition);d.I3STextureFormat=function(f){function e(){return f.apply(this,arguments)||this}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:String,json:{read:{source:["name","index"],reader:(f,e)=>null!=f?f:`${e.index}`}}})],d.I3STextureFormat.prototype,"name",void 0);a.__decorate([q.enumeration({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],d.I3STextureFormat.prototype,"format",void 0);d.I3STextureFormat=a.__decorate([l.subclass("esri.layer.support.I3STextureFormat")],
d.I3STextureFormat);d.I3STextureSetDefinition=function(f){function e(){var k=f.apply(this,arguments)||this;k.atlas=!1;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:[d.I3STextureFormat]})],d.I3STextureSetDefinition.prototype,"formats",void 0);a.__decorate([h.property({type:Boolean})],d.I3STextureSetDefinition.prototype,"atlas",void 0);d.I3STextureSetDefinition=a.__decorate([l.subclass("esri.layer.support.I3STextureSetDefinition")],d.I3STextureSetDefinition);
d.I3SGeometryAttribute=function(f){function e(){return f.apply(this,arguments)||this}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([q.enumeration({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],d.I3SGeometryAttribute.prototype,"type",void 0);a.__decorate([h.property({type:Number})],d.I3SGeometryAttribute.prototype,"component",void 0);d.I3SGeometryAttribute=a.__decorate([l.subclass("esri.layer.support.I3SGeometryAttribute")],d.I3SGeometryAttribute);
d.I3SGeometryCompressedAttributes=function(f){function e(){return f.apply(this,arguments)||this}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([q.enumeration({draco:"draco"})],d.I3SGeometryCompressedAttributes.prototype,"encoding",void 0);a.__decorate([h.property({type:[String]})],d.I3SGeometryCompressedAttributes.prototype,"attributes",void 0);d.I3SGeometryCompressedAttributes=a.__decorate([l.subclass("esri.layer.support.I3SGeometryCompressedAttributes")],d.I3SGeometryCompressedAttributes);
d.I3SGeometryBuffer=function(f){function e(){var k=f.apply(this,arguments)||this;k.offset=0;return k}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([h.property({type:Number})],d.I3SGeometryBuffer.prototype,"offset",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"position",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"normal",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],
d.I3SGeometryBuffer.prototype,"uv0",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"color",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"uvRegion",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"featureId",void 0);a.__decorate([h.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"faceRange",void 0);a.__decorate([h.property({type:d.I3SGeometryCompressedAttributes})],
d.I3SGeometryBuffer.prototype,"compressedAttributes",void 0);d.I3SGeometryBuffer=a.__decorate([l.subclass("esri.layer.support.I3SGeometryBuffer")],d.I3SGeometryBuffer);d.I3SGeometryDefinition=function(f){function e(){return f.apply(this,arguments)||this}b._inheritsLoose(e,f);return e}(v.JSONSupport);a.__decorate([q.enumeration({triangle:"triangle"})],d.I3SGeometryDefinition.prototype,"topology",void 0);a.__decorate([h.property()],d.I3SGeometryDefinition.prototype,"geometryBuffers",void 0);d.I3SGeometryDefinition=
a.__decorate([l.subclass("esri.layer.support.I3SGeometryDefinition")],d.I3SGeometryDefinition);Object.defineProperty(d,"__esModule",{value:!0})})},"esri/layers/support/RangeInfo":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(d,b,a,v,h,S,G,J,q){d.RangeInfo=
function(l){function f(){var e=l.apply(this,arguments)||this;e.name=null;e.field=null;e.currentRangeExtent=null;e.fullRangeExtent=null;e.type="rangeInfo";return e}b._inheritsLoose(f,l);return f}(v.JSONSupport);a.__decorate([h.property({type:String,json:{read:!0,write:!0}})],d.RangeInfo.prototype,"name",void 0);a.__decorate([h.property({type:String,json:{read:!0,write:!0}})],d.RangeInfo.prototype,"field",void 0);a.__decorate([h.property({type:[Number],json:{read:!0,write:!0}})],d.RangeInfo.prototype,
"currentRangeExtent",void 0);a.__decorate([h.property({type:[Number],json:{read:!0,write:!0}})],d.RangeInfo.prototype,"fullRangeExtent",void 0);a.__decorate([h.property({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],d.RangeInfo.prototype,"type",void 0);d.RangeInfo=a.__decorate([q.subclass("esri.layers.support.RangeInfo")],d.RangeInfo);d.default=d.RangeInfo;Object.defineProperty(d,"__esModule",{value:!0})})},"widgets/Search/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils jimu/utils esri/request".split(" "),
function(d,b,a,v,h,S,G,J){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(q){this.map=q},setLayerInfosObj:function(q){this.layerInfosObj=q},setAppConfig:function(q){this.appConfig=q},getConfigInfo:function(q){if(q&&q.sources&&0<q.sources.length){var l=null;return this.searchLayer(this.map)&&q.upgradeFromGeocoder?(l=this.map.itemInfo.itemData.applicationProperties.viewing.search,l=b.map(l.layers,
d.hitch(this,function(f,e){e.hintText=f;return this._getQueryTypeGeocoder(e)},l.hintText)),h(l).then(d.hitch(this,function(f){q.sources=[].concat(f).concat(q.sources);return q}))):q}return v(this._getSoucesFromPortalAndWebmap()).then(d.hitch(this,function(f){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:f}}))},_getSoucesFromPortalAndWebmap:function(){var q=[],l=null;this.searchLayer(this.map)&&(l=this.map.itemInfo.itemData.applicationProperties.viewing.search,b.forEach(l.layers,d.hitch(this,
function(f,e){e.hintText=f;q.push(this._getQueryTypeGeocoder(e))},l.hintText)));return S.getPortalSelfInfo(this.appConfig.portalUrl).then(d.hitch(this,function(f){if((f=f.helperServices&&f.helperServices.geocode)&&0<f.length)for(var e=0,k=f.length;e<k;e++){var x=f[e];x&&q.push(this._processSingleLine(x))}return h(q).then(d.hitch(this,function(E){for(var H=[],N=0;N<E.length;N++){var u=E[N];u&&(u&&"query"===u.type?H.push(u):(u={name:u.name||this._getGeocodeName(u.url),url:u.url,singleLineFieldName:u.singleLineFieldName,
placeholder:u.placeholder||window.jimuNls.common.findAddressOrPlace||u.name||this._getGeocodeName(u.url),maxResults:6,searchInCurrentMapExtent:!1,type:"locator"},H.push(u)))}return H}))}))},_getQueryTypeGeocoder:function(q){var l=this.map.findLayerById(q.id),f=null,e=null;e=q.id;f=null;l&&l.allSublayers&&(f=l.allSublayers.find(function(k){return k.id===q.subLayer}));return l?(f="scene"===l.type?l.url+"/layers/"+l.layerId:f?f.url||l.url+"/"+q.subLayer:l.url+"/"+l.layerId,{name:l.title,layerId:e,url:f,
placeholder:q.hintText||window.jimuNls.common.findAddressOrPlace,searchFields:[q.field.name],displayField:q.field.name,exactMatch:q.field.exactMatch||!1,maxResults:6,searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(q){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(q)},_processSingleLine:function(q){if(q.singleLineFieldName)return q;if(this._isEsriLocator(q.url))return q.singleLineFieldName="SingleLine",q;var l=new a;J(q.url,{query:{f:"json"},handleAs:"json",
callbackParamName:"callback"}).then(d.hitch(this,function(f){f.singleLineAddressField&&f.singleLineAddressField.name?(q.singleLineFieldName=f.singleLineAddressField.name,l.resolve(q)):(console.warn(q.url+"has no singleLineFieldName"),l.resolve(null))}),d.hitch(this,function(f){console.error(f);l.resolve(null)}));return l.promise},_getGeocodeName:function(q){if("string"!==typeof q)return"geocoder";q=q.split("/");return q[q.length-2]||"geocoder"},getGeocoderName:function(q){return this._getGeocodeName(q)},
hasAppSearchInfo:function(q){return q.itemInfo&&q.itemInfo.itemData&&q.itemInfo.itemData.applicationProperties&&q.itemInfo.itemData.applicationProperties.viewing&&q.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(q){if(!q||!this.hasAppSearchInfo(q))return!1;q=q.itemInfo.itemData.applicationProperties.viewing.search;return q.enabled&&0!==q.layers.length?!0:!1}}})},"widgets/Search/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Search/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode" class\x3d"search-node"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchResultsNode" class\x3d"searchResults arcgisSearch esri-search"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Search/css/style.css":".jimu-widget-search{min-height: 32px;}.jimu-widget-search .search-node.default-width-for-openAtStart{width: 300px;}.jimu-widget-search .esri-search__container{border: 1px solid #57585A;}.jimu-widget-search .result-item-selected{background: #eee;}.jimu-widget-search .esri-search .esri-search-button:hover,.jimu-widget-search .esri-search .esri-search-button:focus {background-color: #485566; color: white;}.jimu-widget-search .esri-search .show-all-results{position: absolute; height: 25px; color: #686868; line-height: 25px; display: none; width: 237px; margin: auto; background-color: #fff; padding: 0 12px; cursor: pointer;}.jimu-widget-search .searchResults .esri-menu{border-radius: 0; color: #686868; font-size: 12px; padding: 0; top: 33px; visibility: visible;}.jimu-widget-search .searchMenu {position: absolute; top: 100%; left: 0; z-index: 1000; display: none; float: left; padding: 5px 0; margin: 2px 0 0; font-size: 14px; line-height: 16px; background-color: #fff; -webkit-background-clip: padding-box; background-clip: padding-box; border: 1px solid #57585A; -webkit-border-radius: 4px; border-radius: 4px; overflow: auto; max-height: 300px;}.jimu-widget-search .searchMenu ul {margin: 0; padding: 0; list-style: none;}.jimu-widget-search .esri-search .esri-menu li.active{background-color: #d9dde0; color: #686868; font-size: 14px;}.jimu-widget-search .esri-search .esri-menu li{padding: 0 12px; line-height: 25px; cursor: pointer;}.jimu-widget-search .esri-search .esri-menu li:hover,.jimu-widget-search .esri-search .esri-menu li:focus {background-color: #eee;}.jimu-widget-search .esri-search .esri-menu .menu-header{background-color: #d9dde0; color: #686868; font-size: 14px; min-height: 30px; padding: 0 12px; line-height: 30px;}",
"*now":function(d){d(['dojo/i18n!*preload*widgets/Search/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/when dojo/on dojo/query dojo/keys dojo/Deferred dojo/promise/all jimu/BaseWidget jimu/utils esri/widgets/Search esri/widgets/Search/SearchViewModel esri/tasks/Locator esri/tasks/support/Query esri/layers/FeatureLayer esri/layers/SceneLayer esri/symbols/PictureMarkerSymbol esri/PopupTemplate ./utils dojo/NodeList-dom".split(" "),function(d,b,a,v,h,S,G,J,q,l,f,e,k,x,E,H,N,u,A,D,Q){return d([f],{name:"Search",baseClass:"jimu-widget-search",
searchDijit:null,searchResults:null,_highlightedFeatureHandle:null,postCreate:function(){this.listenWidgetIds.push("framework")},startup:function(){this.inherited(arguments);this.config&&this.config.sources||(this.config.sources=[]);Q.setMap(this.sceneView.map);Q.setAppConfig(this.appConfig);h(Q.getConfigInfo(this.config)).then(b.hitch(this,function(K){return l(this._convertConfig(K)).then(function(y){return a.filter(y,function(Y){return Y})})})).then(b.hitch(this,function(K){this.domNode&&(K=new x({activeSourceIndex:1===
K.length?0:-1,allPlaceholder:e.stripHTML(this.config.allPlaceholder?this.config.allPlaceholder:window.jimuNls.common.findAddressOrPlace),autoSelect:!0,buttonModeEnabled:!1,labelEnabled:!1,popupEnabled:e.isDefined(this.config.showInfoWindowOnSelect)?!!this.config.showInfoWindowOnSelect:!0,view:this.sceneView,sources:K,theme:"arcgisSearch"}),this.searchDijit=new k({viewModel:K,includeDefaultSources:!1,container:this.searchNode}),this._resetSearchDijitStyle(),this.own(this.searchDijit.viewModel.watch("activeSourceIndex",
b.hitch(this,"_onSourceIndexChange"))),this.own(S(this.searchDijit.viewModel,"select-result",b.hitch(this,"_onSelectResult"))),this.own(S(this.searchDijit.domNode,"click",b.hitch(this,"_onSearchDijitClick"))),this.own(S(this.searchDijit,"suggest-complete",b.hitch(this,"_onSuggestResults"))),this.own(S(this.searchDijit._inputNode,"keyup",b.hitch(this,function(y){y.keyCode!==J.ENTER&&this._onClearSearch()}))),this.own(S(this.searchDijit.viewModel,"search-clear",b.hitch(this,"_onClearSearch"))),this.fetchData("framework"))}))},
_convertConfig:function(K){return a.map(K.sources,b.hitch(this,function(y){var Y=new q;if(y&&y.url&&"locator"===y.type)Y.resolve({locator:new E(y.url||""),outFields:["*"],singleLineFieldName:y.singleLineFieldName||"",name:e.stripHTML(y.name||""),placeholder:e.stripHTML(y.placeholder||""),highlightSymbol:new A({url:this.folderUrl+"css/images/search-pointer.png",size:36,width:36,height:36,xoffset:9,yoffset:18}),countryCode:y.countryCode||"",maxSuggestions:y.maxSuggestions||6,maxResults:y.maxResults||
6,zoomScale:y.zoomScale||5E4,withinViewEnabled:!!y.searchInCurrentMapExtent});else if(y&&y.url&&"query"===y.type){var ca=this._getLayerViewByLayerId(y.layerId);var I=/\/sceneserver\//gi.test(y.url)?new u({url:y.url||null,outFields:["*"]}):new N({url:y.url||null,outFields:["*"]});I.load().then(b.hitch(this,function(){var m=this._getInfoTemplate(I,y,y.displayField),z=null;y.searchFields&&0<y.searchFields.length?z=y.searchFields:(z=[],a.forEach(I.fields,function(r){"esriFieldTypeOID"!==r.type&&r.name!==
I.objectIdField&&"esriFieldTypeGeometry"!==r.type&&z.push(r.name)}));m={layer:I,outFields:["*"],searchFields:z,displayField:y.displayField||"",exactMatch:!!y.exactMatch,name:e.stripHTML(y.name||""),placeholder:e.stripHTML(y.placeholder||""),maxSuggestions:y.maxSuggestions||6,maxResults:y.maxResults||6,popupTemplate:m||null,zoomScale:y.zoomScale||5E4,withinViewEnabled:!!y.searchInCurrentMapExtent,featureLayerId:y.layerId,featurelayerGeometryType:I.geometryType};ca&&(m.resultGraphicEnabled=!1);"scene"===
I.type&&(m.autoNavigate=!1);Y.resolve(m)}),b.hitch(this,function(){Y.resolve(null)}))}else Y.resolve(null);return Y}))},_getInfoTemplate:function(K,y){var Y,ca=[];a.filter(K.fields,function(I){var m=I.name.toLowerCase();0>m.indexOf("shape")&&0>m.indexOf("objectid")&&0>m.indexOf("perimeter")&&ca.push(I.name)});(K=e.getDefaultPopupInfo(K,y.name+": {"+y.displayField+"}",ca))&&(Y=new D({title:K.title,content:[{type:"fields",fieldInfos:K.fieldInfos}]}));return Y},destroy:function(){Q.setAppConfig(null);
var K=this.sceneView.popup.viewModel;K&&(K.visible=!1);this.searchDijit&&this.searchDijit.viewModel&&(this.searchDijit.viewModel.set("view",null),this.searchDijit.viewModel.clear());this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove();this.inherited(arguments)},_getLayerViewByLayerId:function(K){return this.sceneView.layerViews.find(b.hitch(this,function(y){return y.layer.id===K}))},_onSelectResult:function(K){var y=K.result;if(y&&y.name){y=K.result.feature;var Y=this._getLayerViewByLayerId(K.source.featureLayerId);
if(Y){var ca=new H;ca.where=Y.layer.objectIdField+" \x3d "+y.attributes[Y.layer.objectIdField];ca.outFields=["*"];ca.returnGeometry=!0;ca.maxAllowableOffset=0;ca.outSpatialReference=this.sceneView.spatialReference;Y.layer.queryFeatures(ca).then(b.hitch(this,function(I){if(I=I.features[0])this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove(),this._highlightedFeatureHandle=Y.highlight(I),"scene"===Y.layer.type&&this.sceneView.goTo(I)}))}"point"===K.source.featurelayerGeometryType&&
K.source.zoomScale&&this.sceneView.goTo({scale:K.source.zoomScale})}},_onSearchComplete:function(){},onReceiveData:function(K,y,Y){"framework"===K&&"framework"===y&&Y&&Y.searchString&&(this.searchDijit.viewModel.set("value",Y.searchString),this.searchDijit.viewModel.search())},setPosition:function(){this._resetSearchDijitStyle();this.inherited(arguments)},resize:function(){this._resetSearchDijitStyle()},_onSourceIndexChange:function(){this.searchDijit.viewModel.value&&this.searchDijit.viewModel.search(this.searchDijit.viewModel.value)},
_onSuggestResults:function(){var K=0;setTimeout(b.hitch(this,function(){var y=G(".esri-search__suggestions-menu",this.domNode)[0];10<=K++||(y?this._resetSelectorPosition(".esri-search__suggestions-menu"):setTimeout(b.hitch(this,arguments.callee),10))}),10)},_onClearSearch:function(){v.setStyle(this.searchResultsNode,"display","none");this.searchResultsNode.innerHTML="";this.searchResults=null;this.sceneView.popup.close();this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove()},_onSearchDijitClick:function(){this._resetSelectorPosition(".esri-search__sources-menu");
this._onSuggestResults()},_resetSelectorPosition:function(K){var y=v.getMarginBox(window.jimuConfig.layoutId);G(K,this.domNode).forEach(b.hitch(this,function(Y){var ca=v.position(Y);if("none"!==v.getStyle(Y,"display")&&"hidden"!==v.getStyle(Y,"visibility")){var I=v.position(this.searchDijit.domNode),m=I.y-2,z=y.h-I.y-I.h;z>ca.y+ca.h||m>ca.h?v.setStyle(Y,"top",(z>ca.y+ca.h?I.h:-ca.h-2)+"px"):(v.setStyle(Y,"height",Math.max(z,m)+"px"),v.setStyle(Y,"top",(z>m?I.h:-m-2)+"px"))}}))},_onSelectSearchResult:function(K){for(K=
K.target;!v.hasAttr(K,"data-source-index")||!v.getAttr(K,"data-index");)K=K.parentNode;var y=null;y=v.getAttr(K,"data-source-index");K=parseInt(v.getAttr(K,"data-index"),10);"all"!==y&&(y=parseInt(y,10));this.searchResults&&this.searchResults[y]&&this.searchResults[y][K]&&(y=this.searchResults[y][K],this.searchDijit.viewModel.select(y))},_hideResultMenu:function(){G(".show-all-results",this.searchResultsNode).style("display","block");G(".searchMenu",this.searchResultsNode).style("display","none")},
_showResultMenu:function(){v.setStyle(this.searchResultsNode,"display","block");G(".show-all-results",this.searchResultsNode).style("display","none");G(".searchMenu",this.searchResultsNode).style("display","block");var K=G(".esri-input-container",this.searchDijit.domNode)[0];if(K){K=v.getMarginBox(K);var y={width:K.w+"px"};if(window.isRTL){var Y=v.getMarginBox(this.searchDijit.domNode);y.right=Y.w-K.l-K.w+"px"}else y.left=K.l+"px";G(".show-all-results",this.searchResultsNode).style(y);G(".searchMenu",
this.searchResultsNode).style(y)}},_resetSearchDijitStyle:function(){}})});