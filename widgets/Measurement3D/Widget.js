// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Measurement3D/ButtonGroup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-class dojo/on dijit/_WidgetBase".split(" "),function(m,f,h,G,z,e,w){return m([w],{baseClass:"jimu-button-group",CSS:{ACTIVE:"jimu-state-active"},buttons:[],activeButton:null,postCreate:function(){this.inherited(arguments);this._initUI()},buttonClicked:function(q){if(this.activeButton===q)z.remove(q,this.CSS.ACTIVE),this.activeButton=null;else{var a=G("*",this.domNode);
h.forEach(a,function(k){z.remove(k,this.CSS.ACTIVE)},this);z.add(q,this.CSS.ACTIVE);this.activeButton=q}this.onChange(this.activeButton)},getActiveButton:function(){return this.activeButton},getActiveButtonValue:function(){var q=this.getActiveButton();return q&&q.getAttribute("data-value")},_initUI:function(){h.forEach(this.buttons,function(q){this._createButton(q)},this)},_createButton:function(q){var a=document.createElement("button");a.type="button";a.title=q.label;a.setAttribute("data-value",
q.value);q.icon&&a.appendChild(q.icon);a.appendChild(document.createTextNode(q.content||q.value));this.domNode.appendChild(a);this.own(e(a,"click",f.hitch(this,function(k){this.buttonClicked(k.target)})))},onChange:function(){}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(m,f,h,G,z){return m(z,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);
this.views||(this.views=[]);G.forEach(this.views,f.hitch(this,function(e){1===e.nodeType?(h.place(e,this.domNode),h.addClass(e,"view"),h.setStyle(e,"display","none")):e.domNode&&(h.place(e.domNode,this.domNode),h.addClass(e.domNode,"view"),h.setStyle(e.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var e="",w=this.getSelectedView();w&&(e=w.label);return e},
getViewByLabel:function(e){for(var w=0;w<this.views.length;w++)if(e===this.views[w].label)return this.views[w];return null},addView:function(e){this.views.push(e);1===e.nodeType?(h.place(e,this.domNode),h.addClass(e,"view")):e.domNode&&(h.place(e.domNode,this.domNode),h.addClass(e.domNode,"view"))},removeView:function(e){var w=this.views.length;this.views=G.filter(this.views,function(q){return e!==q});w!==this.views.length&&(1===e.nodeType?h.destroy(e):e.domNode&&e.destroyRecursive())},switchView:function(e){var w;
var q="number"===typeof e?this.views[e]:"string"===typeof e?this.getViewByLabel(e):e;this.views.forEach(f.hitch(this,function(a){a&&(1===a.nodeType?w=a:a.domNode&&(w=a.domNode),a===q?(h.setStyle(w,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):h.setStyle(w,"display","none"))}));this._currentView=q;this.onViewSwitch(q)},onViewSwitch:function(){}})})},"esri/widgets/DirectLineMeasurement3D":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/decorators/accessibleHandler ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory ./support/widgetUtils".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p){e=function(c){function g(d,I){d=c.call(this,d,I)||this;d.view=null;d.visible=null;d.iconClass="esri-icon-measure-line";d.label=void 0;d.messages=null;d.messagesUnits=null;d.viewModel=new y;d.unitOptions=null;d.unit=null;return d}m._inheritsLoose(g,c);var b=g.prototype;b.render=function(){const {supported:d,active:I,state:M,measurement:v,unit:A}=this.viewModel;var C="disabled"===M;const u="measuring"===M||"measured"===M,{messages:t,messagesUnits:E}=this;
var B=I&&"ready"===M?l.tsx("section",{key:"esri-direct-line-measurement-3d__hint",class:"esri-direct-line-measurement-3d__hint"},l.tsx("p",{class:"esri-direct-line-measurement-3d__hint-text"},t.hint)):null;const H=d?null:l.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},l.tsx("p",null,t.unsupported));var L=(K,N,Q)=>{switch(N.state){case "available":return l.tsx("div",{key:`${Q}-enabled`,class:"esri-direct-line-measurement-3d__measurement-item"},
l.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},K),l.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},N.text));case "unavailable":return l.tsx("div",{key:`${Q}-disabled`,class:this.classes("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},l.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},K))}};L=u?l.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",
class:"esri-direct-line-measurement-3d__measurement"},L(t.direct,v.directDistance,"direct"),L(t.horizontal,v.horizontalDistance,"horizontal"),L(t.vertical,v.verticalDistance,"vertical")):null;var F=`${this.id}__units`,O=l.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:F},t.unit);F=l.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},l.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:F,onchange:this._changeUnit,bind:this,
value:A},this.viewModel.unitOptions.map(K=>{var N;return l.tsx("option",{key:K,value:K},G.isMeasurementSystem(K)?E.systems[K]:null==(N=E.units[K])?void 0:N.pluralCapitalized)})));O=l.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},O,F);O=u?l.tsx("div",{key:"settings",class:"esri-direct-line-measurement-3d__settings"},O):null;C=!d||I&&!u?null:l.tsx("div",{class:"esri-direct-line-measurement-3d__actions"},l.tsx("button",{disabled:C,class:this.classes("esri-direct-line-measurement-3d__clear-button esri-button esri-button--primary",
C&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement,type:"button"},t.newMeasurement));B=this.visible?l.tsx("div",{class:"esri-direct-line-measurement-3d__container"},H,B,O,L,C):null;return l.tsx("div",{key:this,class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},B)};b._newMeasurement=function(){h.ignoreAbortErrors(this.viewModel.start())};b._changeUnit=function(d){d=d.target;if(d=d.options[d.selectedIndex])this.unit=d.value};m._createClass(g,
[{key:"analysis",get:function(){return this.viewModel.analysis},set:function(d){this.viewModel.analysis=d}}]);return g}(D);f.__decorate([z.aliasOf("viewModel.view")],e.prototype,"view",void 0);f.__decorate([z.aliasOf("viewModel.visible")],e.prototype,"visible",void 0);f.__decorate([z.aliasOf("viewModel.active")],e.prototype,"active",void 0);f.__decorate([a.property({constructOnly:!0,nonNullable:!0})],e.prototype,"analysis",null);f.__decorate([a.property()],e.prototype,"iconClass",void 0);f.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],e.prototype,"label",void 0);f.__decorate([a.property(),r.messageBundle("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],e.prototype,"messages",void 0);f.__decorate([a.property(),r.messageBundle("esri/core/t9n/Units")],e.prototype,"messagesUnits",void 0);f.__decorate([a.property()],e.prototype,"uiStrings",void 0);f.__decorate([a.property({type:y})],e.prototype,"viewModel",void 0);f.__decorate([z.aliasOf("viewModel.unitOptions")],e.prototype,"unitOptions",void 0);
f.__decorate([z.aliasOf("viewModel.unit")],e.prototype,"unit",void 0);f.__decorate([x.accessibleHandler()],e.prototype,"_newMeasurement",null);f.__decorate([x.accessibleHandler()],e.prototype,"_changeUnit",null);return e=f.__decorate([k.subclass("esri.widgets.DirectLineMeasurement3D")],e)})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../analysis/DirectLineMeasurementAnalysis ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../properties/defaultUnit ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../support/InteractiveAnalysisViewModel".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x){w=function(r){function n(p){p=r.call(this,p)||this;p.analysis=null;p.supportedViewType="3d";p.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.";p._userUnit=null;p._userUnitOptions=null;return p}m._inheritsLoose(n,r);var l=n.prototype;l.clear=function(){this.removeTool();this.analysis.startPoint=null;this.analysis.endPoint=null};l.constructAnalysis=function(){return new h};l.constructTool=function(){return new y({view:G.unwrap(this.view),
analysis:this.analysis,analysisView:G.unwrap(this.analysisView),visible:this.visible})};l._findSelectableUnit=function(p,c){const g=this.unitOptions;return-1!==g.indexOf(p)?p:c?this._findSelectableUnit(c):g[0]};l._filteredOrAllUnits=function(p){if(!p)return z.measurementLengthUnits.slice();p=p.filter(c=>-1!==z.measurementLengthUnits.indexOf(c));return 0===p.length?z.measurementLengthUnits.slice():p};m._createClass(n,[{key:"state",get:function(){return this.disabled||!this.ready?"disabled":G.isNone(this.tool)?
"ready":this.tool.state}},{key:"measurement",get:function(){if(G.isNone(this.tool))return null;const p={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},c=this.tool.analysisView;if(G.isNone(c))return p;const g=c.actualVisualizedMeasurement,b=G.isSome(c.result)?"available":"unavailable";switch(g){case "euclidean":return{mode:"euclidean",directDistance:{text:c.directLabelText,state:b},
horizontalDistance:{text:c.horizontalLabelText,state:b},verticalDistance:{text:c.verticalLabelText,state:b}};case "geodesic":return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:c.horizontalLabelText,state:b},verticalDistance:{text:c.verticalLabelText,state:b}};default:return p}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(p){this._userUnitOptions=p;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},
{key:"unit",get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(p){this._userUnit=p?this._findSelectableUnit(p,this._userUnit):null;this.analysis.unit=p}}]);return n}(x.InteractiveAnalysisViewModel);f.__decorate([e.property({type:h})],w.prototype,"analysis",void 0);f.__decorate([e.property({readOnly:!0})],w.prototype,"state",null);f.__decorate([e.property({readOnly:!0})],w.prototype,
"measurement",null);f.__decorate([e.property()],w.prototype,"unitOptions",null);f.__decorate([e.property()],w.prototype,"unit",null);f.__decorate([e.property(D.defaultUnitPropertyMetadata)],w.prototype,"defaultUnit",void 0);f.__decorate([e.property()],w.prototype,"_userUnit",void 0);f.__decorate([e.property()],w.prototype,"_userUnitOptions",void 0);return w=f.__decorate([k.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],w)})},"esri/analysis/DirectLineMeasurementAnalysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ../core/maybe ../core/unitUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/Point".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y){h=function(x){function r(n){n=x.call(this,n)||this;n.type="direct-line-measurement";n.startPoint=null;n.endPoint=null;n.unit=null;n.nonEditableMessage="Assign start and end points to the analysis to allow editing.";return n}m._inheritsLoose(r,x);m._createClass(r,[{key:"extent",get:function(){if(G.isNone(this.startPoint))return null;const n=D.fromPoint(this.startPoint);G.isSome(this.endPoint)&&n.union(D.fromPoint(this.endPoint));return n}},{key:"requiredPropertiesForEditing",
get:function(){return[this.startPoint,this.endPoint]}}]);return r}(h);f.__decorate([e.property({type:["direct-line-measurement"]})],h.prototype,"type",void 0);f.__decorate([e.property({type:y})],h.prototype,"startPoint",void 0);f.__decorate([e.property({type:y})],h.prototype,"endPoint",void 0);f.__decorate([e.property()],h.prototype,"extent",null);f.__decorate([e.property({type:z.measurementLengthUnits,value:null})],h.prototype,"unit",void 0);f.__decorate([e.property({readOnly:!0})],h.prototype,"requiredPropertiesForEditing",
null);f.__decorate([e.property({readOnly:!0})],h.prototype,"nonEditableMessage",void 0);return h=f.__decorate([k.subclass("esri.analysis.DirectLineMeasurementAnalysis")],h)})},"esri/analysis/Analysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/Clonable ../core/Identifiable ../core/maybe ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D){let y=0;h=function(x){function r(n){n=x.call(this,n)||this;n.id=`${Date.now().toString(16)}-analysis-${y++}`;n.title=null;n.parent=null;n.visible=!0;return n}m._inheritsLoose(r,x);m._createClass(r,[{key:"isEditable",get:function(){return this.requiredPropertiesForEditing.every(e.isSome)}}]);return r}(G.ClonableMixin(z.IdentifiableMixin(h)));f.__decorate([w.property({type:String,constructOnly:!0,clonable:!1})],h.prototype,"id",void 0);f.__decorate([w.property({type:String})],
h.prototype,"title",void 0);f.__decorate([w.property({constructOnly:!0})],h.prototype,"type",void 0);f.__decorate([w.property({clonable:!1})],h.prototype,"parent",void 0);f.__decorate([w.property({readOnly:!0})],h.prototype,"extent",void 0);f.__decorate([w.property({type:Boolean})],h.prototype,"visible",void 0);f.__decorate([w.property({readOnly:!0})],h.prototype,"isEditable",null);f.__decorate([w.property({readOnly:!0})],h.prototype,"requiredPropertiesForEditing",void 0);f.__decorate([w.property({readOnly:!0})],
h.prototype,"nonEditableMessage",void 0);return h=f.__decorate([D.subclass("esri.analysis.Analysis")],h)})},"esri/properties/defaultUnit":function(){define(["exports","../core/unitUtils"],function(m,f){m.defaultUnitPropertyMetadata={readOnly:!0,get(){const {view:h}=this;if(!h)return"metric";const G=h.get("map.portalItem.portal");if(G)switch(G.get("user.units")||G.units){case "metric":return"metric";case "english":return"imperial"}return f.getDefaultUnitSystem(h.spatialReference)||"metric"}};Object.defineProperty(m,
"__esModule",{value:!0})})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3f64 ../../../../../layers/graphics/hydratedFeatures ../../../analysis/support/measurementUtils ../../editingTools/dragEventPipeline3D ./DirectLineMeasurement3DView ./PickRequest ../../../support/ElevationProvider ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/IntersectorInterfaces ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../support/screenUtils ../../../../../geometry/Point".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c,g,b,d,I,M,v,A){h=function(u){function t(B){B=u.call(this,B)||this;B._handles=new G;B._cachedPickRequest=null;B._isAnyPointerDown=!1;B.lineState="initial";B.analysisView=null;B.startPointSurfaceLocation=null;B.endPointSurfaceLocation=null;B.startManipulator=null;B.endManipulator=null;return B}m._inheritsLoose(t,u);var E=t.prototype;E.initialize=function(){this.measurementView=new p.DirectLineMeasurement3DView({toolState:this,view:this.view,analysis:this.analysis,
analysisView:this.analysisView,cursorPoint:this.cursorPoint,visible:this.visible});this._intersector=b.newIntersector(this.view.state.viewingMode);this._intersector.options.store=d.StoreResults.MIN;const {start:B,end:H}=this.measurementView.createManipulators(),L=(O,K,N)=>I.createManipulatorDragEventPipeline(O,(Q,V,Y)=>{const X=l.hideManipulatorWhileDragging(Q);V.next(X).next(l.screenToMap3D(this.view)).next(aa=>"start"!==aa.action?aa:null).next(aa=>{const ea=r.clonePoint(aa.mapEnd,new A);this.analysis[K]=
ea;Q.location=ea;this[N]=this._surfaceLocation(ea,aa.surfaceType)});Y.next(X).next(I.resetProperties(this.analysis,[K])).next(I.resetProperties(this,[N])).next(()=>{Q.location=z.unwrap(this.analysis[K])})}),F=O=>O.events.on("grab-changed",()=>{this.lineState=B.grabbing||H.grabbing?"editing":"measured"});this._handles.add([L(B,"startPoint","startPointSurfaceLocation"),L(H,"endPoint","endPointSurfaceLocation"),F(B),F(H)]);this.manipulators.add(B);this.manipulators.add(H);this.startManipulator=B;this.endManipulator=
H;this.startToolCreation();this._handles.add(e.watch(()=>this.state,O=>{"measured"===O&&this.finishToolCreation()},e.syncAndInitial))};E.destroy=function(){this.measurementView=z.destroyMaybe(this.measurementView);this._handles=z.destroyMaybe(this._handles)};E.onShow=function(){this.measurementView.show();this._updateManipulatorAvailability()};E.onHide=function(){this.measurementView.hide()};E.onInputEvent=function(B){switch(B.type){case "immediate-click":this._handleImmediateClick(B);break;case "pointer-move":this._handlePointerMove(B);
break;case "pointer-down":this._handlePointerDown();break;case "pointer-up":this._handlePointerUp()}this._updateManipulatorAvailability()};E._handlePointerMove=function(B){this._clearCachedPickRequest();const H=v.createScreenPointFromEvent(B);"mouse"===B.pointerType&&(this._hoverAt(H),"drawing"===this.lineState&&(this.endManipulator.events.emit("drag",{action:"update",start:H,screenPoint:H}),B.stopPropagation()))};E._handlePointerDown=function(){this._isAnyPointerDown=!0};E._handlePointerUp=function(){this._isAnyPointerDown=
!1};E._handleImmediateClick=function(B){this._clearCachedPickRequest();if(n.isPrimaryPointerAction(B)){var H=v.createScreenPointFromEvent(B),L=B.pointerType,F=!1;if(this.active)switch(this.lineState){case "initial":this.startManipulator.events.emit("drag",{action:"start",pointerType:L,start:H,screenPoint:H});this.startManipulator.events.emit("drag",{action:"end",start:H,screenPoint:H});z.isSome(this.analysis.startPoint)&&(this.startManipulator.interactive=!1,this.endManipulator.interactive=!1,this.lineState=
"drawing",this.endManipulator.events.emit("drag",{action:"start",pointerType:L,start:H,screenPoint:H}),F=!0);break;case "drawing":this.endManipulator.events.emit("drag",{action:"update",start:H,screenPoint:H}),z.isSome(this.analysis.endPoint)&&(this.endManipulator.events.emit("drag",{action:"end",start:H,screenPoint:H}),this.startManipulator.interactive=!0,this.endManipulator.interactive=!0,this.lineState="measured",F=!0)}F&&B.stopPropagation();"mouse"===B.pointerType&&this._hoverAt(H)}};E._hoverAt=
function(B){const H=this._isAnyPointerDown&&"drawing"!==this.lineState&&"editing"!==this.lineState;(z.isNone(this.analysis.startPoint)||z.isNone(this.analysis.endPoint))&&this.active&&!H?(B=this._pick(B),z.isSome(B)&&(this.cursorPoint=B)):this.cursorPoint=null};E._pick=function(B){if(z.isSome(this._cachedPickRequest)&&z.isSome(this._cachedPickRequest.result)){var H=this._cachedPickRequest.screenPoint;if(H.x===B.x&&H.y===B.y)return this._cachedPickRequest.result.mapPoint}else this._cachedPickRequest=
new c.PickRequest(B);B=w.screenPointObjectToArray(B);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(B,this._intersector);B=C;if(!this._intersector.results.min.getIntersectionPoint(B))return null;H=this.view.renderCoordsHelper.fromRenderCoords(B,this.view.spatialReference);this._cachedPickRequest.result=new c.PickResult(B,H);return H};E._clearCachedPickRequest=function(){this._cachedPickRequest=null};E._surfaceLocation=function(B,H){return H===l.SurfaceType.GROUND?"on-the-surface":
B.z>=this._getElevation(B)?"above-the-surface":"below-the-surface"};E._updateManipulatorAvailability=function(){this.startManipulator.available=z.isSome(this.analysis.startPoint);this.endManipulator.available=z.isSome(this.analysis.endPoint)};E._getElevation=function(B){return this.view.basemapTerrain.ready?z.unwrapOr(g.getElevationAtPoint(this.view.elevationProvider,B),0):0};m._createClass(t,[{key:"state",get:function(){return z.isNone(this.analysis.startPoint)&&z.isNone(this.analysis.endPoint)?
"ready":this.validMeasurement&&"editing"!==this.lineState&&"drawing"!==this.lineState?"measured":"measuring"}},{key:"cursor",get:function(){return"ready"===this.state||"drawing"===this.lineState?"crosshair":null}},{key:"cursorPoint",set:function(B){this._set("cursorPoint",B);this.measurementView.cursorPoint=B}},{key:"validMeasurement",get:function(){return z.isSome(this.analysis.startPoint)&&z.isSome(this.analysis.endPoint)}}]);return t}(M.InteractiveToolBase);f.__decorate([q.property({readOnly:!0})],
h.prototype,"state",null);f.__decorate([q.property()],h.prototype,"lineState",void 0);f.__decorate([q.property({readOnly:!0})],h.prototype,"cursor",null);f.__decorate([q.property()],h.prototype,"cursorPoint",null);f.__decorate([q.property({constructOnly:!0})],h.prototype,"analysis",void 0);f.__decorate([q.property({constructOnly:!0})],h.prototype,"analysisView",void 0);f.__decorate([q.property()],h.prototype,"measurementView",void 0);f.__decorate([q.property({constructOnly:!0})],h.prototype,"view",
void 0);f.__decorate([q.property({readOnly:!0})],h.prototype,"validMeasurement",null);f.__decorate([q.property({value:null})],h.prototype,"startPointSurfaceLocation",void 0);f.__decorate([q.property({value:null})],h.prototype,"endPointSurfaceLocation",void 0);h=f.__decorate([y.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],h);const C=x.create();return h})},"esri/views/3d/analysis/support/measurementUtils":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/geometryEngine ../../../../geometry/Polygon ../../../../geometry/projection ../../../../geometry/SpatialReference ../../../../geometry/support/geodesicUtils ../../support/mathUtils".split(" "),
function(m,f,h,G,z,e,w,q,a){const k=h.create(),D=h.create(),y=h.create(),x=new z({rings:[[k,D,y]],spatialReference:w.WGS84}),r=h.create();m.bestFitPlane=function(n,l){if(3>n.length)throw Error("need at least 3 points to fit a plane");a.planeFromPoints(n[0],n[1],n[2],l)};m.boundingSphere=function(n,l){const p=l.center;f.set(p,0,0,0);for(var c=0;c<n.length;++c)f.add(p,p,n[c]);f.scale(p,p,1/n.length);c=0;for(let g=0;g<n.length;++g)c=Math.max(c,f.squaredDistance(p,n[g]));l.radius=Math.sqrt(c)};m.fitHemisphere=
function(n,l=null,p=!0){const c=(b,d)=>{if(0===d[0]&&0===d[1]&&0===d[2])return!1;for(let I=0;I<b.length;++I)if(-1E-6>f.dot(d,b[I]))return!1;return!0};if(0===n.length)return!1;if(1===n.length)return l&&f.copy(l,n[0]),!0;f.set(r,0,0,0);for(var g=0;g<n.length;++g)f.add(r,r,n[g]);f.normalize(r,r);if(c(n,r))return l&&f.copy(l,r),!0;if(!p)return!1;for(p=0;p<n.length;++p)for(g=0;g<n.length;++g)if(p!==g&&(f.cross(r,n[p],n[g]),f.normalize(r,r),c(n,r)))return l&&f.copy(l,r),!0;return!1};m.isPrimaryPointerAction=
function(n){return"mouse"!==n.pointerType||0===n.button};m.planePointDistance=function(n,l){return f.dot(n,l)+n[3]};m.segmentLengthEuclidean=function(n,l,p){return e.projectPointToVector(n,k,p)&&e.projectPointToVector(l,D,p)?f.distance(k,D):0};m.segmentLengthGeodesic=function(n,l){if(!e.projectPointToWGS84ComparableLonLat(n,k)||!e.projectPointToWGS84ComparableLonLat(l,D))return 0;n={distance:null};q.inverseGeodeticSolver(n,[k[0],k[1]],[D[0],D[1]]);return n.distance};m.segmentLengthGeodesicVector=
function(n,l,p){const c={distance:null};q.inverseGeodeticSolver(c,[n[0],n[1]],[l[0],l[1]],p);return c.distance};m.tangentFrame=function(n,l,p){Math.abs(n[0])>Math.abs(n[1])?f.set(l,0,1,0):f.set(l,1,0,0);f.cross(p,n,l);f.normalize(l,l);f.cross(l,p,n);f.normalize(p,p)};m.triangleAreaEuclidean=function(n,l,p){return.5*Math.abs((l[0]-n[0])*(p[1]-n[1])-(l[1]-n[1])*(p[0]-n[0]))};m.triangleAreaGeodesic=function(n,l,p,c){if(!e.projectVectorToWGS84ComparableLonLat(n,c,k)||!e.projectVectorToWGS84ComparableLonLat(l,
c,D)||!e.projectVectorToWGS84ComparableLonLat(p,c,y))return 0;x.setPoint(0,0,k);x.setPoint(0,1,D);x.setPoint(0,2,y);return Math.abs(G.geodesicArea(x,"square-meters"))};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(m,f,h,G,z,e,w,q,a){function k(c){if(!c)return null;if(c.isGeographic&&
c.wkid){var g=z.spheroids[c.wkid];if(g)return g}return c.wkt&&((c=z.WKT_SPHEROID_REGEX.exec(c.wkt))&&2===c.length?(g=c[1].split(","),!g||3>g.length?c=null:(c=parseFloat(g[1]),g=parseFloat(g[2]),c=isNaN(c)||isNaN(g)?null:{a:c,f:0===g?0:1/g})):c=null,c)?c:null}function D(c){c=k(c||a.WGS84);if("b"in c&&"eSq"in c&&"radius"in c)return c;const g=c.a*(1-c.f);return Object.assign(c,{b:g,eSq:1-(g/c.a)**2,radius:(2*c.a+g)/3,densificationRatio:1E4/((2*c.a+g)/3)})}function y(c){return 0>c?c+360:c}function x(c,
g,b){const {a:d,eSq:I}=D(b);b=Math.sqrt(I);const M=Math.sin(g[1]*z.toRadians);g=d*g[0]*z.toRadians;b=0<I?d*(1-I)*(M/(1-I*M*M)-1/(2*b)*Math.log((1-b*M)/(1+b*M)))*.5:d*M;c[0]=g;c[1]=b;return c}function r(c){return null!==k(c)}function n(c,g){if("polyline"!==c.type&&"polygon"!==c.type)throw new h("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:b}=c;if(!r(b))throw new h("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");
var d="polyline"===c.type?c.paths:c.rings;const I=[],M=[0,0],v={distance:null};for(const u of d){d=[];I.push(d);d.push([u[0][0],u[0][1]]);var A=u[0][0],C=u[0][1];let t,E;for(let B=0;B<u.length-1;B++){t=u[B+1][0];E=u[B+1][1];if(A===t&&C===E)continue;const H=[A,C];p(v,[A,C],[t,E],b);const {azimuth:L,distance:F}=v;A=F/g;if(1<A){for(C=1;C<=A-1;C++)l(M,H,L,C*g,b),d.push(M.slice(0));l(M,H,L,(F+Math.floor(A-1)*g)/2,b);d.push(M.slice(0))}l(M,H,L,F,b);d.push(M.slice(0));A=M[0];C=M[1]}}return"polyline"===c.type?
new e({paths:I,spatialReference:b}):new w({rings:I,spatialReference:b})}function l(c,g,b,d,I){const M=g[0]*z.toRadians;g=g[1]*z.toRadians;b*=z.toRadians;const {a:v,b:A,f:C}=D(I);I=Math.sin(b);b=Math.cos(b);var u=(1-C)*Math.tan(g);g=1/Math.sqrt(1+u*u);const t=u*g,E=Math.atan2(u,b);u=g*I;const B=u*u;var H=1-B,L=H*(v*v-A*A)/(A*A);const F=1+L/16384*(4096+L*(-768+L*(320-175*L))),O=L/1024*(256+L*(-128+L*(74-47*L)));L=d/(A*F);let K=2*Math.PI,N,Q,V,Y;for(;1E-12<Math.abs(L-K);)V=Math.cos(2*E+L),N=Math.sin(L),
Q=Math.cos(L),Y=O*N*(V+O/4*(Q*(-1+2*V*V)-O/6*V*(-3+4*N*N)*(-3+4*V*V))),K=L,L=d/(A*F)+Y;d=t*N-g*Q*b;H=C/16*H*(4+C*(4-3*H));d=Math.atan2(t*Q+g*N*b,(1-C)*Math.sqrt(B+d*d))/z.toRadians;c[0]=(M+(Math.atan2(N*I,g*Q-t*N*b)-(1-H)*C*u*(L+H*N*(V+H*Q*(-1+2*V*V)))))/z.toRadians;c[1]=d;return c}function p(c,g,b,d){var I=g[0]*z.toRadians;g=g[1]*z.toRadians;var M=b[0]*z.toRadians;b=b[1]*z.toRadians;const {a:v,b:A,f:C,radius:u}=D(d),t=M-I;var E=Math.atan((1-C)*Math.tan(g)),B=Math.atan((1-C)*Math.tan(b));d=Math.sin(E);
E=Math.cos(E);const H=Math.sin(B);B=Math.cos(B);let L=1E3,F=t,O,K,N;let Q,V,Y;do{var X=Math.sin(F);var aa=Math.cos(F);N=Math.sqrt(B*X*B*X+(E*H-d*B*aa)*(E*H-d*B*aa));if(0===N)return c.distance=0,c.azimuth=void 0,c.reverseAzimuth=void 0,c;aa=d*H+E*B*aa;Q=Math.atan2(N,aa);V=E*B*X/N;K=1-V*V;X=aa-2*d*H/K;isNaN(X)&&(X=0);Y=C/16*K*(4+C*(4-3*K));O=F;F=t+(1-Y)*C*V*(Q+Y*N*(X+Y*aa*(-1+2*X*X)))}while(1E-12<Math.abs(F-O)&&0<--L);if(0===L)return d=Math.acos(Math.sin(g)*Math.sin(b)+Math.cos(g)*Math.cos(b)*Math.cos(M-
I))*u,I=M-I,c.azimuth=Math.atan2(Math.sin(I)*Math.cos(b),Math.cos(g)*Math.sin(b)-Math.sin(g)*Math.cos(b)*Math.cos(I))/z.toRadians,c.distance=d,c.reverseAzimuth=void 0,c;I=K*(v*v-A*A)/(A*A);g=I/1024*(256+I*(-128+I*(74-47*I)));M=Math.atan2(E*Math.sin(F),E*H*Math.cos(F)-d*B);c.azimuth=Math.atan2(B*Math.sin(F),E*H-d*B*Math.cos(F))/z.toRadians;c.distance=A*(1+I/16384*(4096+I*(-768+I*(320-175*I))))*(Q-g*N*(X+g/4*(aa*(-1+2*X*X)-g/6*X*(-3+4*N*N)*(-3+4*X*X))));c.reverseAzimuth=M/z.toRadians;return c}m.directGeodeticSolver=
l;m.geodesicAreas=function(c,g="square-meters"){if(c.some(M=>!r(M.spatialReference)))throw new h("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const b=[];for(var d=0;d<c.length;d++){var I=c[d];const {radius:M,densificationRatio:v}=D(I.spatialReference);b.push(n(I,M*v))}c=[];d=[0,0];I=[0,0];for(let M=0;M<b.length;M++){const {rings:v,spatialReference:A}=b[M];let C=0;for(let u=0;u<v.length;u++){const t=v[u];x(d,t[0],A);x(I,t[t.length-1],A);let E=
I[0]*d[1]-d[0]*I[1];for(let B=0;B<t.length-1;B++)x(d,t[B+1],A),x(I,t[B],A),E+=I[0]*d[1]-d[0]*I[1];C+=E}C=G.convertUnit(C,"square-meters",g);c.push(C/-2)}return c};m.geodesicDensify=n;m.geodesicDistance=function(c,g,b="meters"){if(!c||!g)throw new h("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!c.spatialReference||!g.spatialReference)throw new h("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!c.spatialReference.equals(g.spatialReference))throw new h("geodesic-distance:invalid-parameters",
"spatial references of input parameters do not match");const {spatialReference:d}=c;if(!r(d))throw new h("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(c.equals(g))return{distance:0,azimuth:0,reverseAzimuth:0};const I={distance:null};p(I,[c.x,c.y],[g.x,g.y],d);I.distance=G.convertUnit(I.distance,"meters",b);I.azimuth=y(I.azimuth);I.reverseAzimuth=y(I.reverseAzimuth);return I};m.geodesicLengths=function(c,g="meters"){if(!c)throw new h("geodesic-lengths:invalid-geometries",
"the input geometries type is not supported");if(c.some(I=>!r(I.spatialReference)))throw new h("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const b=[];for(let I=0;I<c.length;I++){var d=c[I];const {spatialReference:M}=d;d="polyline"===d.type?d.paths:d.rings;let v=0;for(let A=0;A<d.length;A++){const C=d[A];let u=0;for(let t=1;t<C.length;t++){const E=C[t-1][0],B=C[t][0],H=C[t-1][1],L=C[t][1];if(H!==L||E!==B){const F={distance:null};p(F,[E,H],
[B,L],M);u+=F.distance}}v+=u}v=G.convertUnit(v,"meters",g);b.push(v)}return b};m.inverseGeodeticSolver=p;m.isSupported=r;m.pointFromDistance=function(c,g,b){if(!c||null==g||null==b)throw new h("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>b||360<b)throw new h("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!c.spatialReference)throw new h("point-from-distance:missing-spatial-reference",
"the input point must have a spatial reference");const {spatialReference:d}=c;if(!r(d))throw new h("geodesic-distance:not-supported","input geometry spatial reference is not supported");const I=[0,0];l(I,[c.x,c.y],b,g,d);return new q({x:I[0],y:I[1],spatialReference:d})};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/dragEventPipeline3D":function(){define("exports ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ../../../../support/elevationInfoUtils ../../support/geometryUtils/ray ../../webgl-engine/lib/Intersector ../../webgl-engine/lib/IntersectorInterfaces ../../webgl-engine/lib/verticalOffsetUtils ../../../interactive/dragEventPipeline".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l){function p(t,E){return c(t,()=>E)}function c(t,E){const B=z.create(),H=z.create();let L=!1;return F=>{const O=E(F);if("start"===F.action){var K=h.screenPointObjectToArray(F.screenStart,h.castScreenPointArray(k.sv2d.get()));K=y.fromScreen(t.state.camera,K,u);f.isSome(K)&&(L=w.intersectRay(O,K,B))}if(!L)return null;K=h.screenPointObjectToArray(F.screenEnd,h.castScreenPointArray(k.sv2d.get()));K=y.fromScreen(t.state.camera,K,u);return f.isNone(K)?null:w.intersectRay(O,
K,H)?{...F,renderStart:B,renderEnd:H,plane:O,ray:K}:null}}function g(t,E,B,H=null,L=null){let F=null;return O=>{if("start"===O.action&&(F=t.sceneIntersectionHelper.intersectElevationFromScreen(h.createScreenPointArray(O.screenStart.x,O.screenStart.y),E,B,L),f.isSome(F)&&f.isSome(H)&&!e.projectPoint(F,F,H))||f.isNone(F))return null;const K=t.sceneIntersectionHelper.intersectElevationFromScreen(h.createScreenPointArray(O.screenEnd.x,O.screenEnd.y),E,B,L);return f.isSome(K)?f.isSome(H)&&!e.projectPoint(K,
K,H)?null:{...O,mapStart:F,mapEnd:K}:null}}function b(t,E,B,H=null,L=null){E=D.getZForElevationMode(E,t,B);return g(t,B,E,H,L)}function d(t,E,B,H=null,L=null){return b(t,B,D.getGraphicEffectiveElevationInfo(E),H,L)}function I(t,E){const B=A,H=C,L=w.create();t.renderCoordsHelper.worldUpAtPosition(E,B);t=G.cross(L,B,G.subtract(H,E,t.state.camera.eye));G.cross(t,t,B);return w.fromPositionAndNormal(E,t,L)}function M(t,E){const B=z.create(),H=G.length(E);t.renderCoordsHelper.worldUpAtPosition(E,B);const L=
z.create(),F=z.create(),O=K=>{G.subtract(K,K,E);a.projectPoint(B,K,K);"global"===t.viewingMode&&G.length(K)*Math.sign(G.dot(B,K))<-H+.001&&G.subtract(K,G.scale(K,B,.001),E);G.add(K,K,E);return K};return K=>{K.renderStart=O(G.copy(L,K.renderStart));K.renderEnd=O(G.copy(F,K.renderEnd));return K}}function v(t,E){const B=t.renderCoordsHelper;return H=>{const L=B.fromRenderCoords(H.renderStart,E),F=B.fromRenderCoords(H.renderEnd,E);return f.isSome(L)&&f.isSome(F)?{...H,mapStart:L,mapEnd:F}:null}}m.SurfaceType=
void 0;(function(t){t[t.GROUND=0]="GROUND";t[t.OTHER=1]="OTHER"})(m.SurfaceType||(m.SurfaceType={}));const A=z.create(),C=z.create(),u=q.create();m.convertToMapCoordinates=v;m.hideManipulatorWhileDragging=function(t){let E=null;return B=>{switch(B.action){case "start":E=t.disableDisplay();break;case "end":case "cancel":f.isSome(E)&&(E.remove(),E=null)}return B}};m.projectToWorldUp=M;m.screenToMap3D=function(t,E=null){const B=x.newIntersector(t.state.viewingMode);B.options.selectionMode=!0;B.options.store=
r.StoreResults.MIN;B.options.hud=!1;const H=h.createScreenPointArray(),L={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},F=z.create(),O=f.unwrapOr(E,t.spatialReference),K=Q=>{t.map.ground&&1>t.map.ground.opacity?L.exclude.add(n.TERRAIN_ID):L.exclude.delete(n.TERRAIN_ID);t.sceneIntersectionHelper.intersectIntersectorScreen(h.screenPointObjectToArray(Q,H),B,L);Q=B.results.min;if(Q.getIntersectionPoint(F))Q=Q.intersector===r.IntersectorType.TERRAIN?m.SurfaceType.GROUND:m.SurfaceType.OTHER;
else if(B.results.ground.getIntersectionPoint(F))Q=m.SurfaceType.GROUND;else return null;return{location:t.renderCoordsHelper.fromRenderCoords(F,O),surfaceType:Q}};let N;return Q=>{if("start"===Q.action){var V=K(Q.screenStart);N=f.isSome(V)?V.location:null}if(f.isNone(N))return null;V=K(Q.screenEnd);return f.isSome(V)&&f.isSome(V.location)?{...Q,mapStart:N,mapEnd:V.location,surfaceType:V.surfaceType}:null}};m.screenToMapXYAtLocation=b;m.screenToMapXYForGraphic=function(t,E,B,H){t=E.toMap(t.screenStart,
{include:[B]});return f.isSome(t)?d(E,B,t,H):null};m.screenToMapXYForGraphicAtLocation=d;m.screenToRenderPlane=p;m.screenToRenderPlaneFromEvent=function(t){return c(t,E=>E.plane)};m.screenToZConstrained=function(t,E,B){let H=null;const L=new l.EventPipeline;L.next(p(t,I(t,E))).next(M(t,E)).next(v(t,B)).next(F=>{F.mapEnd.x=F.mapStart.x;F.mapEnd.y=F.mapStart.y;H=F});return F=>{H=null;L.execute(F);return H}};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/support/elevationInfoUtils":function(){define(["exports",
"../core/maybe","../symbols/support/unitConversionUtils"],function(m,f,h){function G(k,D){return f.isNone(D)||!D.mode?k?"absolute-height":"on-the-ground":D.mode}function z(k,D){return G(f.isSome(k)?k.hasZ:!1,D)}function e(k){const D=w(k);return z(k.geometry,D)}function w(k){return k.layer&&"elevationInfo"in k.layer?k.layer.elevationInfo:null}function q(k,D,y,x,r,n,l=null){if(!f.isNone(n)){var p=f.isSome(l)?l.mode:"absolute-height";if("on-the-ground"===p)return 0;a:{n=a(D,y,x,r,k,n);l=f.isSome(l)&&
f.isSome(l.offset)?l.offset:0;switch(p){case "absolute-height":k=n-l;break a;case "relative-to-ground":k=n-(f.unwrapOr(k.elevationProvider.getElevation(D,y,x,r,"ground"),0)+l);break a;case "relative-to-scene":k=n-(f.unwrapOr(k.elevationProvider.getElevation(D,y,x,r,"scene"),0)+l);break a}k=void 0}return k}}function a(k,D,y,x,r,n){const l=f.isSome(n.offset)?n.offset:0;switch(n.mode){case "absolute-height":return y+l;case "on-the-ground":return f.unwrapOr(r.elevationProvider.getElevation(k,D,0,x,"ground"),
0);case "relative-to-ground":return y+f.unwrapOr(r.elevationProvider.getElevation(k,D,y,x,"ground"),0)+l;case "relative-to-scene":return y+f.unwrapOr(r.elevationProvider.getElevation(k,D,y,x,"scene"),0)+l}}m.getConvertedElevation=function(k,D,y,x=null){return q(k,D.x,D.y,D.hasZ?D.z:0,D.spatialReference,y,x)};m.getConvertedElevationFromVector=function(k,D,y,x,r=null){return q(k,D[0],D[1],2<D.length?D[2]:0,y,x,r)};m.getEffectiveElevationMode=G;m.getGeometryEffectiveElevationMode=z;m.getGraphicEffectiveElevationInfo=
function(k){var D=w(k);k=z(k.geometry,D);D=f.isSome(D)&&"on-the-ground"!==k?f.unwrapOr(D.offset,0)*h.getMetersPerUnit(f.unwrapOr(D.unit,"meters")):0;return{mode:k,offset:D}};m.getGraphicEffectiveElevationMode=e;m.getZForElevationMode=function(k,D,y){if(!f.isNone(y)&&y.mode){var x=k.hasZ?k.z:0,r=f.isSome(y.offset)?y.offset:0;switch(y.mode){case "absolute-height":return x-r;case "on-the-ground":return 0;case "relative-to-ground":return k=f.unwrapOr(D.elevationProvider.getElevation(k.x,k.y,k.z,k.spatialReference,
"ground"),0)+r,x-k;case "relative-to-scene":return k=f.unwrapOr(D.elevationProvider.getElevation(k.x,k.y,k.z,k.spatialReference,"scene"),0)+r,x-k}}};m.hasGraphicFeatureExpressionInfo=function(k){if("on-the-ground"===e(k))return!1;k=w(k);k=f.isSome(k)&&k.featureExpressionInfo?k.featureExpressionInfo.expression:null;return!(!k||"0"===k)};m.zValueInAbsoluteHeightMode=a;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../geometry ../../core/handleUtils ../../core/lang ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../geometry/projection ../ViewingMode ../draw/support/drawUtils ../../geometry/Point".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y){function x(v,A){let C=null,u=null;return t=>{if("cancel"===t.action)e.isSome(u)&&(u.execute({action:"cancel"}),u=C=null);else{var E={action:t.action,screenStart:t.start,screenEnd:t.screenPoint};"start"===t.action&&e.isNone(C)&&(C=new M,u=new M,A(v,C,u,t.pointerType,E));e.isSome(C)&&C.execute(E);"end"===t.action&&e.isSome(C)&&(u=C=null)}}}function r(v,A){return v.events.on("drag",x(v,A))}function n(v,A){let C=null;return u=>{"start"===u.action&&(C=p(v,u.mapStart.spatialReference,
A));if(e.isNone(C))return null;const t=u.mapEnd.x-u.mapStart.x,E=u.mapEnd.y-u.mapStart.y,B=u.mapEnd.z-u.mapStart.z;C.move(t,E,B);return{...u,translationX:t,translationY:E,translationZ:B}}}function l(v,A){return e.isNone(v)?null:v.spatialReference.equals(A)?v.clone():a.project(v,A)}function p(v,A,C){const u=v.geometry;if(e.isNone(u))return null;if("mesh"===u.type)return c(v,u,A,C);const t=l(u,A),E=u.spatialReference;return e.isNone(t)?null:{move:(B,H,L)=>{B=D.move(t.clone(),B,H,L);B.spatialReference.equals(E)?
v.geometry=B:v.geometry=a.project(B,E)}}}function c(v,A,C,u){if(e.isSome(A.transform))return g(v,A,A.transform,C);if(!A.spatialReference.equals(C))return null;let t=0,E=0,B=0;return{move:(H,L,F)=>{var O=H-t;const K=L-E,N=F-B;if(O||K||N)O=new y(A.origin.x+O,A.origin.y+K,A.origin.z+N,A.origin.spatialReference),A.centerAt(O,{geographic:u===k.ViewingMode.Global}),v.notifyGeometryChanged(),t=H,E=L,B=F}}}function g(v,A,C,u){const t=C.getOriginPoint(A.spatialReference),E=l(t,u),B=A.spatialReference;return e.isNone(E)?
null:{move:(H,L,F)=>{H=D.move(E.clone(),H,L,F);H.spatialReference.equals(B)?C.origin=q.fromValues(H.x,H.y,H.z):(H=a.project(H,B),e.isSome(H)&&(C.origin=q.fromValues(H.x,H.y,H.z)));v.notifyMeshTransformChanged();v.notifyGeometryChanged()}}}function b(v,A){const C=new Map;for(const u of A)C.set(u,G.clone(v[u]));return u=>{C.forEach((t,E)=>{v[E]=t});return u}}function d(v){return e.isSome(v.geometry)&&"mesh"===v.geometry.type?I(v,v.geometry):b(v,["geometry"])}function I(v,A){const C=e.isSome(A.transform)?
A.transform.clone():null,u=A.vertexAttributes.clonePositional();return t=>{A.transform=C;A.vertexAttributes=u;v.notifyGeometryChanged();return t}}let M=function(){function v(){this.execute=()=>{}}v.prototype.next=function(A,C=new v){e.isSome(A)&&(this.execute=u=>{u=A(u);e.isSome(u)&&C.execute(u)});return C};return v}();m.EventPipeline=M;m.addMapDelta=function(){let v=0,A=0,C=0;return u=>{"start"===u.action&&(v=u.mapStart.x,A=u.mapStart.y,C=u.mapStart.z);const t=u.mapEnd.x-v,E=u.mapEnd.y-A,B=u.mapEnd.z-
C;v=u.mapEnd.x;A=u.mapEnd.y;C=u.mapEnd.z;return{...u,mapDeltaX:t,mapDeltaY:E,mapDeltaZ:B,mapDeltaSpatialReference:u.mapStart.spatialReference}}};m.addScreenDelta=function(){let v=0,A=0;return C=>{"start"===C.action&&(v=C.screenStart.x,A=C.screenStart.y);const u=C.screenEnd.x-v,t=C.screenEnd.y-A;v=C.screenEnd.x;A=C.screenEnd.y;return{...C,screenDeltaX:u,screenDeltaY:t}}};m.constrainToMapAxis=function(v,A){const C=[v.x,v.y,v.z],u=[Math.cos(A),Math.sin(A)];v=Math.sqrt(u[0]*u[0]+u[1]*u[1]);if(0===v)return null;
u[0]/=v;u[1]/=v;const t=E=>{const B=(E.x-C[0])*u[0]+(E.y-C[1])*u[1];E.x=C[0]+B*u[0];E.y=C[1]+B*u[1]};return E=>{t(E.mapStart);t(E.mapEnd);return E}};m.createDragEventPipelineCallback=x;m.createManipulatorDragEventPipeline=r;m.createManipulatorDragEventPipelineMany=function(v,A){const C=[];for(const u of v)C.push(r(u,A));return h.handlesGroup(C)};m.dragAtLocation=function(v,A){let C=null,u=0,t=0;return E=>{"start"===E.action&&(C=v.toScreen(A),0>C.x||C.x>v.width||0>C.y||C.y>v.height?C=null:(u=E.screenStart.x-
C.x,t=E.screenStart.y-C.y));if(null==C)return null;var B=z.clamp(E.screenEnd.x-u,0,v.width);const H=z.clamp(E.screenEnd.y-t,0,v.height);B=w.createScreenPoint(B,H);E.screenStart=C;E.screenEnd=B;return E}};m.dragGraphic=n;m.dragGraphicMany=function(v,A){const C=v.map(u=>e.unwrap(n(u,A))).filter(u=>e.isSome(u));return u=>{const t=u.mapEnd.x-u.mapStart.x,E=u.mapEnd.y-u.mapStart.y,B=u.mapEnd.z-u.mapStart.z;C.forEach(H=>H(u));return{...u,translationX:t,translationY:E,translationZ:B}}};m.resetGraphic=d;
m.resetGraphicMany=function(v){const A=v.map(C=>e.unwrap(d(C))).filter(C=>e.isSome(C));return C=>{A.forEach(u=>u(C));return C}};m.resetProperties=b;m.resetSymbol=function(v){return b(v,["symbol"])};m.screenToMap=function(v,A=null,C){let u=null;const t=e.isSome(A)&&!v.spatialReference.equals(A)?B=>e.isSome(B)?a.project(B,A):B:B=>B,E={exclude:[],...C};return B=>{"start"===B.action&&(u=t(v.toMap(B.screenStart,E)));if(e.isNone(u))return null;const H=t(v.toMap(B.screenEnd,E));return e.isSome(H)?{...B,
mapStart:u,mapEnd:H}:null}};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/draw/support/drawUtils":function(){define(["exports","../../../core/mathUtils","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(m,f,h,G,z){function e(a,k,D,y){null==y||a.hasZ||(y=void 0);if("point"===a.type)return a.x+=k,a.y+=D,a.hasZ&&null!=y&&(a.z+=y),a;if("multipoint"===a.type){var x=a.points;for(var r=0;r<x.length;r++)x[r]=
w(x[r],k,D,y);return a}if("extent"===a.type)return a.xmin+=k,a.xmax+=k,a.ymin+=D,a.ymax+=D,null!=y&&(a.zmin+=y,a.zmax+=y),a;x=z.geometryToCoordinates(a);r="polyline"===a.type?a.paths:a.rings;for(let n=0;n<x.length;n++){const l=x[n];for(let p=0;p<l.length;p++)l[p]=w(l[p],k,D,y)}"paths"in a?a.paths=r:a.rings=r;return a}function w(a,k,D,y){return q(a,a[0]+k,a[1]+D,null!=a[2]&&null!=y?a[2]+y:void 0)}function q(a,k,D,y){k=[k,D];2<a.length&&k.push(null!=y?y:a[2]);3<a.length&&k.push(a[3]);return k}m.cloneMove=
function(a,k,D,y,x){a=a.clone();var r=y.resolution;if("point"===a.type)return x?e(a,k*r,-D*r):(x=y.state.transform,y=y.state.inverseTransform,r=x[0]*a.x+x[2]*a.y+x[4],x=x[1]*a.x+x[3]*a.y+x[5],a.x=y[0]*(r+k)+y[2]*(x+D)+y[4],a.y=y[1]*(r+k)+y[3]*(x+D)+y[5]),a;if("multipoint"===a.type){if(x)e(a,k*r,-D*r);else{x=a.points;r=y.state.transform;y=y.state.inverseTransform;for(var n=0;n<x.length;n++){var l=x[n],p=r[0]*l[0]+r[2]*l[1]+r[4],c=r[1]*l[0]+r[3]*l[1]+r[5];x[n]=q(l,y[0]*(p+k)+y[2]*(c+D)+y[4],y[1]*(p+
k)+y[3]*(c+D)+y[5],void 0)}}return a}if("extent"===a.type)return x?e(a,k*r,-D*r):(x=y.state.transform,y=y.state.inverseTransform,r=x[0]*a.xmin+x[2]*a.ymin+x[4],n=x[1]*a.xmin+x[3]*a.ymin+x[5],l=x[0]*a.xmax+x[2]*a.ymax+x[4],x=x[1]*a.xmax+x[3]*a.ymax+x[5],a.xmin=y[0]*(r+k)+y[2]*(n+D)+y[4],a.ymin=y[1]*(r+k)+y[3]*(n+D)+y[5],a.xmax=y[0]*(l+k)+y[2]*(x+D)+y[4],a.ymax=y[1]*(l+k)+y[3]*(x+D)+y[5]),a;if(x)e(a,k*r,-D*r);else{x=z.geometryToCoordinates(a);r="polyline"===a.type?a.paths:a.rings;n=y.state.transform;
y=y.state.inverseTransform;for(l=0;l<x.length;l++)for(p=x[l],c=0;c<p.length;c++){const g=p[c],b=n[0]*g[0]+n[2]*g[1]+n[4],d=n[1]*g[0]+n[3]*g[1]+n[5];p[c]=q(g,y[0]*(b+k)+y[2]*(d+D)+y[4],y[1]*(b+k)+y[3]*(d+D)+y[5],void 0)}"paths"in a?a.paths=r:a.rings=r}return a};m.getRotationAngle=function(a,k,D){a=Math.atan2(k.y-D.y,k.x-D.x)-Math.atan2(a.y-D.y,a.x-D.x);return f.rad2deg(Math.atan2(Math.sin(a),Math.cos(a)))};m.getScaleRatio=function(a,k,D,y,x,r){return Math.sqrt((x-a)*(x-a)+(r-k)*(r-k))/Math.sqrt((D-
a)*(D-a)+(y-k)*(y-k))};m.move=e;m.scale=function(a,k,D,y){if("point"===a.type){const {x:d,y:I}=a;var x=y?y[0]:d,r=y?y[1]:I;a=a.clone();D=(I-r)*D+r;a.x=(d-x)*k+x;a.y=D;return a}if("multipoint"===a.type){x=z.geometryToCoordinates(a);r=h.create();const [d,I,M,v]=G.getRingsOrPathsBounds(r,[x]);x=y?y[0]:(d+M)/2;r=y?y[1]:(v+I)/2;a=a.clone();y=a.points;for(var n=0;n<y.length;n++){var l=y[n];const [A,C]=l;y[n]=q(l,(A-x)*k+x,(C-r)*D+r,void 0)}return a}if("extent"===a.type){const {xmin:d,xmax:I,ymin:M,ymax:v}=
a;x=y?y[0]:(d+I)/2;r=y?y[1]:(v+M)/2;a=a.clone();a.xmin=(d-x)*k+x;a.ymax=(v-r)*D+r;a.xmax=(I-x)*k+x;a.ymin=(M-r)*D+r;a.xmin>a.xmax&&(k=a.xmin,a.xmin=a.xmax,a.xmax=k);a.ymin>a.ymax&&(k=a.ymin,a.ymin=a.ymax,a.ymax=k);return a}x=z.geometryToCoordinates(a);r=h.create();const [p,c,g,b]=G.getRingsOrPathsBounds(r,x);r=y?y[0]:(p+g)/2;y=y?y[1]:(b+c)/2;a=a.clone();n="polyline"===a.type?a.paths:a.rings;for(l=0;l<x.length;l++){const d=x[l];for(let I=0;I<d.length;I++){const M=d[I],[v,A]=M;n[l][I]=q(M,(v-r)*k+r,
(A-y)*D+y,void 0)}}"paths"in a?a.paths=n:a.rings=n;return a};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3f64 ../../../../../geometry/support/lineSegment ../../../analysis/interfaces ../../../analysis/DirectLineMeasurement/interfaces ../../manipulatorUtils ../../visualElements/LaserlineVisualElement".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c){const g={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5};var b;(function(d){d.Manipulators="manipulators";d.AnalysisViewDestroyed="analysis-view-destroyed";d.AnalysisView="analysis-view"})(b||(b={}));m.DirectLineMeasurement3DView=function(d){function I(v){v=d.call(this,v)||this;v.params=g;v.analysisView=
null;v.cursorPoint=null;v._visible=!1;v._laserLine=null;v.laserLineEnabled=!0;v._handles=new z;v._lastDraggedHandle=null;return v}f._inheritsLoose(I,d);var M=I.prototype;M.initialize=function(){this._laserLine=new c.LaserlineVisualElement({view:this.view,attached:!0});this._updateVisibility(this._visible);this._connectToAnalysisView()};M.destroy=function(){this._handles=e.destroyMaybe(this._handles);this._laserLine=e.destroyMaybe(this._laserLine)};M.whenMessages=function(){var v=f._asyncToGenerator(function*(){yield w.whenOnce(()=>
!this.analysisView.updating)});return function(){return v.apply(this,arguments)}}();M.createManipulators=function(){var v=()=>{const t=p.createSphereManipulator(this.view,this.params.handleColor,this.params.handleOpacity);t.available=!1;t.radius=this.params.handleRadius;return t};const A=v(),C=v();e.isSome(this.analysis.startPoint)&&(A.location=this.analysis.startPoint,A.available=!0);e.isSome(this.analysis.endPoint)&&(C.location=this.analysis.endPoint,C.available=!0);var u=()=>{let t=this._lastDraggedHandle;
A.grabbing&&!C.grabbing&&(t="start");C.grabbing&&!A.grabbing&&(t="end");A.grabbing||C.grabbing||(t=null);this._lastDraggedHandle=t};v=A.events.on("grab-changed",u);u=C.events.on("grab-changed",u);this._handles.add([v,u],b.Manipulators);return{start:A,end:C}};M.show=function(){this.destroyed||this._visible||this._updateVisibility(!0)};M.hide=function(){!this.destroyed&&this._visible&&this._updateVisibility(!1)};M._connectToAnalysisView=function(){this._handles.remove(b.AnalysisView);this._handles.add([w.watch(()=>
e.applySome(this.analysisView,v=>v.destroyed),v=>{v&&this._handles.remove(b.AnalysisView)},w.initial),w.watch(()=>["measured"===this.toolState.lineState,this.analysisView],([v,A])=>{e.isSome(A)&&!A.destroyed&&(A.allowVisualElementsOrientationChange=!v)},w.initial),w.watch(()=>this._laserLineParams,v=>{const A=this._laserLine;A.heightManifoldTarget=v.heightManifoldTarget;A.pointDistanceLine=v.pointDistanceLine;A.lineVerticalPlaneSegment=v.lineVerticalPlaneSegment},w.initial)],b.AnalysisView)};M._updateVisibility=
function(v){this.constructed&&(this._visible=v,(this.analysis.visible=v)?this._laserLine.style={innerColor:this.params.laserLineInnerColor,innerWidth:this.params.laserLineInnerWidth,glowColor:this.params.laserLineGlowColor,glowWidth:this.params.laserLineGlowWidth,glowFalloff:this.params.laserLineGlowFalloff,globalAlpha:this.params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=v)};f._createClass(I,[{key:"visible",get:function(){return this._visible},set:function(v){v?this.show():
this.hide()}},{key:"testData",get:function(){const v=this._laserLine.testData,A=this.analysisView.testData;return{labels:null==A?void 0:A.labels,stripeLength:null==A?void 0:A.stripeLength,laserLineRenderer:{heightManifoldEnabled:e.isSome(v)?v.heightManifoldEnabled:!1,heightManifoldTarget:e.isSome(v)?v.heightManifoldTarget:null,pointDistanceEnabled:e.isSome(v)?v.pointDistanceEnabled:!1,pointDistanceOrigin:e.isSome(v)?v.pointDistanceOrigin:null,pointDistanceTarget:e.isSome(v)?v.pointDistanceTarget:
null,lineVerticalPlaneEnabled:e.isSome(v)?v.lineVerticalPlaneEnabled:!1}}}},{key:"_cursorPosition",get:function(){const v=x.create();e.applySome(this.cursorPoint,A=>this.view.renderCoordsHelper.toRenderCoords(A,v));return v}},{key:"_startPosition",get:function(){const v=x.create();e.applySome(this.analysis.startPoint,A=>this.view.renderCoordsHelper.toRenderCoords(A,v));return v}},{key:"_endPosition",get:function(){const v=x.create();e.applySome(this.analysis.endPoint,A=>this.view.renderCoordsHelper.toRenderCoords(A,
v));return v}},{key:"_laserLineParams",get:function(){const v=this._focusPosition,{active:A,lineState:C}=this.toolState,u=this.analysisView,t=this.laserLineEnabled&&!!v&&"measured"!==C&&A;if(!t||!this.visible||e.isNone(u)||u.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const E=u.actualVisualizedMeasurement;return{heightManifoldTarget:"euclidean"===E?v:null,pointDistanceLine:"local"!==this.view.viewingMode&&t&&this.analysis.startPoint&&"geodesic"===
E?this._pointDistanceLine:null,lineVerticalPlaneSegment:t&&u.viewMode===l.ViewMode.Triangle?r.fromPoints(this._startPosition,this._endPosition):null}}},{key:"_focusPosition",get:function(){const {lineState:v}=this.toolState;var A=this.analysisView;A=e.isSome(A)&&!A.destroyed&&A.measurementMode===n.MeasurementMode.Euclidean&&A.viewMode===l.ViewMode.Direct;switch(v){case "drawing":return A?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case "editing":return A?"start"===
this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return e.isSome(this.cursorPoint)?this._cursorPosition:null}}},{key:"_pointDistanceLine",get:function(){return{origin:"drawing"===this.toolState.lineState||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition,target:this._focusPosition}}}]);return I}(G);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"view",void 0);h.__decorate([q.property()],
m.DirectLineMeasurement3DView.prototype,"params",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"analysis",void 0);h.__decorate([q.property({constructOnly:!0})],m.DirectLineMeasurement3DView.prototype,"analysisView",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"cursorPoint",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"toolState",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"visible",
null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"testData",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_visible",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_laserLine",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"laserLineEnabled",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_cursorPosition",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,
"_startPosition",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_endPosition",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_lastDraggedHandle",void 0);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_laserLineParams",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_focusPosition",null);h.__decorate([q.property()],m.DirectLineMeasurement3DView.prototype,"_pointDistanceLine",null);m.DirectLineMeasurement3DView=
h.__decorate([y.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],m.DirectLineMeasurement3DView);Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/analysis/interfaces":function(){define(["exports"],function(m){m.MeasurementMode=void 0;var f=m.MeasurementMode||(m.MeasurementMode={});f[f.Auto=0]="Auto";f[f.Euclidean=1]="Euclidean";f[f.Geodesic=2]="Geodesic";Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/analysis/DirectLineMeasurement/interfaces":function(){define(["exports"],
function(m){m.ViewMode=void 0;(function(f){f[f.None=0]="None";f[f.Direct=1]="Direct";f[f.Triangle=2]="Triangle";f[f.ProjectedGeodesic=3]="ProjectedGeodesic"})(m.ViewMode||(m.ViewMode={}));m.VisualElementOrientation=void 0;(function(f){f[f.Auto=0]="Auto";f[f.AboveSegment=1]="AboveSegment";f[f.BelowSegment=2]="BelowSegment"})(m.VisualElementOrientation||(m.VisualElementOrientation={}));Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/interactive/manipulatorUtils":function(){define("exports ../../../core/maybe ../../../chunks/mat4 ../../../chunks/vec3 ../../../chunks/vec4f64 ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ./Manipulator3D ../layers/graphics/graphicUtils ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Material ../webgl-engine/materials/ColorMaterial ../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r){function n(c,g=y.RenderOccludedFlag.OccludeAndTransparent,b=!0){const d=z.fromValues(c[0],c[1],c[2],3<c.length?c[3]:1);c=1>c[3];return b?new r.ShadedColorMaterial({color:d,transparent:c,writeDepth:!0,cullFace:k.CullFaceOptions.Back,renderOccluded:g}):new x.ColorMaterial({color:d,transparent:c,writeDepth:!0,cullFace:k.CullFaceOptions.Back,renderOccluded:g})}function l(c,g,b,d){c=G.normalize(e.sv3d.get(),c);g=G.normalize(e.sv3d.get(),g);const I=G.cross(e.sv3d.get(),
c,g);d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=0;d[4]=g[0];d[5]=g[1];d[6]=g[2];d[7]=0;d[8]=I[0];d[9]=I[1];d[10]=I[2];d[11]=0;d[12]=b[0];d[13]=b[1];d[14]=b[2];d[15]=1;return d}function p(c,g){const b=c.getViewForGraphic(g);return f.isSome(b)&&"computeAttachmentOrigin"in b?b.computeAttachmentOrigin(g,c.spatialReference):null}m.calculateInputRotationTransform=function(c,g,b,d){c=G.subtract(e.sv3d.get(),c,b);d=G.cross(e.sv3d.get(),d,c);b=l(c,d,b,e.sm4d.get());h.invert(b,b);g=G.transformMat4(e.sv3d.get(),g,b);
return Math.atan2(g[1],g[0])};m.calculateTranslateRotateFromBases=l;m.createManipulatorMaterial=n;m.createManipulatorOutlineMaterial=function(c,g=y.RenderOccludedFlag.OccludeAndTransparent){c=z.fromValues(c[0],c[1],c[2],4===c.length?c[3]:1);return new x.ColorMaterial({color:c,transparent:!0,writeDepth:!0,cullFace:k.CullFaceOptions.Front,renderOccluded:g})};m.createSphereManipulator=function(c,g,b){return new q.Manipulator3D({view:c,renderObjects:[{geometry:D.createSphereGeometry(1,32,32),material:n(z.fromValues(g[0],
g[1],g[2],null!=b?b:1))}]})};m.getGraphicAttachmentOrigin=p;m.placeAtGraphic=function(c,g,b){c=p(c,b);f.isSome(c)?g.elevationAlignedLocation=c:(b=b.geometry,f.isNone(b)||(b="mesh"===b.type?b.anchor:a.computeCentroid(b),f.isNone(b)||(g.location=w.hydrateGeometry(b))))};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/interactive/Manipulator3D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/compilerUtils ../../../core/Evented ../../../core/mathUtils ../../../core/maybe ../../../core/screenUtils ../../../core/accessorSupport/utils ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection ../../../geometry/projectionEllipsoid ../../../geometry/support/aaBoundingRect ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ../support/ElevationProvider ../support/geometryUtils/ray ../webgl-engine/lib/Camera ../webgl-engine/lib/Object3D ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/WebGLLayer ../../interactive/interfaces ../../../geometry/Point".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c,g,b,d,I,M,v,A,C,u,t,E,B,H,L){function F(da){return 0!==da[12]||0!==da[13]||0!==da[14]}h=function(){function da(J){this.camera=new u.default;this._elevation={offset:0,override:null};this.collisionType={type:"point"};this.collisionPriority=0;this._renderObjects=[];this._available=this.autoScaleRenderObjects=!0;this._noDisplayCount=0;this._radius=10;this._worldSized=!1;this.focusMultiplier=2;this.touchMultiplier=2.5;this.worldOriented=!1;this._modelTransform=
x.create();this._worldFrame=null;this._renderLocation=l.create();this._renderLocationDirty=!0;this._location=new L({x:0,y:0,z:0});this._elevationAlignedLocation=new L;this.interactive=this._elevationAlignedLocationDirty=!0;this.selectable=!1;this.grabbable=!0;this.cursor=null;this._selected=this._hovering=this.dragging=this._grabbing=!1;this._state=H.ManipulatorStateCustomFlags.None;this._focused=!1;this.events=new z.EventEmitter;this._screenLocation={screenPointArray:q.createScreenPointArray(),renderScreenPointArray:q.createRenderScreenPointArray3(),
pixelSize:0};this._screenLocationDirty=!0;this._applyObjectTransform=null;this._engineResourcesAddedToStage=!1;this._engineResources=null;this._attached=!1;this._materialIdReferences=this._engineLayer=null;this._location.spatialReference=J.view.spatialReference;for(const P in J)this[P]=J[P];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}var Z=da.prototype;Z.destroy=function(){this._removeResourcesFromStage();this.camera=this.view=this._engineResources=null};
Z.disableDisplay=function(){this._noDisplayCount++;1===this._noDisplayCount&&this._updateEngineObject();return{remove:a.once(()=>{this._noDisplayCount--;0===this._noDisplayCount&&this._updateEngineObject()})}};Z._updateElevationAlignedLocation=function(){this._elevationAlignedLocation.x=this.location.x;this._elevationAlignedLocation.y=this.location.y;const J=w.isSome(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=J+this._elevation.offset;this._elevationAlignedLocation.spatialReference=
this.location.spatialReference;this._screenLocationDirty=this._renderLocationDirty=!0;this._elevationAlignedLocationDirty=!1};Z.grabbableForEvent=function(){return!0};Z.updateStateEnabled=function(J,P){this.state=P?this.state|J:this.state&~J};Z._setFocused=function(J){J!==this._focused&&(this._focused=J,this.events.emit("focus-changed",{action:!0===J?"focus":"unfocus"}))};Z._ensureScreenLocation=function(){if(this._screenLocationDirty){this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation);
this._screenLocationDirty=!1;if(F(this._modelTransform)){var J=this._calculateModelTransformOffset(ma);J=n.add(J,J,this.renderLocation)}else J=this.renderLocation;this.camera.projectToRenderScreen(J,this._screenLocation.renderScreenPointArray);this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}};Z.intersectionDistance=function(J,P){if(!this.available)return null;J=q.screenPointObjectToArray(J,O);var U=this._getCollisionRadius(P);P=-1*this.collisionPriority;
switch(this.collisionType.type){case "point":if(r.squaredDistance(this.screenLocation.screenPointArray,J)<U*U)return this.screenLocation.renderScreenPointArray[2]+P;break;case "line":var S=this.collisionType.paths,R=this._getWorldToScreenObjectScale();R=this._calculateObjectTransform(R,Y);U*=this.screenLocation.pixelSize;J=C.fromScreen(this.camera,J,N);if(w.isNone(J))break;for(var W of S)if(0!==W.length){S=n.transformMat4(aa,W[0],R);for(var T=1;T<W.length;T++){var ba=n.transformMat4(ea,W[T],R),ca=
b.closestRayDistance2(b.fromPoints(S,ba,K),J);if(null!=ca&&ca<U*U)return R=n.add(M.sv3d.get(),S,ba),n.scale(R,R,.5),J=q.castRenderScreenPointArray(M.sv3d.get()),this.camera.projectToRenderScreen(R,J),J[2]+P;n.copy(S,ba)}}break;case "disc":W=this.collisionType.direction;R=null!=(S=this.collisionType.offset)?S:l.ZEROS;S=this._getWorldToScreenObjectScale();S=this._calculateObjectTransform(S,Y);U*=this.screenLocation.pixelSize;J=C.fromScreen(this.camera,J,N);if(w.isNone(J))break;T=k.fromMat4(Q,S);W=n.transformMat3(ia,
W,T);R=n.transformMat4(ja,R,S);d.fromPositionAndNormal(R,W,X);W=ka;if(d.intersectRay(X,J,W)&&n.squaredDistance(W,R)<U*U)return this.screenLocation.renderScreenPointArray[2]+P;break;case "ribbon":{const {paths:fa,direction:ha}=this.collisionType;W=this._getWorldToScreenObjectScale();W=this._calculateObjectTransform(W,Y);U*=this.camera.computeScreenPixelSizeAt(this.renderLocation);S=C.fromScreen(this.camera,J,N);if(w.isNone(S))break;J=k.fromMat4(Q,W);J=n.transformMat3(ia,ha,J);T=this._calculateModelTransformPosition(ja);
d.fromPositionAndNormal(T,J,X);J=ka;if(!d.intersectRay(X,S,J))break;for(R of fa)if(0!==R.length)for(S=n.transformMat4(aa,R[0],W),T=1;T<R.length;T++){ba=n.transformMat4(ea,R[T],W);ca=b.distance2(b.fromPoints(S,ba,K),J);if(null!=ca&&ca<U*U)return R=n.add(M.sv3d.get(),S,ba),n.scale(R,R,.5),J=q.castRenderScreenPointArray(M.sv3d.get()),this.camera.projectToRenderScreen(R,J),J[2]+P;n.copy(S,ba)}break}default:G.neverReached(this.collisionType)}return null};Z.attach=function(J={manipulator3D:{}}){if(this.view._stage){J=
J.manipulator3D;if(w.isNone(J.engineLayerId)){var P=new B.WebGLLayer({isPickable:!1,updatePolicy:E.UpdatePolicy.SYNC});this.view._stage.add(P);J.engineLayerId=P.id;this._engineLayer=P}else null!=(P=this.view._stage)&&P.getObject&&(this._engineLayer=this.view._stage.getObject(J.engineLayerId));J.engineLayerReferences=(J.engineLayerReferences||0)+1;this._materialIdReferences=J.materialIdReferences;w.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,J.materialIdReferences=this._materialIdReferences);
this.camera.copyFrom(this.view.state.camera);this._attached=!0;this._updateEngineObject();p.canProjectWithoutEngine(this._location.spatialReference,this.view.spatialReference)||(this.location=new L({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}};Z.detach=function(J={manipulator3D:{}}){J=J.manipulator3D;J.engineLayerReferences--;const P=0===J.engineLayerReferences;P&&(J.engineLayerId=null);this._removeResourcesFromStage(P);this._materialIdReferences=this._engineLayer=this._engineResources=
null;this._attached=!1};Z.onViewChange=function(){this.camera.copyFrom(this.view.state.camera);this._screenLocationDirty=!0;this._updateEngineObject()};Z.onElevationChange=function(J){p.projectPoint(this.location,la,J.spatialReference);g.containsPointObject(J.extent,la)&&(this.location=this._location)};Z._evaluateElevationAlignment=function(J=this.location){if(w.isNone(this.elevationInfo))return!1;let P=null,U=0;const S=w.unwrapOr(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case "on-the-ground":P=
w.unwrapOr(A.getElevationAtPoint(this.view.elevationProvider,J,"ground"),0);break;case "relative-to-ground":U=w.unwrapOr(A.getElevationAtPoint(this.view.elevationProvider,J,"ground"),0)+S;break;case "relative-to-scene":U=w.unwrapOr(A.getElevationAtPoint(this.view.elevationProvider,J,"scene"),0)+S;break;case "absolute-height":U=S}return U!==this._elevation.offset||P!==this._elevation.override?(this._elevation.offset=U,this._elevation.override=P,!0):!1};Z._updateEngineObject=function(){if(this._attached)if(this.available){var J=
this._getWorldToScreenObjectScale(),P=Y;!0===this.autoScaleRenderObjects?(J*=this._getFocusedSize(this._radius,this.focused),this._calculateObjectTransform(J,P)):this._calculateObjectTransform(J,P);var {objectsByState:U}=this._ensureEngineResources();J=(this.focused?H.ManipulatorStateFlags.Focused:H.ManipulatorStateFlags.Unfocused)|(this.selected?H.ManipulatorStateFlags.Selected:H.ManipulatorStateFlags.Unselected);var S=0<this._noDisplayCount;for(const {stateMask:R,objects:W}of U)if(S)for(const T of W)T.setVisible(!1);
else if(U=(R&H.ManipulatorStateCustomFlags.All)===H.ManipulatorStateCustomFlags.None||(this.state&R)===(R&H.ManipulatorStateCustomFlags.All),(R&H.ManipulatorStateFlags.All)!==H.ManipulatorStateFlags.None&&(J&R)!==(R&H.ManipulatorStateFlags.All)||!U)for(const T of W)T.setVisible(!1);else for(const T of W)T.setVisible(!0),T.transformation=P}else this._removeResourcesFromStage()};Z._ensureEngineResources=function(){if(w.isNone(this._engineResources)){const J=w.unwrap(this._engineLayer),P=[],U=new Set;
this.renderObjects.forEach(({material:T})=>{U.has(T)||(P.push(T),U.add(T))});const S=(T,ba)=>{const {geometry:ca,material:fa,transform:ha}=ba;Array.isArray(ca)?ca.forEach(na=>T.addGeometry(na,fa,ha)):T.addGeometry(ca,fa,ha)},R=new Map;this._renderObjects.forEach(T=>{const ba=new t.Object3D({castShadow:!1});S(ba,T);T=T.stateMask||0;const ca=R.get(T)||[];ca.push(ba);R.set(T,ca)});const W=[];R.forEach((T,ba)=>W.push({stateMask:ba,objects:T}));this._engineResources={objectsByState:W,layer:J,materials:P}}this._addResourcesToStage();
return this._engineResources};Z._addResourcesToStage=function(){if(!this._engineResourcesAddedToStage&&!w.isNone(this._engineResources)){var {objectsByState:J,layer:P,materials:U}=this._engineResources;U.forEach(S=>{const R=w.unwrap(this._materialIdReferences),W=R.get(S.id)||0;0===W&&this.view._stage.add(S);R.set(S.id,W+1)});J.forEach(({objects:S})=>{P.addMany(S);this.view._stage.addMany(S)});this._engineResourcesAddedToStage=!0}};Z._removeResourcesFromStage=function(J=!1){if(this._engineResourcesAddedToStage&&
!w.isNone(this._engineResources)&&this.view._stage){var {objectsByState:P,layer:U,materials:S}=this._engineResources;P.forEach(({objects:R})=>{U.removeMany(R);this.view._stage.removeMany(R)});S.forEach(R=>{const W=w.unwrap(this._materialIdReferences),T=W.get(R.id);1===T?(this.view._stage.remove(R),W.delete(R.id)):W.set(R.id,T-1)});J&&this.view._stage.remove(U);this._engineResourcesAddedToStage=!1}};Z._getCollisionRadius=function(J){return this._getFocusedSize(this.radius,!0)*("touch"===J?this.touchMultiplier:
1)};Z._getFocusedSize=function(J,P){return J*(P?this.focusMultiplier:1)};Z._getWorldToScreenObjectScale=function(){return this._worldSized?1:this.screenLocation.pixelSize};Z._calculateModelTransformPosition=function(J){var P=this._getWorldToScreenObjectScale();P=this._calculateObjectTransform(P,V);return n.set(J,P[12],P[13],P[14])};Z._calculateModelTransformOffset=function(J){const P=this._calculateModelTransformPosition(J);return n.subtract(J,P,this.renderLocation)};Z._calculateObjectTransform=function(J,
P){y.set(P,J,0,0,0,0,J,0,0,0,0,J,0,0,0,0,1);this._worldFrame&&y.multiply(P,P,this._worldFrame);y.multiply(P,P,this._modelTransform);P[12]+=this.renderLocation[0];P[13]+=this.renderLocation[1];P[14]+=this.renderLocation[2];P[15]=1;w.isSome(this._applyObjectTransform)&&this._applyObjectTransform(P);return P};f._createClass(da,[{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(J){this._elevationInfo=J;this._renderLocationDirty=this._elevationAlignedLocationDirty=!0;this._updateEngineObject()}},
{key:"renderObjects",get:function(){return this._renderObjects},set:function(J){this._removeResourcesFromStage();this._engineResources=null;this._renderObjects=J.slice();this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(J){J!==this._available&&(this._available=J,this._updateEngineObject())}},{key:"radius",get:function(){return this._radius},set:function(J){J!==this._radius&&(this._radius=J,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},
set:function(J){J!==this._worldSized&&(this._worldSized=J,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(J){F(J)&&(this._screenLocationDirty=!0);y.copy(this._modelTransform,J);this._updateEngineObject()}},{key:"renderLocation",get:function(){if(this._renderLocationDirty)if(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented){this._worldFrame||(this._worldFrame=
x.create());a:{var J=this.view,P=this._renderLocation,U=this._worldFrame;switch(J.viewingMode){case "local":y.identity(U);break a;case "global":J=c.getReferenceEllipsoid(J.renderCoordsHelper.spatialReference),p.sphericalPCPFtoLonLatElevation(P,0,aa,0,J.radius),p.computeENUToSphericalPCPFLocalRotation(e.deg2rad(aa[0]),e.deg2rad(aa[1]),U)}}}else this._worldFrame&&(this._worldFrame=null);return this._renderLocation},set:function(J){this.view.renderCoordsHelper.fromRenderCoords(J,this._location);this.elevationAlignedLocation=
this._location}},{key:"location",get:function(){return this._location},set:function(J){v.clonePoint(J,this._location);this._elevationAlignedLocationDirty=this._screenLocationDirty=this._renderLocationDirty=!0;this._updateEngineObject();this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){if(!this._elevationAlignedLocationDirty)return this._elevationAlignedLocation;this._evaluateElevationAlignment();this._updateElevationAlignedLocation();return this._elevationAlignedLocation},
set:function(J){v.clonePoint(J,this._location);this._evaluateElevationAlignment();this._location.z-=this._elevation.offset;this._updateElevationAlignedLocation();this._updateEngineObject();this.events.emit("location-update",{location:this._location})}},{key:"grabbing",get:function(){return this._grabbing},set:function(J){J!==this._grabbing&&(this._grabbing=J,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(J){J!==
this._hovering&&(this._hovering=J,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(J){J!==this._selected&&(this._selected=J,this._updateEngineObject(),this.events.emit("select-changed",{action:J?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(J){J!==this._state&&(this._state=J,this._updateEngineObject())}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",
get:function(){this._ensureScreenLocation();return this._screenLocation}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(J){this._applyObjectTransform=J;this._screenLocationDirty=!0;this._updateEngineObject()}},{key:"test",get:function(){let J=!1;if(w.isSome(this._engineResources))for(const P in this._engineResources.objectsByState){const U=this._engineResources.objectsByState[P];for(const S of U.objects)if(S.isVisible){J=!0;break}if(J)break}return{areAnyResourcesVisible:J}}}]);
return da}();const O=q.createScreenPointArray(),K=b.create(),N=I.create(),Q=D.create(),V=x.create(),Y=x.create(),X=d.create(),aa=l.create(),ea=l.create(),ka=l.create(),ia=l.create(),ja=l.create(),ma=l.create(),la=new L({x:0,y:0,z:0,spatialReference:null});m.Manipulator3D=h;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/materials/ShadedColorMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutputOptions ../lib/basicInterfaces ../lib/GLMaterial ../lib/GLMaterials ../lib/Material ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./internal/bufferWriterUtils ./internal/MaterialUtil ../shaders/ShadedColorMaterialTechnique".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c){let g=function(A){function C(t){t=A.call(this,t,d)||this;t.supportsEdges=!0;t.techniqueConfig=new c.ShadedColorMaterialTechniqueConfiguration;t._vertexAttributeLocations=c.ShadedColorMaterialVertexAttrLocations;return t}f._inheritsLoose(C,A);var u=C.prototype;u.getTechniqueConfig=function(t,E){this.techniqueConfig.output=t;this.techniqueConfig.cullFace=this.parameters.cullFace;this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled;this.techniqueConfig.transparent=
this.parameters.transparent;this.techniqueConfig.writeDepth=this.parameters.writeDepth;this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled;this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled;this.techniqueConfig.transparencyPassType=E.transparencyPassType;this.techniqueConfig.multipassTerrainEnabled=E.multipassTerrainEnabled;this.techniqueConfig.cullAboveGround=E.cullAboveGround;return this.techniqueConfig};u.getPassParameters=function(){return this.parameters};
u.intersect=function(t,E,B,H,L,F,O){if(this.parameters.screenSizeEnabled){const K=t.vertexAttributes.get(n.VertexAttribute.OFFSET);p.intersectTriangleGeometry(t,E,H,L,F,{applyToVertex:(N,Q,V,Y)=>{Y=h.set(M,K.data[3*Y],K.data[3*Y+1],K.data[3*Y+2]);N=h.set(v,N,Q,V);h.scale(Y,Y,this.parameters.screenSize*H.camera.computeRenderPixelSizeAt(Y));h.add(N,N,Y);return[N[0],N[1],N[2]]},applyToAabb:N=>{const Q=z.center(N,M);return z.scale(N,this.parameters.screenSize*H.camera.computeRenderPixelSizeAt(Q))}},O)}else p.intersectTriangleGeometry(t,
E,H,L,F,void 0,O)};u.requiresSlot=function(t,E){if(D.outputFromPass(E)===q.ShaderOutput.Highlight)return t===x.RenderSlot.OPAQUE_MATERIAL;E=x.RenderSlot.OPAQUE_MATERIAL;this.parameters.transparent&&(E=this.parameters.writeDepth?x.RenderSlot.TRANSPARENT_MATERIAL:x.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL);return t===E||t===x.RenderSlot.DRAPED_MATERIAL};u.createGLMaterial=function(t){return t.output===q.ShaderOutput.Color||t.output===q.ShaderOutput.Alpha||t.output===q.ShaderOutput.Highlight?
new b(t):null};u.createBufferWriter=function(){return new I(this.parameters.screenSizeEnabled)};return C}(y.Material),b=function(A){function C(){return A.apply(this,arguments)||this}f._inheritsLoose(C,A);var u=C.prototype;u.updateParameters=function(t){return this.ensureTechnique(c.ShadedColorMaterialTechnique,t)};u.beginSlot=function(t){return this.updateParameters(t)};u.bind=function(t,E){E.bindPass(this._material.getPassParameters(),t)};return C}(k);const d={color:[1,1,1,1],shadingTint:[0,0,0,
.25],shadingDirection:h.normalize(G.create(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:a.CullFaceOptions.None,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...y.DefaultMaterialParameters};let I=function(){function A(u){this.screenSizeEnabled=u;u=w.newLayout().vec3f(n.VertexAttribute.POSITION).vec3f(n.VertexAttribute.NORMAL);this.screenSizeEnabled&&u.vec3f(n.VertexAttribute.OFFSET);this.vertexBufferLayout=u}var C=A.prototype;C.allocate=function(u){return this.vertexBufferLayout.createBuffer(u)};
C.elementCount=function(u){return u.indices.get(n.VertexAttribute.POSITION).length};C.write=function(u,t,E,B){l.writeDefaultAttributes(t,this.vertexBufferLayout,u.transformation,u.invTranspTransformation,E,B);if(this.screenSizeEnabled)if(t.vertexAttributes.has(n.VertexAttribute.OFFSET)){const H=t.vertexAttributes.get(n.VertexAttribute.OFFSET);t=t.indices.get(n.VertexAttribute.OFFSET);r.assert(3===H.size);if(E=E.getField(n.VertexAttribute.OFFSET,e.BufferViewVec3f))l.writePosition(t,H.data,u.invTranspTransformation,
E,B);else throw Error("unable to acquire view for "+n.VertexAttribute.OFFSET);}else throw Error(`${n.VertexAttribute.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);};return A}();const M=G.create(),v=G.create();m.ShadedColorMaterial=g;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../chunks/vec4f64 ../core/shaderLibrary/ScreenSizeScaling.glsl ../core/shaderLibrary/ShaderOutputOptions ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/VertexAttribute ../../../../chunks/ShadedColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c,g,b){y=function(M){function v(){return M.apply(this,arguments)||this}h._inheritsLoose(v,M);var A=v.prototype;A.initializeProgram=function(C){var u=v.shader.get();const t=this.configuration;u=u.build({output:t.output,slicePlaneEnabled:t.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:t.screenSizeEnabled,shadingEnabled:t.shadingEnabled,oitEnabled:t.transparencyPassType===r.TransparencyPassType.Color,multipassTerrainEnabled:t.multipassTerrainEnabled,
cullAboveGround:t.cullAboveGround});return new l.Program(C.rctx,u,d)};A.bindPass=function(C,u){const {screenSizeEnabled:t,shadingEnabled:E}=this.configuration,{color:B,shadingTint:H,shadingDirection:L}=C;k.bindProjectionMatrix(this.program,u.camera.projectionMatrix);this.program.setUniform4fv("uColor",B);u.multipassTerrainEnabled&&(this.program.setUniform2fv("nearFar",u.camera.nearFar),this.program.setUniform2fv("inverseViewport",u.inverseViewport),a.bindMultipassTerrainTexture(this.program,u));E&&
(this.program.setUniform4fv("shadedColor",this._blendColor(I,H,B)),this.program.setUniform3fv("shadingDirection",L),this.program.setUniformMatrix4fv("viewNormal",u.camera.viewInverseTransposeMatrix));t&&e.bindScreenSizeScalingUniforms(this.program,C,u)};A.bindDraw=function(C){k.bindView(this.program,C);k.bindCameraPosition(this.program,C.origin,C.camera.viewInverseTransposeMatrix);q.bindSliceUniformsWithOrigin(this.program,this.configuration,C);this.program.rebindTextures()};A._blendColor=function(C,
u,t){const E=1-u[3],B=u[3]+t[3]*E;if(0===B)return C[3]=B,C;C[0]=(u[0]*u[3]+t[0]*t[3]*E)/B;C[1]=(u[1]*u[3]+t[1]*t[3]*E)/B;C[2]=(u[2]*u[3]+t[2]*t[3]*E)/B;C[3]=t[3];return C};A._setPipelineState=function(C){const u=this.configuration,t=C===r.TransparencyPassType.NONE,E=C===r.TransparencyPassType.FrontFace;return b.makePipelineState({blending:u.output!==w.ShaderOutput.Color&&u.output!==w.ShaderOutput.Alpha||!u.transparent?null:t?n.blendingDefault:n.oitBlending(C),culling:b.cullingParams(u.cullFace),depthTest:{func:E?
g.CompareFunction.LESS:u.shadingEnabled?g.CompareFunction.LEQUAL:g.CompareFunction.LESS},depthWrite:t?u.writeDepth&&b.defaultDepthWriteParams:n.oitDepthWrite(C),colorWrite:b.defaultColorWriteParams,polygonOffset:t||E?null:n.OITPolygonOffset})};A.initializePipeline=function(){return this._setPipelineState(this.configuration.transparencyPassType)};return v}(y.ShaderTechnique);y.shader=new D.ReloadableShaderModule(c.ShadedColorMaterialShader,()=>new Promise((M,v)=>m(["./ShadedColorMaterial.glsl"],M,
v)));D=function(M){function v(){var A=M.apply(this,arguments)||this;A.output=w.ShaderOutput.Color;A.cullFace=r.CullFaceOptions.None;A.slicePlaneEnabled=!1;A.transparent=!1;A.writeDepth=!0;A.screenSizeEnabled=!0;A.shadingEnabled=!0;A.transparencyPassType=r.TransparencyPassType.NONE;A.multipassTerrainEnabled=!1;A.cullAboveGround=!1;return A}h._inheritsLoose(v,M);return v}(x.ShaderTechniqueConfiguration);G.__decorate([x.parameter({count:w.ShaderOutput.COUNT})],D.prototype,"output",void 0);G.__decorate([x.parameter({count:r.CullFaceOptions.COUNT})],
D.prototype,"cullFace",void 0);G.__decorate([x.parameter()],D.prototype,"slicePlaneEnabled",void 0);G.__decorate([x.parameter()],D.prototype,"transparent",void 0);G.__decorate([x.parameter()],D.prototype,"writeDepth",void 0);G.__decorate([x.parameter()],D.prototype,"screenSizeEnabled",void 0);G.__decorate([x.parameter()],D.prototype,"shadingEnabled",void 0);G.__decorate([x.parameter({count:r.TransparencyPassType.COUNT})],D.prototype,"transparencyPassType",void 0);G.__decorate([x.parameter()],D.prototype,
"multipassTerrainEnabled",void 0);G.__decorate([x.parameter()],D.prototype,"cullAboveGround",void 0);const d=new Map([[p.VertexAttribute.POSITION,0],[p.VertexAttribute.NORMAL,1],[p.VertexAttribute.OFFSET,2]]),I=z.create();f.ShadedColorMaterialTechnique=y;f.ShadedColorMaterialTechniqueConfiguration=D;f.ShadedColorMaterialVertexAttrLocations=d;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl":function(){define(["exports","../shaderModules/interfaces"],
function(m,f){m.ScreenSizeScaling=function(h){h.vertex.uniforms.add("cameraPosition","vec3").add("perScreenPixelRatio","float").add("screenSize","float");h.vertex.code.add(f.glsl`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance*perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;
}`)};m.bindScreenSizeScalingUniforms=function(h,G,z){h.setUniform1f("perScreenPixelRatio",z.camera.perScreenPixelRatio);h.setUniform1f("screenSize",G.screenSize)};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/chunks/ShadedColorMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutputOptions ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y){function x(n){const l=new D.ShaderBuilder;l.include(z.Transform,{linearDepth:!1});l.include(f.ScreenSizeScaling,{});l.include(G.Slice,n);l.fragment.include(a.ColorConversion);l.vertex.uniforms.add("proj","mat4").add("view","mat4");l.fragment.uniforms.add("uColor","vec4");l.attributes.add(y.VertexAttribute.POSITION,"vec3");l.varyings.add("vWorldPosition","vec3");n.multipassTerrainEnabled&&l.varyings.add("depth","float");n.screenSizeEnabled&&l.attributes.add(y.VertexAttribute.OFFSET,
"vec3");n.shadingEnabled&&(l.vertex.uniforms.add("viewNormal","mat4"),l.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),l.attributes.add(y.VertexAttribute.NORMAL,"vec3"),l.varyings.add("vViewNormal","vec3"));l.vertex.code.add(k.glsl`
    void main(void) {
      vWorldPosition = ${n.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `);n.shadingEnabled&&l.vertex.code.add(k.glsl`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`);l.vertex.code.add(k.glsl`
    ${n.multipassTerrainEnabled?"depth \x3d (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `);n.multipassTerrainEnabled&&(l.fragment.include(e.ReadLinearDepth),l.include(w.multipassTerrainTest,n));l.fragment.code.add(k.glsl`
    void main() {
      discardBySlice(vWorldPosition);
      ${n.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    `);n.shadingEnabled?l.fragment.code.add(k.glsl`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`):l.fragment.code.add(k.glsl`vec4 finalColor = uColor;`);l.fragment.code.add(k.glsl`
      if (finalColor.a < ${k.glsl.float(q.symbolAlphaCutoff)}) {
        discard;
      }
      ${n.output===h.ShaderOutput.Alpha?k.glsl`gl_FragColor = vec4(finalColor.a);`:""}

      ${n.output===h.ShaderOutput.Color?k.glsl`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${n.oitEnabled?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `);return l}const r=Object.freeze({__proto__:null,build:x});m.ShadedColorMaterialShader=r;m.build=x})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../support/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),function(m,f,h,G,z,e,w,q,a){w=function(D){function y(r){var n=
D.call(this,r.view)||this;n._angleCutoff=a.defaultAngleCutoff;n._style={};n._heightManifoldTarget=z.create();n._heightManifoldEnabled=!1;n._intersectsLine=e.create();n._intersectsLineEnabled=!1;n._intersectsLineInfinite=!1;n._lineVerticalPlaneSegment=null;n._pathVerticalPlaneBuffers=null;n._pointDistanceLine=null;n.applyProps(r);return n}f._inheritsLoose(y,D);var x=y.prototype;x.createResources=function(){this._ensureRenderer()};x.destroyResources=function(){this._disposeRenderer()};x.updateVisibility=
function(){this._syncRenderer();this._syncHeightManifold();this._syncIntersectsLine();this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance()};x._syncRenderer=function(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||h.isSome(this._pointDistanceLine)||h.isSome(this._pathVerticalPlaneBuffers))?this._ensureRenderer():this._disposeRenderer()};x._ensureRenderer=function(){h.isSome(this.renderer)||(this.renderer=new q.LaserLineRenderer(this.view.renderCoordsHelper,
void 0,{contrastControlEnabled:!0}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))};x._syncStyle=function(){h.isNone(this.renderer)||(this.renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=
this._style.intersectsLineRadius))};x._syncAngleCutoff=function(){h.isNone(this.renderer)||this.renderer.setParameters({angleCutoff:this._angleCutoff})};x._syncHeightManifold=function(){h.isNone(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))};x._syncIntersectsLine=function(){h.isNone(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&
this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))};x._syncIntersectsLineInfinite=function(){h.isNone(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)};x._syncPathVerticalPlane=function(){h.isNone(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=h.isSome(this._pathVerticalPlaneBuffers)&&this.visible,h.isSome(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))};
x._syncLineVerticalPlane=function(){h.isNone(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=h.isSome(this._lineVerticalPlaneSegment)&&this.visible,h.isSome(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))};x._syncPointDistance=function(){h.isNone(this.renderer)||(this.renderer.pointDistanceEnabled=h.isSome(this._pointDistanceLine)&&this.visible,h.isSome(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,
this.renderer.pointDistanceTarget=this._pointDistanceLine.target))};x._disposeRenderer=function(){h.isSome(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)};f._createClass(y,[{key:"testData",get:function(){return this.renderer}},{key:"angleCutoff",get:function(){return this._angleCutoff},set:function(r){this._angleCutoff!==r&&(this._angleCutoff=r,this._syncAngleCutoff())}},{key:"style",get:function(){return this._style},set:function(r){this._style=
r;this._syncStyle()}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldEnabled?this._heightManifoldTarget:null},set:function(r){h.isSome(r)?(G.copy(this._heightManifoldTarget,r),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this._syncRenderer();this._syncHeightManifold()}},{key:"intersectsWorldUpAtLocation",set:function(r){if(h.isNone(r))this.intersectsLine=null;else{var n=this.view.renderCoordsHelper.worldUpAtPosition(r,k);this.intersectsLine=e.fromValues(r,
n);this.intersectsLineInfinite=!0}}},{key:"intersectsLine",get:function(){return this._intersectsLineEnabled?this._intersectsLine:null},set:function(r){h.isSome(r)?(e.copy(r,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1;this._syncIntersectsLine();this._syncRenderer()}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(r){this._intersectsLineInfinite=r;this._syncIntersectsLineInfinite()}},{key:"lineVerticalPlaneSegment",
get:function(){return this._lineVerticalPlaneSegment},set:function(r){this._lineVerticalPlaneSegment=h.isSome(r)?e.copy(r):null;this._syncLineVerticalPlane();this._syncRenderer()}},{key:"pathVerticalPlane",get:function(){return this._pathVerticalPlaneBuffers},set:function(r){this._pathVerticalPlaneBuffers=r;this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance();this._syncRenderer()}},{key:"pointDistanceLine",get:function(){return this._pointDistanceLine},set:function(r){this._pointDistanceLine=
h.isSome(r)?{origin:z.clone(r.origin),target:z.clone(r.target)}:null;this._syncPointDistance();this._syncRenderer()}}]);return y}(w.VisualElement);const k=z.create();m.LaserlineVisualElement=w;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(m,f){let h=function(){function G(e){this._resourcesCreated=this._attached=!1;this._visible=!0;this.view=e;this.view.watch("ready",
w=>{this._resourcesCreated&&(w?this._createResources():this._destroyResources())})}var z=G.prototype;z.applyProps=function(e){let w=!1;for(const q in e)q in this?"attached"===q?w=e[q]:this[q]=e[q]:console.error("Cannot set unknown property",q);this.attached=w};z.destroy=function(){this.attached=!1};z._createResources=function(){this.createResources();this._resourcesCreated=!0;this.visible||this.updateVisibility(!1)};z._destroyResources=function(){this.destroyResources();this._resourcesCreated=!1};
f._createClass(G,[{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&((this._attached=e)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}}]);return G}();m.VisualElement=h;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../core/maybe ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/vec4 ../../../chunks/vec4f64 ../../../geometry/support/clipRay ../../../geometry/support/frustum ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./LaserlinePathData ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ../webgl-engine/shaders/LaserlineTechnique ../../webgl/enums".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p,c,g,b,d,I,M){function v(H,L,F,O){const K=A,N=C;e.transformMat4(K,L,O);e.copy(N,F);N[3]=0;q.transformMat4(N,N,O);x.fromPositionAndNormal(K,N,H)}const A=w.create(),C=a.create(),u={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:h.deg2rad(6),globalAlphaContrastBoost:2};h=function(){function H(F,O={},K={contrastControlEnabled:!1}){this._renderCoordsHelper=F;this._config=K;this._technique=null;this._projInfo=
a.create();this._zScale=z.create();this._heightManifoldEnabled=!1;this._heightManifoldTarget=w.create();this._pointDistanceEnabled=!1;this._pointDistanceOrigin=w.create();this._pointDistanceTarget=w.create();this._lineVerticalPlaneEnabled=!1;this._lineVerticalPlaneSegment=y.create();this._intersectsLineEnabled=!1;this._intersectsLineSegment=y.create();this._intersectsLineRadius=3;this._pathVerticalPlaneEnabled=this._intersectsLineInfinite=!1;this._pathTechnique=this._pathVerticalPlaneData=null;this.canRender=
!0;this._tempNormal=w.create();this._tempDir=w.create();this._tempUp=w.create();this._tempVec3A=w.create();this._tempVec3B=w.create();this._tempVec4=a.create();this._tempPlane=x.create();this._tempSphere=n.create();this._params=b.copyParameters(O,u)}var L=H.prototype;L.setParameters=function(F){b.updateParameters(this._params,F)&&this._requestRender()};L.initializeRenderContext=function(F){this._context=F;this._quadVAO=p.createQuadVAO(F.renderContext.rctx);this._techniqueRepository=F.shaderTechniqueRepository;
this._techniqueConfig=new I.LaserlineTechniqueConfiguration;F=new d.LaserlinePathTechniqueConfiguration;F.contrastControlEnabled=this._config.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquire(d.LaserlinePathTechnique,F)};L.uninitializeRenderContext=function(){this._quadVAO=G.disposeMaybe(this._quadVAO);this._technique=G.releaseMaybe(this._technique);this._pathVerticalPlaneData=G.disposeMaybe(this._pathVerticalPlaneData);this._pathTechnique=G.releaseMaybe(this._pathTechnique)};
L.prepareTechnique=function(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,
this._technique=this._techniqueRepository.releaseAndAcquire(I.LaserlineTechnique,this._techniqueConfig,this._technique)):this._pathTechnique};L.render=function(F,O){const K=F.camera;g.inverseProjectionInfo(K.projectionMatrix,K.fullWidth,K.fullHeight,this._projInfo,this._zScale);(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(F,O);this.pathVerticalPlaneEnabled&&this._renderPath(F)};L._renderUnified=function(F,O){const K=
F.rctx,N=K.useTechnique(O);this._bindGlobalUniforms(F,N);this._bindHeightManifoldUniforms(F,N);this._bindPointDistanceUniforms(F,N);this._bindLineVerticalPlaneUniforms(F,N);this._bindIntersectsLineUniforms(F,N);O.bind(this._params,F.camera);K.bindVAO(this._quadVAO);K.drawArrays(M.PrimitiveType.TRIANGLE_STRIP,0,4)};L._renderPath=function(F){if(!G.isNone(this._pathVerticalPlaneData)&&!G.isNone(this._pathTechnique)){var O=this._pathTechnique,K=F.rctx.useTechnique(O);this._bindGlobalUniforms(F,K);O.bind(this._params,
this._pathVerticalPlaneData.origin,F.camera);this._pathVerticalPlaneData.draw(F.rctx)}};L._bindHeightManifoldUniforms=function(F,O){if(this.heightManifoldEnabled){var K=this._tempVec3A,N=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,K);v(N,this._heightManifoldTarget,K,F.camera.viewMatrix);O.setUniform4fv("heightPlane",N)}};L._bindPointDistanceUniforms=function(F,O){if(this._pointDistanceEnabled){F=F.camera;var K=this._tempSphere;e.copy(K,this._pointDistanceOrigin);
e.transformMat4(K,K,F.viewMatrix);K[3]=e.distance(this._pointDistanceOrigin,this._pointDistanceTarget);O.setUniform4f("pointDistanceSphere",K[0],K[1],K[2],K[3])}};L._bindLineVerticalPlaneUniforms=function(F,O){if(this._lineVerticalPlaneEnabled){var K=this._renderCoordsHelper;F=F.camera;var N=this._tempPlane,Q=this._tempVec3A,V=this._tempUp,Y=this._tempDir,X=this._tempNormal;y.pointAt(this._lineVerticalPlaneSegment,.5,Q);K.worldUpAtPosition(Q,V);e.normalize(Y,this._lineVerticalPlaneSegment.vector);
e.cross(X,V,Y);e.normalize(X,X);v(N,this._lineVerticalPlaneSegment.origin,X,F.viewMatrix);O.setUniform4fv("lineVerticalPlane",N);N=this._tempVec3A;e.copy(N,this._lineVerticalPlaneSegment.origin);K.setAltitude(N,0);e.transformMat4(N,N,F.viewMatrix);O.setUniform3fv("lineVerticalStart",N);N=this._tempVec3B;e.add(N,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector);K.setAltitude(N,0);e.transformMat4(N,N,F.viewMatrix);O.setUniform3fv("lineVerticalEnd",N)}};L._bindIntersectsLineUniforms=
function(F,O){if(this._intersectsLineEnabled){var K=E,N=B;if(this._intersectsLineInfinite){var Q=F.camera;k.fromRay(r.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),t);t.c0=-Number.MAX_VALUE;if(!D.intersectClipRay(Q.frustum,t))return;k.getStart(t,K);k.getEnd(t,N)}else e.copy(K,this._intersectsLineSegment.origin),e.add(N,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);Q=this._tempVec3A;e.transformMat4(Q,K,F.camera.viewMatrix);O.setUniform3fv("intersectsLineStart",
Q);K=this._tempVec4;e.copy(K,this._intersectsLineSegment.vector);this._tempVec4[3]=0;q.transformMat4(this._tempVec4,this._tempVec4,F.camera.viewMatrix);e.transformMat4(N,N,F.camera.viewMatrix);O.setUniform3fv("intersectsLineEnd",N);e.normalize(K,K);O.setUniform3f("intersectsLineDirection",K[0],K[1],K[2]);O.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}};L._bindGlobalUniforms=function(F,O){const K=F.camera;O.setUniform4fv("projInfo",this._projInfo);O.setUniform2fv("zScale",this._zScale);
O.setUniform2fv("nearFar",K.nearFar);this._heightManifoldEnabled?O.setUniform1f("maxPixelDistance",2*K.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?O.setUniform1f("maxPixelDistance",2*K.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&O.setUniform1f("maxPixelDistance",2*K.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin));O.bindTexture(F.offscreenRenderingHelper.linearDepthTexture,"depthMap");O.bindTexture(F.offscreenRenderingHelper.mainColorTexture,
"frameColor")};L._requestRender=function(){this._context&&this._context.requestRender()};f._createClass(H,[{key:"renderSlots",get:function(){return[this._config.contrastControlEnabled?c.RenderSlot.LASERLINES_CONTRAST_CONTROL:c.RenderSlot.LASERLINES]}},{key:"needsLinearDepth",get:function(){return!0}},{key:"heightManifoldEnabled",get:function(){return this._heightManifoldEnabled},set:function(F){this._heightManifoldEnabled!==F&&(this._heightManifoldEnabled=F,this._requestRender())}},{key:"heightManifoldTarget",
get:function(){return this._heightManifoldTarget},set:function(F){e.copy(this._heightManifoldTarget,F);this._requestRender()}},{key:"pointDistanceEnabled",get:function(){return this._pointDistanceEnabled},set:function(F){F!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=F,this._requestRender())}},{key:"pointDistanceTarget",get:function(){return this._pointDistanceTarget},set:function(F){e.copy(this._pointDistanceTarget,F);this._requestRender()}},{key:"pointDistanceOrigin",get:function(){return this._pointDistanceOrigin},
set:function(F){e.copy(this._pointDistanceOrigin,F);this._requestRender()}},{key:"lineVerticalPlaneEnabled",get:function(){return this._lineVerticalPlaneEnabled},set:function(F){F!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=F,this._requestRender())}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},set:function(F){y.copy(F,this._lineVerticalPlaneSegment);this._requestRender()}},{key:"intersectsLineEnabled",get:function(){return this._intersectsLineEnabled},
set:function(F){F!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=F,this._requestRender())}},{key:"intersectsLineSegment",get:function(){return this._intersectsLineSegment},set:function(F){y.copy(F,this._intersectsLineSegment);this._requestRender()}},{key:"intersectsLineRadius",get:function(){return this._intersectsLineRadius},set:function(F){F!==this._intersectsLineRadius&&(this._intersectsLineRadius=F,this._requestRender())}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},
set:function(F){F!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=F,this._requestRender())}},{key:"pathVerticalPlaneEnabled",get:function(){return this._pathVerticalPlaneEnabled},set:function(F){F!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=F,G.isSome(this._pathVerticalPlaneData)&&this._requestRender())}},{key:"pathVerticalPlaneVertices",set:function(F){G.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new l.LaserlinePathData(this._renderCoordsHelper));
this._pathVerticalPlaneData.vertices=F;this.pathVerticalPlaneEnabled&&this._requestRender()}},{key:"pathVerticalPlaneBuffers",set:function(F){G.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new l.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.buffers=F;this.pathVerticalPlaneEnabled&&this._requestRender()}}]);return H}();const t=k.create(),E=w.create(),B=w.create();m.LaserLineRenderer=h;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/lib/VertexAttribute ../webgl-engine/shaders/LaserlinePathTechnique ../../webgl/BufferObject ../../webgl/enums ../../webgl/VertexArrayObject".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y){let x=function(){function p(g){this._renderCoordsHelper=g;this._buffers=null;this._origin=z.create();this._dirty=!1;this._count=0;this._vao=null}var c=p.prototype;c.draw=function(g){const b=this._ensureVAO(g);h.isSome(b)&&(g.bindVAO(b),g.drawArrays(D.PrimitiveType.TRIANGLES,0,this._count))};c.dispose=function(){h.isSome(this._vao)&&this._vao.dispose()};c._ensureVAO=function(g){if(h.isNone(this._buffers))return null;h.isNone(this._vao)&&(this._vao=this._createVAO(g,
this._buffers));this._ensureVertexData(this._vao,this._buffers);return this._vao};c._createVAO=function(g,b){b=this._createDataBuffer(b);this._dirty=!1;return new y.VertexArrayObject(g,a.LaserlinePathTechnique.attributeLocations,{data:e.glLayout(l)},{data:k.BufferObject.createVertex(g,D.Usage.STATIC_DRAW,b)})};c._ensureVertexData=function(g,b){this._dirty&&(b=this._createDataBuffer(b),g.vertexBuffers.data.setData(b),this._dirty=!1)};c._numberOfRenderVertices=function(g){return 6*(g.length/3-1)};c._createDataBuffer=
function(g){var b=g.reduce((C,u)=>C+this._numberOfRenderVertices(u),0);this._count=b;b=l.createBuffer(b);const d=this._origin;let I=0,M=0;for(const C of g){for(g=0;g<C.length;g+=3){var v=G.set(n,C[g+0],C[g+1],C[g+2]);0===g?M=this._renderCoordsHelper.getAltitude(v):this._renderCoordsHelper.setAltitude(v,M);var A=this._renderCoordsHelper.worldUpAtPosition(v,r);const u=I+2*g;v=G.subtract(n,v,d);if(g<C.length-3){b.up.setVec(u,A);b.up.setVec(u+3,A);b.up.setVec(u+5,A);for(let t=0;6>t;t++)b.start.setVec(u+
t,v);b.extrude.setValues(u+0,0,-1);b.extrude.setValues(u+1,1,-1);b.extrude.setValues(u+2,1,1);b.extrude.setValues(u+3,0,-1);b.extrude.setValues(u+4,1,1);b.extrude.setValues(u+5,0,1)}if(0<g)for(b.up.setVec(u-2,A),b.up.setVec(u-4,A),b.up.setVec(u-5,A),A=-6;0>A;A++)b.end.setVec(u+A,v)}I+=this._numberOfRenderVertices(C)}return b.buffer};f._createClass(p,[{key:"vertices",set:function(g){const b=new Float64Array(3*g.length);let d=0;for(const I of g)b[d++]=I[0],b[d++]=I[1],b[d++]=I[2];this.buffers=[b]}},
{key:"buffers",set:function(g){this._buffers=g;if(0<this._buffers.length){g=this._buffers[0];const b=3*Math.floor(g.length/3/2);G.set(this._origin,g[b+0],g[b+1],g[b+2])}else G.set(this._origin,0,0,0);this._dirty=!0}},{key:"origin",get:function(){return this._origin}}]);return p}();const r=z.create(),n=z.create(),l=w.newLayout().vec3f(q.VertexAttribute.START).vec3f(q.VertexAttribute.END).vec3f(q.VertexAttribute.UP).vec2f(q.VertexAttribute.EXTRUDE);m.LaserlinePathData=x;Object.defineProperty(m,"__esModule",
{value:!0})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../chunks/mat4 ../../../../chunks/mat4f64 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/Program ../lib/VertexAttribute ../../../../chunks/LaserlinePath.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r){q=function(l){function p(){return l.apply(this,arguments)||this}h._inheritsLoose(p,l);var c=p.prototype;c.initializeProgram=function(g){const b=p.shader.get().build(this.configuration);return new k.Program(g.rctx,b,p.attributeLocations)};c.bind=function(g,b,d){this.program.setUniform3fv("innerColor",g.innerColor);this.program.setUniform1f("innerWidth",g.innerWidth*d.pixelRatio);this.program.setUniform3fv("glowColor",g.glowColor);this.program.setUniform1f("glowWidth",
g.glowWidth*d.pixelRatio);this.program.setUniform1f("glowFalloff",g.glowFalloff);this.program.setUniform1f("globalAlpha",g.globalAlpha);this.program.setUniform1f("perScreenPixelRatio",d.perScreenPixelRatio);this.program.setUniform2f("pixelToNDC",2/d.fullWidth,2/d.fullHeight);this.program.setUniformMatrix4fv("proj",d.projectionMatrix);z.translate(n,d.viewMatrix,b);this.program.setUniformMatrix4fv("modelView",n);this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",
null!=g.globalAlphaContrastBoost?g.globalAlphaContrastBoost:1)};c.initializePipeline=function(){return r.makePipelineState({blending:r.simpleBlendingParams(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:r.defaultColorWriteParams})};return p}(q.ShaderTechnique);q.shader=new w.ReloadableShaderModule(y.LaserlinePathShader,()=>new Promise((l,p)=>m(["./LaserlinePath.glsl"],l,p)));q.attributeLocations=new Map([[D.VertexAttribute.START,0],[D.VertexAttribute.END,1],[D.VertexAttribute.UP,
2],[D.VertexAttribute.EXTRUDE,3]]);w=function(l){function p(){var c=l.apply(this,arguments)||this;c.contrastControlEnabled=!1;return c}h._inheritsLoose(p,l);return p}(a.ShaderTechniqueConfiguration);G.__decorate([a.parameter()],w.prototype,"contrastControlEnabled",void 0);const n=e.create();f.LaserlinePathTechnique=q;f.LaserlinePathTechniqueConfiguration=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/chunks/LaserlinePath.glsl":function(){define(["exports","../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl",
"../views/3d/webgl-engine/core/shaderModules/interfaces","../views/3d/webgl-engine/core/shaderModules/ShaderBuilder","../views/3d/webgl-engine/lib/VertexAttribute"],function(m,f,h,G,z){function e(q){const a=new G.ShaderBuilder;a.include(f.Laserline,q);a.vertex.uniforms.add("modelView","mat4");a.vertex.uniforms.add("proj","mat4");a.attributes.add(z.VertexAttribute.START,"vec3");a.attributes.add(z.VertexAttribute.END,"vec3");a.attributes.add(z.VertexAttribute.UP,"vec3");a.attributes.add(z.VertexAttribute.EXTRUDE,
"vec2");a.varyings.add("uv","vec2");a.varyings.add("vViewStart","vec3");a.varyings.add("vViewEnd","vec3");a.varyings.add("vViewPlane","vec4");a.vertex.uniforms.add("glowWidth","float");a.vertex.uniforms.add("pixelToNDC","vec2");a.vertex.code.add(h.glsl`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`);a.fragment.uniforms.add("globalAlpha","float");a.fragment.uniforms.add("perScreenPixelRatio","float");a.fragment.code.add(h.glsl`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`);return a}const w=Object.freeze({__proto__:null,build:e});m.LaserlinePathShader=w;m.build=e})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define(["exports","./output/ReadLinearDepth.glsl","./util/CameraSpace.glsl","../shaderModules/interfaces"],function(m,f,h,G){m.Laserline=function(z,e){z.extensions.add("GL_OES_standard_derivatives");z.fragment.include(f.ReadLinearDepth);z.include(h.CameraSpace);z.fragment.uniforms.add("glowColor","vec3");z.fragment.uniforms.add("glowWidth",
"float");z.fragment.uniforms.add("glowFalloff","float");z.fragment.uniforms.add("innerColor","vec3");z.fragment.uniforms.add("innerWidth","float");z.fragment.uniforms.add("depthMap","sampler2D");z.fragment.uniforms.add("nearFar","vec2");z.fragment.uniforms.add("frameColor","sampler2D");e.contrastControlEnabled&&z.fragment.uniforms.add("globalAlphaContrastBoost","float");z.fragment.code.add(G.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);z.fragment.code.add(G.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);z.fragment.code.add(G.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);z.fragment.code.add(G.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`);e.contrastControlEnabled?z.fragment.code.add(G.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`):z.fragment.code.add(G.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/mathUtils ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/Laserlines.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x){w=function(r){function n(){return r.apply(this,arguments)||this}h._inheritsLoose(n,r);var l=n.prototype;l.initializeProgram=function(p){const c=n.shader.get().build(this.configuration);return new k.Program(p.rctx,c,a.Default3D)};l.bind=function(p,c){this.program.setUniform3fv("innerColor",p.innerColor);this.program.setUniform1f("innerWidth",p.innerWidth*c.pixelRatio);this.program.setUniform3fv("glowColor",p.glowColor);this.program.setUniform1f("glowWidth",p.glowWidth*
c.pixelRatio);this.program.setUniform1f("glowFalloff",p.glowFalloff);this.program.setUniform1f("globalAlpha",p.globalAlpha);this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=p.globalAlphaContrastBoost?p.globalAlphaContrastBoost:1);p=null!=p.angleCutoff?p.angleCutoff:D.defaultAngleCutoff;this.program.setUniform2f("angleCutoff",Math.cos(p),Math.cos(Math.max(0,p-z.deg2rad(2))));this.configuration.intersectsLineEnabled&&this.program.setUniform1f("perScreenPixelRatio",
c.perScreenPixelRatio)};l.initializePipeline=function(){return x.makePipelineState({blending:x.simpleBlendingParams(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:x.defaultColorWriteParams})};return n}(w.ShaderTechnique);w.shader=new e.ReloadableShaderModule(D.LaserlinesShader,()=>new Promise((r,n)=>m(["./Laserlines.glsl"],r,n)));e=function(r){function n(){var l=r.apply(this,arguments)||this;l.heightManifoldEnabled=!1;l.pointDistanceEnabled=!1;l.lineVerticalPlaneEnabled=!1;l.intersectsLineEnabled=
!1;l.contrastControlEnabled=!1;return l}h._inheritsLoose(n,r);return n}(q.ShaderTechniqueConfiguration);G.__decorate([q.parameter()],e.prototype,"heightManifoldEnabled",void 0);G.__decorate([q.parameter()],e.prototype,"pointDistanceEnabled",void 0);G.__decorate([q.parameter()],e.prototype,"lineVerticalPlaneEnabled",void 0);G.__decorate([q.parameter()],e.prototype,"intersectsLineEnabled",void 0);G.__decorate([q.parameter()],e.prototype,"contrastControlEnabled",void 0);f.LaserlineTechnique=w;f.LaserlineTechniqueConfiguration=
e;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),function(m,f,h,G,z,e){function w(a){const k=new e.ShaderBuilder;k.extensions.add("GL_OES_standard_derivatives");k.include(G.ScreenSpacePass);
k.include(h.Laserline,a);k.fragment.uniforms.add("angleCutoff","vec2");k.fragment.uniforms.add("globalAlpha","float");a.heightManifoldEnabled&&k.fragment.uniforms.add("heightPlane","vec4");a.pointDistanceEnabled&&k.fragment.uniforms.add("pointDistanceSphere","vec4");a.lineVerticalPlaneEnabled&&k.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart","vec3").add("lineVerticalEnd","vec3");(a.heightManifoldEnabled||a.pointDistanceEnabled||a.lineVerticalPlaneEnabled)&&k.fragment.uniforms.add("maxPixelDistance",
"float");a.intersectsLineEnabled&&k.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float");(a.lineVerticalPlaneEnabled||a.heightManifoldEnabled)&&k.fragment.code.add(z.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);a.pointDistanceEnabled&&k.fragment.code.add(z.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);a.intersectsLineEnabled&&k.fragment.code.add(z.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`);(a.lineVerticalPlaneEnabled||a.intersectsLineEnabled)&&k.fragment.code.add(z.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);k.fragment.code.add(z.glsl`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`);a.heightManifoldEnabled&&k.fragment.code.add(z.glsl`{
float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
color = max(color, heightManifoldColor * heightManifoldAlpha);
}`);a.pointDistanceEnabled&&k.fragment.code.add(z.glsl`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`);a.lineVerticalPlaneEnabled&&k.fragment.code.add(z.glsl`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`);a.intersectsLineEnabled&&k.fragment.code.add(z.glsl`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`);k.fragment.code.add(z.glsl`gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`);return k}f=f.deg2rad(6);const q=Object.freeze({__proto__:null,defaultAngleCutoff:f,build:w});m.LaserlinesShader=q;m.build=w;m.defaultAngleCutoff=f})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/PickRequest":function(){define(["exports"],function(m){m.PickRequest=function(f,h=null){this.screenPoint=f;this.result=h};m.PickResult=function(f,h=null){this.scenePoint=f;this.mapPoint=h};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../DOMContainer ./interfaces ./ManipulatorCollection".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n){const l=z.getLogger("esri.views.interactive.InteractiveToolBase");m.InteractiveToolBase=function(p){function c(b){b=p.call(this,b)||this;b.manipulators=new n.ManipulatorCollection;b.updating=!1;b.automaticManipulatorSelection=!0;b._editableFlags=new Map([[r.EditableFlag.MANAGER,!0],[r.EditableFlag.USER,!0]]);b._creationStartedResolver=w.createResolver();b._creationFinishedResolver=w.createResolver();return b}f._inheritsLoose(c,p);var g=c.prototype;g.initialize=
function(){this._syncVisible()};g.destroy=function(){this.manipulators.destroy();this._set("view",null)};g.activate=function(){e.isNone(this.view)?l.error("Can't activate tool if view is not defined."):(x.isDOMContainer(this.view)&&this.view.focus(),this.onActivate())};g.deactivate=function(){this.onDeactivate()};g.handleInputEvent=function(b){this.onInputEvent(b)};g.handleInputEventAfter=function(b){this.onInputEventAfter(b)};g.setEditableFlag=function(b,d){this._editableFlags.set(b,d);this.manipulators.isToolEditable=
this.internallyEditable;this._updateManipulatorAttachment();b===r.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange()};g.getEditableFlag=function(b){return this._editableFlags.get(b)};g.whenCreationStarted=function(){return this._creationStartedResolver.promise};g.whenCreated=function(){return this._creationFinishedResolver.promise};g.rejectCreation=function(b){"pending"!==this.toolState&&"creating"!==this.toolState||this._creationStartedResolver.resolve(this);this._creationFinishedResolver.reject(b)};
g.onActivate=function(){};g.onDeactivate=function(){};g.onShow=function(){};g.onHide=function(){};g.onEditableChange=function(){};g.onInputEvent=function(b){};g.onInputEventAfter=function(b){};g.startToolCreation=function(){if("pending"===this.toolState)this._creationStartedResolver.resolve(this),this.toolState="creating";else throw Error(`Unexpected tool state ${this.toolState}`);};g.finishToolCreation=function(){switch(this.toolState){case "pending":this.startToolCreation();case "creating":this.created||
this._creationFinishedResolver.resolve(this);this.toolState="created";break;case "created":break;default:throw Error(`Unexpected tool state ${this.toolState}`);}};g._syncVisible=function(){"pending"!==this.toolState&&(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))};g._show=function(){this._updateManipulatorAttachment();this.onShow()};g._hide=function(){this._updateManipulatorAttachment();this.onHide()};g._updateManipulatorAttachment=function(){this.visible?this.manipulators.attach():
this.manipulators.detach()};f._createClass(c,[{key:"toolState",set:function(b){this._set("toolState",b);this._syncVisible()}},{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(b){this._get("visible")!==b&&(this._set("visible",b),this._syncVisible())}},{key:"editable",get:function(){return this.getEditableFlag(r.EditableFlag.USER)},set:function(b){this.setEditableFlag(r.EditableFlag.USER,b)}},{key:"created",get:function(){return"created"===
this.toolState}},{key:"cursor",get:function(){return null}},{key:"internallyEditable",get:function(){return this.getEditableFlag(r.EditableFlag.USER)&&this.getEditableFlag(r.EditableFlag.MANAGER)}}]);return c}(G);h.__decorate([q.property({value:"pending"})],m.InteractiveToolBase.prototype,"toolState",null);h.__decorate([q.property({constructOnly:!0})],m.InteractiveToolBase.prototype,"view",void 0);h.__decorate([q.property({readOnly:!0})],m.InteractiveToolBase.prototype,"active",null);h.__decorate([q.property({value:!0})],
m.InteractiveToolBase.prototype,"visible",null);h.__decorate([q.property({value:!0})],m.InteractiveToolBase.prototype,"editable",null);h.__decorate([q.property({readOnly:!0})],m.InteractiveToolBase.prototype,"created",null);h.__decorate([q.property({readOnly:!0})],m.InteractiveToolBase.prototype,"manipulators",void 0);h.__decorate([q.property({readOnly:!0})],m.InteractiveToolBase.prototype,"updating",void 0);h.__decorate([q.property()],m.InteractiveToolBase.prototype,"cursor",null);h.__decorate([q.property()],
m.InteractiveToolBase.prototype,"automaticManipulatorSelection",void 0);m.InteractiveToolBase=h.__decorate([y.subclass("esri.views.interactive.InteractiveToolBase")],m.InteractiveToolBase);Object.defineProperty(m,"__esModule",{value:!0})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection","../../core/maybe"],function(m,f,h,G){m.ManipulatorVisibilityPredicate=void 0;(function(e){e[e.WhenToolEditable=0]="WhenToolEditable";
e[e.WhenToolNotEditable=1]="WhenToolNotEditable";e[e.Always=2]="Always"})(m.ManipulatorVisibilityPredicate||(m.ManipulatorVisibilityPredicate={}));let z=function(){function e(){this._isToolEditable=!0;this._manipulators=new h;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}var w=e.prototype;w.add=function(q,a=m.ManipulatorVisibilityPredicate.WhenToolEditable){return this.addMany([q],a)[0]};w.addMany=function(q,a=m.ManipulatorVisibilityPredicate.WhenToolEditable){return q.map(k=>
{const D=this._nextManipulatorId++;k={id:D,manipulator:k,visibilityPredicate:a,attached:!1};this._manipulators.add(k);this._attached&&this._updateManipulatorAttachment(k);return D})};w.remove=function(q){if("number"===typeof q){for(var a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).id===q)return q=this._manipulators.splice(a,1)[0],this._detachManipulator(q),q.id;return null}for(a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).manipulator===q)return q=
this._manipulators.splice(a,1)[0],this._detachManipulator(q),q.id;return null};w.removeAll=function(){this._manipulators.forEach(q=>{this._detachManipulator(q)});this._manipulators.removeAll()};w.attach=function(){this._manipulators.forEach(q=>{this._updateManipulatorAttachment(q)});this._attached=!0};w.detach=function(){this._manipulators.forEach(q=>{this._detachManipulator(q)});this._attached=!1};w.destroy=function(){this._manipulators.forEach(({manipulator:q})=>{q.destroy&&q.destroy()});this._manipulators.destroy();
this._resourceContexts=null};w.on=function(q,a){return this._manipulators.on(q,k=>{a(k)})};w.forEach=function(q){for(const a of this._manipulators.items)q(a)};w.some=function(q){return this._manipulators.items.some(q)};w.toArray=function(){const q=[];this.forEach(a=>q.push(a.manipulator));return q};w.intersect=function(q,a){let k=null,D=Number.MAX_VALUE;this._manipulators.forEach(({id:y,manipulator:x,attached:r})=>{r&&x.interactive&&(r=x.intersectionDistance(q,a),G.isSome(r)&&r<D&&(D=r,k={id:y,manipulator:x}))});
return k};w.findById=function(q){if(G.isNone(q))return null;for(const a of this._manipulators.items)if(q===a.id)return a.manipulator;return null};w._updateManipulatorAttachment=function(q){this._isManipulatorItemVisible(q)?this._attachManipulator(q):this._detachManipulator(q)};w._attachManipulator=function(q){q.attached||(q.manipulator.attach&&q.manipulator.attach(this._resourceContexts),q.attached=!0)};w._detachManipulator=function(q){if(q.attached){var a=q.manipulator;a.grabbing=!1;a.dragging=!1;
a.hovering=!1;a.selected=!1;a.detach&&a.detach(this._resourceContexts);q.attached=!1}};w._isManipulatorItemVisible=function(q){return q.visibilityPredicate===m.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?q.visibilityPredicate===m.ManipulatorVisibilityPredicate.WhenToolEditable:q.visibilityPredicate===m.ManipulatorVisibilityPredicate.WhenToolNotEditable};f._createClass(e,[{key:"isToolEditable",set:function(q){this._isToolEditable=q}},{key:"length",get:function(){return this._manipulators.length}}]);
return e}();m.ManipulatorCollection=z;Object.defineProperty(m,"__esModule",{value:!0})})},"esri/widgets/support/InteractiveAnalysisViewModel":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./InteractiveToolViewModel".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x){m.InteractiveAnalysisViewModel=function(r){function n(p={}){var c=r.call(this,p)||this;c.analysisView=null;c._reconnectViewTask=null;c._analysisBaseHandles=new G;c._parentChangeFromReconnect=!1;p=null==p?void 0:p.analysis;z.isSome(p)?c.analysis=p:(c._set("analysis",c.constructAnalysis()),c._set("isAnalysisOwner",!0));return c}f._inheritsLoose(n,r);var l=n.prototype;l.normalizeCtorArgs=function(p){const {analysis:c,...g}=p;return g};l.initialize=function(){this._analysisBaseHandles.add([w.watch(()=>
({analysis:this.analysis,parent:z.applySome(this.analysis,({parent:p})=>p)}),({parent:p})=>{this._parentChangeFromReconnect||p===this.view||this._set("isAnalysisOwner",!1);p=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1;p&&this._scheduleViewReconnect()}),w.watch(()=>({view:this.view,ready:z.isSome(this.view)&&this.view.ready,supported:this.supported}),({view:p},{view:c})=>{p!==c&&this._disconnectFromView(c);this._scheduleViewReconnect()},w.syncAndInitial),w.watch(()=>this.analysis.isEditable,
(p,c)=>{z.isNone(this.analysisView)||(p&&!c&&z.isNone(this.tool)?this.createTool():!p&&c&&z.isSome(this.tool)&&!this.tool.active&&this.removeTool())})]);this.analysis.visible=this.visible};l.destroy=function(){this._analysisBaseHandles=z.destroyMaybe(this._analysisBaseHandles);this._reconnectViewTask=z.abortMaybe(this._reconnectViewTask);this._disconnectFromView(this.view);z.isSome(this.analysis)&&(this.isAnalysisOwner?(this.analysis.destroy(),this._set("analysis",null)):this.analysis.visible=!0)};
l.start=function(){var p=f._asyncToGenerator(function*(){this.clear();this.ready||(yield w.whenOnce(()=>this.ready));this.createTool({interactive:!0})});return function(){return p.apply(this,arguments)}}();l.onConnectToAnalysisView=function(p){};l.onDisconnectFromAnalysisView=function(){};l._scheduleViewReconnect=function(){var p=this;this._reconnectViewTask=z.abortMaybe(this._reconnectViewTask);const c=e.createTask(function(){var g=f._asyncToGenerator(function*(b){try{yield p._reconnectView(b)}catch(d){e.throwIfAborted(b);
if(e.isAbortError(d))throw d;p.logger.warn("Failed to use analysis in view model",d)}finally{c===p._reconnectViewTask&&(p._reconnectViewTask=null)}});return function(b){return g.apply(this,arguments)}}());this._reconnectViewTask=c};l._reconnectView=function(){var p=f._asyncToGenerator(function*(c){const {view:g}=this,b=z.isSome(g)&&g.ready&&this.supported,d=this.analysis;this._disconnectFromView(g);if(b&&!z.isNone(g)&&!z.isNone(d)){if(this.isAnalysisOwner){if(z.isSome(d.parent)){this.logError("expected owned analysis to have null parent when connecting to view");
return}this._parentChangeFromReconnect=!0;g.analyses.add(d)}this.analysisView=yield g.whenAnalysisView(d);e.isAborted(c)?this._disconnectFromView(g):(this.onConnectToAnalysisView(this.analysisView),!this.analysis.visible&&this.isAnalysisOwner||this.createTool())}});return function(c){return p.apply(this,arguments)}}();l._disconnectFromView=function(p){z.isSome(p)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,p.analyses.remove(this.analysis));this.analysisView=null;this.onDisconnectFromAnalysisView();
this.removeTool()};l._setExternalAnalysis=function(p){z.isSome(this.analysis)&&!this.isAnalysisOwner&&(this.analysis.visible=!0);this._set("analysis",p);this._set("isAnalysisOwner",!1);this._parentChangeFromReconnect=!1;p.isEditable||this.logger.warn(`The assigned ${p.type} analysis object will not be editable in the view. ${p.nonEditableMessage}`)};f._createClass(n,[{key:"analysis",set:function(p){p!==this._get("analysis")&&(this._disconnectFromView(this.view),this._setExternalAnalysis(p),this._scheduleViewReconnect())}},
{key:"ready",get:function(){return z.isSome(this.analysisView)&&!this.connectingToView}},{key:"connectingToView",get:function(){return z.isSome(this._reconnectViewTask)}},{key:"isAnalysisOwner",get:function(){return this._get("isAnalysisOwner")}}]);return n}(x.InteractiveToolViewModel);h.__decorate([q.property({nonNullable:!0})],m.InteractiveAnalysisViewModel.prototype,"analysis",null);h.__decorate([q.property()],m.InteractiveAnalysisViewModel.prototype,"analysisView",void 0);h.__decorate([q.property()],
m.InteractiveAnalysisViewModel.prototype,"ready",null);h.__decorate([q.property()],m.InteractiveAnalysisViewModel.prototype,"connectingToView",null);h.__decorate([q.property({readOnly:!0})],m.InteractiveAnalysisViewModel.prototype,"isAnalysisOwner",null);h.__decorate([q.property()],m.InteractiveAnalysisViewModel.prototype,"_reconnectViewTask",void 0);m.InteractiveAnalysisViewModel=h.__decorate([y.subclass("esri.widgets.support.InteractiveAnalysisViewModel")],m.InteractiveAnalysisViewModel);Object.defineProperty(m,
"__esModule",{value:!0})})},"esri/widgets/support/InteractiveToolViewModel":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(m,f,h,G,z,e,w,q,a,k,D,y,x){m.InteractiveToolViewModel=
function(r){function n(p){var c=r.call(this,p)||this;c.tool=null;c._baseHandles=new z;c._loggedUnsupportedErrorOnce=!1;c.logger=e.getLogger(c.declaredClass);p&&null!=p.visible&&(c.visible=p.visible);return c}f._inheritsLoose(n,r);var l=n.prototype;l.initialize=function(){this._baseHandles.add(q.watch(()=>({ready:w.isSome(this.view)&&this.view.ready,supported:this.supported}),({ready:p,supported:c})=>{!p||c||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=
!0)},q.syncAndInitial))};l.destroy=function(){this.removeTool();this.view=null;this._baseHandles=w.destroyMaybe(this._baseHandles)};l.createTool=function(p={interactive:!1}){this.removeTool();if(!w.isNone(this.view)&&this.view.ready&&this.supported){var c=this.constructTool();c.created?(this._set("tool",c),this.view.tools.add(c)):p.interactive?(this._set("tool",c),this.view.addAndActivateTool(c),q.when(()=>c.created,()=>{c.active&&w.isSome(this.view)&&(this.view.activeTool=null)},{initial:!0,once:!0})):
c.destroy()}};l.removeTool=function(){const p=this.tool;if(!w.isNone(p)){var c=w.applySome(this.view,g=>g.tools);w.isSome(c)?c.remove(p):p.destroy();this._set("tool",null)}};l.logError=function(...p){this.logger.error(...p)};f._createClass(n,[{key:"supported",get:function(){return w.isNone(this.view)||this.view.type===this.supportedViewType}},{key:"view",get:function(){return this._get("view")},set:function(p){p!==this.view&&(this.removeTool(),this._set("view",p),this._baseHandles.remove("tools"),
w.isNone(p)||this._baseHandles.add(p.tools.on("after-remove",c=>{c.item===this.tool&&this._set("tool",null)}),"tools"))}},{key:"visible",set:function(p){this._set("visible",p);w.isSome(this.tool)&&(this.tool.visible=p)}},{key:"active",get:function(){return w.isSome(this.tool)&&this.tool.active}},{key:"disabled",get:function(){return w.isNone(this.view)||!this.view.ready||!this.supported}}]);return n}(G);h.__decorate([a.property({constructOnly:!0})],m.InteractiveToolViewModel.prototype,"tool",void 0);
h.__decorate([a.property()],m.InteractiveToolViewModel.prototype,"supported",null);h.__decorate([a.property({value:null})],m.InteractiveToolViewModel.prototype,"view",null);h.__decorate([a.property({type:Boolean,value:!0})],m.InteractiveToolViewModel.prototype,"visible",null);h.__decorate([a.property()],m.InteractiveToolViewModel.prototype,"active",null);h.__decorate([a.property()],m.InteractiveToolViewModel.prototype,"disabled",null);m.InteractiveToolViewModel=h.__decorate([x.subclass("esri.widgets.support.InteractiveToolViewModel")],
m.InteractiveToolViewModel);Object.defineProperty(m,"__esModule",{value:!0})})},"esri/widgets/AreaMeasurement3D":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./AreaMeasurement3D/AreaMeasurement3DViewModel ./support/decorators/accessibleHandler ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory ./support/widgetUtils".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p){e=function(c){function g(d,I){d=c.call(this,d,I)||this;d.view=null;d.visible=null;d.iconClass="esri-icon-measure-area";d.label=void 0;d.messages=null;d.messagesUnits=null;d.viewModel=new y;d.unitOptions=null;d.unit=null;return d}m._inheritsLoose(g,c);var b=g.prototype;b.render=function(){const {supported:d,active:I,measurement:M,state:v,unit:A}=this.viewModel;var C="disabled"===v;const u="measuring"===v||"measured"===v,{messages:t,messagesUnits:E}=this;
var B=I&&"ready"===v?l.tsx("section",{key:"esri-area-measurement-3d__hint",class:"esri-area-measurement-3d__hint"},l.tsx("p",{class:"esri-area-measurement-3d__hint-text"},t.hint)):null;const H=d?null:l.tsx("section",{key:"esri-area-measurement-3d__unsupported",class:"esri-area-measurement-3d__panel--error"},l.tsx("p",null,t.unsupported));var L=(K,N,Q)=>{switch(N.state){case "available":return l.tsx("div",{key:`${Q}-enabled`,class:"esri-area-measurement-3d__measurement-item"},l.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},
K),l.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},N.text));case "unavailable":return l.tsx("div",{key:`${Q}-disabled`,class:this.classes("esri-area-measurement-3d__measurement-item","esri-area-measurement-3d__measurement-item--disabled")},l.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},K));case "invalid":return l.tsx("div",{key:`${Q}-enabled`,class:"esri-area-measurement-3d__measurement-item"},l.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},
K),l.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},t.notApplicable))}};L=u?l.tsx("section",{key:"esri-area-measurement-3d__measurement",class:"esri-area-measurement-3d__measurement"},L(t.area,M.area,"area"),L(t.perimeterLength,M.perimeterLength,"perimeter-length")):null;var F=`${this.id}__units`,O=l.tsx("label",{class:"esri-area-measurement-3d__units-label",for:F},t.unit);F=l.tsx("div",{class:"esri-area-measurement-3d__units-select-wrapper"},l.tsx("select",{class:"esri-area-measurement-3d__units-select esri-select",
id:F,onchange:this._changeUnit,bind:this,value:A},this.viewModel.unitOptions.map(K=>{var N;return l.tsx("option",{key:K,value:K},G.isMeasurementSystem(K)?E.systems[K]:null==(N=E.units[K])?void 0:N.pluralCapitalized)})));O=u?l.tsx("section",{key:"esri-area-measurement-3d__units",class:"esri-area-measurement-3d__units"},O,F):null;O=u?l.tsx("div",{key:"settings",class:"esri-area-measurement-3d__settings"},O):null;C=!d||I&&!u?null:l.tsx("div",{class:"esri-area-measurement-3d__actions"},l.tsx("button",
{disabled:C,class:this.classes("esri-area-measurement-3d__clear-button esri-button esri-button--primary",C&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement,type:"button"},t.newMeasurement));B=this.visible?l.tsx("div",{class:"esri-area-measurement-3d__container"},H,B,O,L,C):null;return l.tsx("div",{key:this,class:"esri-area-measurement-3d esri-widget esri-widget--panel",role:"presentation"},B)};b._newMeasurement=function(){h.ignoreAbortErrors(this.viewModel.start())};b._changeUnit=
function(d){d=d.target;if(d=d.options[d.selectedIndex])this.unit=d.value};m._createClass(g,[{key:"analysis",get:function(){return this.viewModel.analysis},set:function(d){this.viewModel.analysis=d}}]);return g}(D);f.__decorate([z.aliasOf("viewModel.view")],e.prototype,"view",void 0);f.__decorate([z.aliasOf("viewModel.visible")],e.prototype,"visible",void 0);f.__decorate([z.aliasOf("viewModel.active")],e.prototype,"active",void 0);f.__decorate([a.property({constructOnly:!0,nonNullable:!0})],e.prototype,
"analysis",null);f.__decorate([a.property()],e.prototype,"iconClass",void 0);f.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],e.prototype,"label",void 0);f.__decorate([a.property(),r.messageBundle("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],e.prototype,"messages",void 0);f.__decorate([a.property(),r.messageBundle("esri/core/t9n/Units")],e.prototype,"messagesUnits",void 0);f.__decorate([a.property()],e.prototype,"uiStrings",void 0);f.__decorate([a.property({type:y})],
e.prototype,"viewModel",void 0);f.__decorate([z.aliasOf("viewModel.unitOptions")],e.prototype,"unitOptions",void 0);f.__decorate([z.aliasOf("viewModel.unit")],e.prototype,"unit",void 0);f.__decorate([x.accessibleHandler()],e.prototype,"_newMeasurement",null);f.__decorate([x.accessibleHandler()],e.prototype,"_changeUnit",null);return e=f.__decorate([k.subclass("esri.widgets.AreaMeasurement3D")],e)})},"esri/widgets/AreaMeasurement3D/AreaMeasurement3DViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../analysis/AreaMeasurementAnalysis ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../properties/defaultUnit ../../views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool ../support/InteractiveAnalysisViewModel".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x){w=function(r){function n(p){p=r.call(this,p)||this;p.analysis=null;p.supportedViewType="3d";p.unsupportedErrorMessage="AreaMeasurement3DViewModel is only supported in 3D views.";p._userUnitOptions=null;p._userUnit=null;return p}m._inheritsLoose(n,r);var l=n.prototype;l.initialize=function(){this.analysis.unit=this.unit};l.clear=function(){this.removeTool();this.analysis.geometry=null};l.constructAnalysis=function(){return new h};l.constructTool=function(){return new y({view:G.unwrap(this.view),
analysis:this.analysis,analysisView:G.unwrap(this.analysisView),visible:this.visible})};l._findSelectableUnit=function(p,c){const g=this.unitOptions;return-1!==g.indexOf(p)?p:G.isSome(c)?this._findSelectableUnit(c):g[0]};l._filteredOrAllUnits=function(p){if(G.isNone(p))return z.measurementAreaUnits.slice();p=p.filter(c=>-1!==z.measurementAreaUnits.indexOf(c));return 0===p.length?z.measurementAreaUnits.slice():p};m._createClass(n,[{key:"state",get:function(){return this.disabled||!this.ready?"disabled":
G.isNone(this.tool)?"ready":this.tool.state}},{key:"measurement",get:function(){if(G.isNone(this.tool)||this.disabled||this.tool.destroyed||"pending"===this.tool.toolState)return null;var p=this.tool.measurementView;if(p.destroyed)return null;p=p.analysisVisualization;var c=p.viewData,g=c.measurementData;const b=c.validMeasurement;c="euclidean"===c.mode;const d=(g=0===(c?g.intersectingSegments:g.geodesicIntersectingSegments).size)?b?"available":"unavailable":"invalid";return{mode:c?"euclidean":"geodesic",
area:{text:g&&b?p.areaLabel:null,state:d},perimeterLength:{text:g&&b?p.perimeterLengthLabel:null,state:d}}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(p){this._userUnitOptions=p;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return G.isSome(this._userUnit)?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(p){this._userUnit=
p?this._findSelectableUnit(p,this._userUnit):null;this.analysis.unit=this._userUnit}}]);return n}(x.InteractiveAnalysisViewModel);f.__decorate([e.property({type:h})],w.prototype,"analysis",void 0);f.__decorate([e.property({readOnly:!0})],w.prototype,"state",null);f.__decorate([e.property({readOnly:!0})],w.prototype,"measurement",null);f.__decorate([e.property()],w.prototype,"unitOptions",null);f.__decorate([e.property()],w.prototype,"unit",null);f.__decorate([e.property(D.defaultUnitPropertyMetadata)],
w.prototype,"defaultUnit",void 0);f.__decorate([e.property()],w.prototype,"_userUnit",void 0);return w=f.__decorate([k.subclass("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],w)})},"esri/analysis/AreaMeasurementAnalysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ../core/arrayUtils ../core/Logger ../core/maybe ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Polygon".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y){const x=z.getLogger("esri.analysis.AreaMeasurementAnalysis");h=function(r){function n(l){l=r.call(this,l)||this;l.type="area-measurement";l.extent=null;l.unit=null;l.nonEditableMessage="Assign a closed polygon geometry containing more than two points to the analysis to allow editing.";return l}m._inheritsLoose(n,r);m._createClass(n,[{key:"geometry",set:function(l){e.isNone(l)?(this._set("geometry",null),this._set("extent",null)):(1<l.rings.length&&x.warn("Measuring polygons with multiple rings is not supported."),
this._set("geometry",l.clone()),this._set("extent",l.extent))}},{key:"requiredPropertiesForEditing",get:function(){if(e.isSome(this.geometry)&&1===this.geometry.rings.length){const l=this.geometry.rings[0];if(2>=l.length||!G.equals(l[0],l[l.length-1]))return[null]}return[this.geometry]}}]);return n}(h);f.__decorate([q.property({type:["area-measurement"]})],h.prototype,"type",void 0);f.__decorate([q.property({value:null,type:y})],h.prototype,"geometry",null);f.__decorate([q.property({readOnly:!0})],
h.prototype,"extent",void 0);f.__decorate([q.property({type:w.measurementAreaUnits,value:null})],h.prototype,"unit",void 0);f.__decorate([q.property({readOnly:!0})],h.prototype,"requiredPropertiesForEditing",null);f.__decorate([q.property({readOnly:!0})],h.prototype,"nonEditableMessage",void 0);return h=f.__decorate([D.subclass("esri.analysis.AreaMeasurementAnalysis")],h)})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/hydratedFeatures ../../../analysis/support/measurementUtils ../../editingTools/dragEventPipeline3D ./AreaMeasurement3DView ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../support/screenUtils".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n,l,p){w=function(c){function g(d){d=c.call(this,d)||this;d._handles=new h;d._tempPickRequest=new r.PickRequest;d.polygonState="initial";d.analysisView=null;return d}m._inheritsLoose(g,c);var b=g.prototype;b.initialize=function(){this.measurementView=new r({view:this.view,analysis:this.analysis,analysisView:this.analysisView,toolState:this,manipulators:this.manipulators,visible:this.visible});this._setupManipulators();this.startToolCreation();this._handles.add(z.watch(()=>
this.state,d=>{"measured"===d&&this.finishToolCreation()},z.syncAndInitial))};b.destroy=function(){this.measurementView.destroy();this._set("measurementView",null);this._handles=G.destroyMaybe(this._handles)};b.finishMeasurement=function(){const d=this.analysisView.path;3>d.numVertices?(d.clear(),this.polygonState="initial"):(d.close(),this.polygonState="measured");this.analysisView.cursorPoint=null};b.onShow=function(){this.measurementView.show()};b.onHide=function(){this.measurementView.hide()};
b.onInputEvent=function(d){switch(d.type){case "immediate-double-click":this._handleImmediateDoubleClick(d);break;case "immediate-click":this._handleImmediateClick(d);break;case "pointer-move":this._handlePointerMove(d);break;case "drag":this._handleDrag(d);break;case "key-down":this._handleKeyDown(d)}};b._setupManipulators=function(){const d=v=>v.events.on("grab-changed",()=>{this.analysisView.validMeasurement&&(this.polygonState=this.manipulators.some(A=>A.manipulator.grabbing)?"editing":"measured")}),
I=(v,A)=>{this._handles.add([n.createManipulatorDragEventPipeline(A,(C,u,t)=>{const E=x.hideManipulatorWhileDragging(C),B=G.unwrap(this.measurementView.manipulatorToVertex(C));u.next(E).next(this.measurementView.screenToMap3D()).next(L=>{C.location=L.mapEnd;this.analysisView.path.setVertexPosition(B,D.clonePoint(L.mapEnd))});const H=D.clonePoint(this.analysisView.path.getVertexPositionAsPoint(B));t.next(E).next(()=>{this.analysisView.path.setVertexPosition(B,H);C.location=H})}),d(A)],`manipulator-${v}`)},
M=v=>{this._handles.remove(`manipulator-${v}`)};this.manipulators.forEach(({id:v,manipulator:A})=>{I(v,A)});this._handles.add([this.manipulators.on("after-add",({item:{id:v,manipulator:A}})=>{I(v,A)}),this.manipulators.on("after-remove",({item:{id:v}})=>{M(v)})])};b._handleImmediateDoubleClick=function(d){y.isPrimaryPointerAction(d)&&("drawing"===this.polygonState&&this.finishMeasurement(),d.stopPropagation())};b._handleDrag=function(d){"editing"===this.polygonState&&d.stopPropagation()};b._handleImmediateClick=
function(d){if(y.isPrimaryPointerAction(d)){var I=p.createScreenPointFromEvent(d);if(this.active)switch(this.polygonState){case "initial":if(this._addVertexAt(I)){this.measurementView.cursorPoint=null;this.polygonState="drawing";d.stopPropagation();return}break;case "drawing":{const M=this.measurementView.vertexHandleAt(I,d.pointerType);if(G.isNone(M)){if(this._addVertexAt(I)){this.measurementView.cursorPoint=null;d.stopPropagation();return}}else 0===M.index&&(this.finishMeasurement(),d.stopPropagation())}}"mouse"===
d.pointerType&&this._hoverAt(I)}};b._handlePointerMove=function(d){"mouse"===d.pointerType&&(d=p.createScreenPointFromEvent(d),this._hoverAt(d))};b._handleKeyDown=function(d){"Enter"===d.key&&"drawing"===this.polygonState&&(this.finishMeasurement(),d.stopPropagation())};b._hoverAt=function(d){this.measurementView.requiresCursorPoint?(d=this._pick(d),d.mapPoint&&(this.measurementView.cursorPoint=d.mapPoint)):this.measurementView.cursorPoint=null};b._addVertexAt=function(d){d=this._pick(d);return d.mapPoint?
(this.analysisView.path.add(d.mapPoint),!0):!1};b._pick=function(d){const I=this._tempPickRequest;I.screenPoint=d;return this.measurementView.pick(I)};m._createClass(g,[{key:"state",get:function(){return 0===this.analysisView.path.numVertices?"ready":this.analysisView.validMeasurement&&"editing"!==this.polygonState?"measured":"measuring"}},{key:"cursor",get:function(){return"ready"===this.state||"drawing"===this.polygonState?"crosshair":null}}]);return g}(l.InteractiveToolBase);f.__decorate([e.property({readOnly:!0})],
w.prototype,"state",null);f.__decorate([e.property()],w.prototype,"polygonState",void 0);f.__decorate([e.property({readOnly:!0})],w.prototype,"cursor",null);f.__decorate([e.property()],w.prototype,"measurementView",void 0);f.__decorate([e.property({constructOnly:!0})],w.prototype,"view",void 0);f.__decorate([e.property()],w.prototype,"analysis",void 0);f.__decorate([e.property({constructOnly:!0})],w.prototype,"analysisView",void 0);return w=f.__decorate([k.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],
w)})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DView":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/screenUtils ../../../../../chunks/vec3f64 ../../../analysis/interfaces ../../manipulatorUtils ../../editingTools/dragEventPipeline3D ../support/viewUtils ../../visualElements/LaserlineVisualElement ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/IntersectorInterfaces ../../../../interactive/ManipulatorCollection".split(" "),
function(m,f,h,G,z,e,w,q,a,k,D,y,x,r,n){const l={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,
projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};let p=function(){function c(b){var d,I,M;this.vertexManipulators=[];this._analysisVisualization=this._analysisView=null;this._destroyed=!1;this._mode=w.MeasurementMode.Auto;this._listenerHandles=this._cursorManipulator=this._laserLine=this._lastDraggedVertex=this._cursorPoint=null;this._tempHandlePosition=e.create();this._analysis=b.analysis;this._analysisView=b.analysisView;
this._toolState=b.toolState;this._manipulators=null!=(d=b.manipulators)?d:new n.ManipulatorCollection;this._view=b.view;this._mode=null!=(I=b.mode)?I:w.MeasurementMode.Auto;this._cursorPoint=null!=(M=b.cursorPoint)?M:null;this._style=k.copyParameter(l,b.style);this._intersector=x.newIntersector(this._view.state.viewingMode);this._intersector.options.store=r.StoreResults.MIN;this._analysisVisualization=this._analysisView.analysisVisualization;d=q.createSphereManipulator(this._view,this._style.handleColor,
this._style.handleOpacity);d.available=!1;d.radius=this._style.handleRadius;d.interactive=!1;this._manipulators.add(d);this._cursorManipulator=d;this._laserLine=new D.LaserlineVisualElement({view:this._view,attached:!0,style:{glowColor:this._style.laserLineGlowColor,glowWidth:this._style.laserLineGlowWidth,glowFalloff:this._style.laserLineGlowFalloff,innerColor:this._style.laserLineInnerColor,innerWidth:this._style.laserLineInnerWidth,globalAlpha:this._style.laserLineGlobalAlpha}});this._analysisView.mode=
this._mode;this._analysisView.cursorPoint=this._cursorPoint;this._updateVisibility(b.visible||!0)}var g=c.prototype;g.destroy=function(){this._listenerHandles=h.destroyMaybe(this._listenerHandles);this._manipulators=h.destroyMaybe(this._manipulators);this._laserLine=h.destroyMaybe(this._laserLine);this._destroyed=!0};g.whenMessages=function(){var b=m._asyncToGenerator(function*(){yield G.whenOnce(()=>!this._analysisView.updating)});return function(){return b.apply(this,arguments)}}();g.show=function(){this._setVisibility(!0)};
g.hide=function(){this._setVisibility(!1)};g._setVisibility=function(b){this._destroyed||this._analysis.visible===b||this._updateVisibility(b)};g._updateVisibility=function(b){this._analysis.visible=b;(this._laserLine.visible=b)?(this._initializeListeners(),this._updateAll(this._analysisVisualization.viewData)):(this._destroyListeners(),this.vertexManipulators.forEach(d=>{this._removeVertexManipulator(d.manipulator)}),this.vertexManipulators=[],this._view.cursor=null)};g.vertexHandleAt=function(b,
d){b=this._manipulators.intersect(b,d);return h.isSome(b)?b.manipulator.metadata:null};g.manipulatorToVertex=function(b){return b.metadata};g.pick=function(b){var d=this._view.spatialReference;b=z.screenPointObjectToArray(b.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector);b=this._intersector.results.min;const I=e.create();if(!b.getIntersectionPoint(I))return new c.PickResult;d=this._view.renderCoordsHelper.fromRenderCoords(I,d);return h.isNone(d)?
new c.PickResult:new c.PickResult(b.intersector===r.IntersectorType.TERRAIN?"surface":"feature",I,d)};g.overlappingHandles=function(b,d){return k.pointToPointScreenDistance(b,d,this._view)<=this._style.handleRadius};g.screenToMap3D=function(){return a.screenToMap3D(this._view)};g._updateAll=function(b){this._analysis.visible&&(this._updateVertexManipulators(b),this._updateLaserLine())};g._createVertexManipulator=function(){const b=q.createSphereManipulator(this._view,this._style.handleColor,this._style.handleOpacity);
b.radius=this._style.handleRadius;return{id:this._manipulators.add(b),manipulator:b}};g._removeVertexManipulator=function(b){this._manipulators.remove(b)};g._updateVertexManipulators=function(b){const d=this._analysisView.path?this._analysisView.path.vertices:[],I=this.vertexManipulators;k.resizeArray(I,d.length,()=>this._createVertexManipulator(),M=>this._removeVertexManipulator(M.manipulator));I.forEach((M,v)=>{M.manipulator.metadata=d[v];M.manipulator.renderLocation=b.positionsRenderCoords[v]});
"drawing"===this._toolState.polygonState&&h.isSome(this.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this.cursorPoint):this._cursorManipulator.available=!1};g._getFocusPoint=function(){const b=this.lastDraggedVertex;switch(this._toolState.polygonState){case "drawing":return h.isSome(this.cursorPoint)?this.cursorPoint:h.isSome(b)?this._analysisView.path.getVertexPositionAsPoint(b):h.unwrap(this._analysisView.path.lastPoint);case "editing":return h.isSome(b)?this._analysisView.path.getVertexPositionAsPoint(b):
null;default:return this.cursorPoint}};g._updateLaserLine=function(){var b=this._style.laserLineEnabled&&"measured"!==this._toolState.polygonState&&this._toolState.active;const d=this._getFocusPoint();b&&h.isSome(d)?(b=this._tempHandlePosition,this._view.renderCoordsHelper.toRenderCoords(d,b),this._laserLine.heightManifoldTarget=b):this._laserLine.heightManifoldTarget=null};g._initializeListeners=function(){this._listenerHandles=new f;this._listenerHandles.add([G.watch(()=>this._toolState.polygonState,
()=>this._updateLaserLine()),G.watch(()=>this._analysisVisualization.viewData,()=>this._updateAll(this._analysisVisualization.viewData),G.sync),G.watch(()=>({lastDraggedVertex:this._analysisView.lastDraggedVertex,cursorPoint:this._analysisView.cursorPoint}),()=>this._updateLaserLine()),G.watch(()=>this._toolState.active,()=>this._updateAll(this._analysisVisualization.viewData))])};g._destroyListeners=function(){this._listenerHandles=h.destroyMaybe(this._listenerHandles)};m._createClass(c,[{key:"destroyed",
get:function(){return this._destroyed}},{key:"analysisVisualization",get:function(){return this._analysisVisualization}},{key:"analysisView",get:function(){return this._analysisView}},{key:"requiresCursorPoint",get:function(){return("initial"===this._toolState.polygonState||"drawing"===this._toolState.polygonState)&&this._toolState.active}},{key:"visible",get:function(){return this._analysis.visible},set:function(b){b?this.show():this.hide()}},{key:"mode",get:function(){return this._mode},set:function(b){this._destroyed||
(this._mode=b,this._analysisView.mode=b)}},{key:"cursorPoint",get:function(){return this._cursorPoint},set:function(b){this._destroyed||(this._cursorPoint=b,this._analysisView.cursorPoint=b)}},{key:"lastDraggedVertex",get:function(){return this._lastDraggedVertex},set:function(b){this._destroyed||(this._lastDraggedVertex=b,this._analysisView.lastDraggedVertex=b)}},{key:"testData",get:function(){const b=this._laserLine.testData;return{labels:this._analysisVisualization.testData.labels,laserLineRenderer:h.isSome(b)?
{heightManifoldEnabled:b.heightManifoldEnabled,heightManifoldTarget:b.heightManifoldTarget,pointDistanceEnabled:b.pointDistanceEnabled,pointDistanceOrigin:b.pointDistanceOrigin,pointDistanceTarget:b.pointDistanceTarget,lineVerticalPlaneEnabled:b.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}}]);return c}();p._handleGeometry=y.createSphereGeometry(1,32,32);(function(c){c.PickRequest=
function(){};c.PickResult=function(g=null,b=null,d=null){this.type=g;this.scenePoint=b;this.mapPoint=d}})(p||(p={}));return p})},"esri/views/3d/interactive/measurementTools/support/viewUtils":function(){define(["exports","../../../../../core/lang","../../../../../core/screenUtils","../../../../../chunks/vec2","../../../../../chunks/vec3f64"],function(m,f,h,G,z){function e(x,r,n){const l=n.state.camera;n.renderCoordsHelper.toRenderCoords(x,w);l.projectToRenderScreen(w,q);n.state.camera.renderToScreen(q,
r)}const w=z.create(),q=h.createRenderScreenPointArray3(),a=h.createRenderScreenPointArray3(),k=h.createRenderScreenPointArray3(),D=h.createScreenPointArray(),y=h.createScreenPointArray();m.copyParameter=function(x,r){return{...x,...f.clone(r)}};m.pointToPointScreenDistance=function(x,r,n){e(x,D,n);e(r,y,n);return G.distance(D,y)};m.resizeArray=function(x,r,n,l){for(;x.length<r;)x.push(n());if(l)for(;x.length>r;)n=x.pop(),l(n);else x.length=r};m.screenSpaceTangent=function(x,r,n,l){l.projectToRenderScreen(x,
a);l.projectToRenderScreen(r,k);G.subtract(n,k,a);G.normalize(n,n)};Object.defineProperty(m,"__esModule",{value:!0})})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cheader class\x3d"${baseClass}__header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/header\x3e\r\n\t\x3cdiv class\x3d"hidden" data-dojo-attach-point\x3d"measurementNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"${baseClass}__hint" data-dojo-attach-point\x3d"hintNode"\x3e${nls.hint}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Measurement3D/css/style.css":".esri-area-measurement-3d__container,.esri-direct-line-measurement-3d__container {padding: 0;}.esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}.jimu-button-group {display: flex; flex-direction: row;}.jimu-button-group \x3e button {font-family: inherit; background: #fff; border: 1px solid #ccc; padding: 5px 10px; line-height: 20px; font-size: 1em; flex-basis: 0; flex-grow: 1; transition: background-color 125ms ease-in-out; position: relative; z-index: 1;}.jimu-button-group \x3e button:hover {background: #f0f0f0;}.jimu-button-group \x3e button.jimu-state-active {background: #24b5cc; border-color: #24b5cc; color: #fff; z-index: 2;}.jimu-button-group \x3e button.jimu-state-active:before {content: none;}.jimu-button-group \x3e button:not(:disabled) {cursor: pointer;}.jimu-button-group \x3e button + button {margin-left: -1px; border-left-width: 0;}.jimu-button-group \x3e button + button::before {content: ''; display: block; position: absolute; left: -1px; top: 4px; bottom: 4px; border-left: 1px solid #ccc;}.jimu-rtl .jimu-button-group \x3e button + button {margin-left: auto; margin-right: -1px; border-left-width: 1px; border-right-width: 0;}.jimu-rtl .jimu-button-group \x3e button + button::before {right: -1px; left: auto;}.jimu-button-group \x3e button img {vertical-align: middle; margin-right: 8px; pointer-events: none;}.jimu-rtl .jimu-button-group \x3e button img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__header {font-size: 14px; text-align: center; border-bottom: 1px solid #e7e7e7; margin-bottom: 12px;}.jimu-widget-measurement__header img {vertical-align: middle; margin-right: 8px;}.jimu-rtl .jimu-widget-measurement__header img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__hint {color: #323232; font-size: 14px;}.jimu-widget-frame.jimu-container .jimu-widget-measurement__header {margin: -14px -14px 14px; padding: 14px 14px 14px;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on jimu/BaseWidget ./ButtonGroup jimu/dijit/ViewStack esri/widgets/DirectLineMeasurement3D esri/widgets/AreaMeasurement3D esri/core/watchUtils".split(" "),function(m,f,h,G,z,e,w,q){return m([G],{baseClass:"jimu-widget-measurement",name:"Measurement",MEASURE_TYPES:{DISTANCE:"distance",AREA:"area",LOCATION:"location"},measureWidgets:{},selectedMeasureType:null,buttonGroup:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);
this.measureWidgets={};this.selectedMeasureType=null},startup:function(){this.inherited(arguments);this.initUI()},destroy:function(){if(this.measureWidgets)for(var a in this.measureWidgets)if(this.measureWidgets.hasOwnProperty(a)){var k=this.measureWidgets[a];k.destroy&&k.destroy()}this.buttonGroup&&this.buttonGroup.destroy&&(this.buttonGroup.destroy(),this.buttonGroup=null);this.selectedMeasureType=null;this.inherited(arguments)},onOpen:function(){var a=this.getWidget(this.selectedMeasureType);a&&
(a.visible=!0)},onClose:function(){var a=this.getWidget(this.selectedMeasureType);a&&(a.visible=!1)},onActive:function(){var a=this.getWidget(this.selectedMeasureType);(a=a&&a.get("viewModel.tool"))&&a.activate()},onDeActive:function(){var a=this.getWidget(this.selectedMeasureType),k=a&&a.get("viewModel.tool");"measuring"===(a&&a.get("viewModel.state"))?a.viewModel.clear():k&&k.deactivate()},_applyConfig:function(a){if(this.config&&a){var k=this.config;switch(a.measureType){case this.MEASURE_TYPES.DISTANCE:var D=
"lengthUnit";var y="defaultLengthUnit";break;case this.MEASURE_TYPES.AREA:D="areaUnit",y="defaultAreaUnit"}k.measurement&&k.measurement[D]?a.unit=k.measurement[D]:k[y]&&(a.unit=k[y])}},_createWidget:function(a){a=this._ensureWidget(a);this._applyConfig(a);return a},_ensureWidget:function(a){var k=this.getWidget(a);k||(k=document.createElement("div"),a===this.MEASURE_TYPES.DISTANCE?this.measureWidgets[a]=new w({container:k,view:this.sceneView,measureType:a,visible:!1}):a===this.MEASURE_TYPES.AREA&&
(this.measureWidgets[a]=new q({container:k,view:this.sceneView,measureType:a})),k=this.measureWidgets[a]);return k},_initWidget:function(a){var k=this.getWidget(a);k||(k=this._createWidget(a),this._addtoViewStack(k));k.visible=!0;this.viewStack.switchView(a)},_addtoViewStack:function(a){if(a){var k=document.createElement("div");k.label=a.measureType;k.appendChild(a.domNode);this.viewStack.addView(k)}},_initMeasurements:function(a){if(a){var k=[];a instanceof Array&&a.forEach(f.hitch(this,function(D){var y=
document.createElement("img");y.title=D.value;y.src=this._getMeasurementIconSource(D.value);k.push({value:D.value,label:D.label,icon:y,content:D.label})}));a=this.buttonGroup=new z({buttons:k,selected:null});a.placeAt(this.headerNode);this.own(h(a,"Change",f.hitch(this,function(D){this._toggleWidgetSection(!!D);this._handleMeasureChanged()})))}},_handleMeasureChanged:function(){var a=this.buttonGroup.getActiveButtonValue(),k=this.getWidget(this.selectedMeasureType);k&&(k.visible=!1);null!==a&&this._initWidget(a);
this.selectedMeasureType=a},_toggleWidgetSection:function(a){a?(this.measurementNode.classList.remove("hidden"),this.hintNode.classList.add("hidden")):(this.measurementNode.classList.add("hidden"),this.hintNode.classList.remove("hidden"))},_getMeasurementIconSource:function(a){switch(a){case this.MEASURE_TYPES.DISTANCE:var k=this.folderUrl+"images/Measure_Distance16.png";break;case this.MEASURE_TYPES.AREA:k=this.folderUrl+"images/Measure_Area16.png"}return k},initUI:function(){var a=this.config,k=
[];this.viewStack=new e(null,this.measurementNode);a&&(a.showArea&&k.push({label:this.nls.area,value:this.MEASURE_TYPES.AREA}),a.showDistance&&k.push({label:this.nls.distance,value:this.MEASURE_TYPES.DISTANCE}));0!==k.length&&this._initMeasurements(k)},getWidget:function(a){return a&&this.measureWidgets[a]}})});